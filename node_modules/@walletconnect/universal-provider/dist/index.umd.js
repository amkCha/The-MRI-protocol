(function(zn,$t){typeof exports=="object"&&typeof module<"u"?$t(exports):typeof define=="function"&&define.amd?define(["exports"],$t):(zn=typeof globalThis<"u"?globalThis:zn||self,$t(zn["@walletconnect/universal-provider"]={}))})(this,function(zn){"use strict";var $t=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ag(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Kn(r){var e=r.default;if(typeof e=="function"){var t=function(){return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(s){var o=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:function(){return r[s]}})}),t}var Zt={exports:{}},_i=typeof Reflect=="object"?Reflect:null,uh=_i&&typeof _i.apply=="function"?_i.apply:function(e,t,s){return Function.prototype.apply.call(e,t,s)},Ms;_i&&typeof _i.ownKeys=="function"?Ms=_i.ownKeys:Object.getOwnPropertySymbols?Ms=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Ms=function(e){return Object.getOwnPropertyNames(e)};function Cg(r){console&&console.warn&&console.warn(r)}var hh=Number.isNaN||function(e){return e!==e};function st(){st.init.call(this)}Zt.exports=st,Zt.exports.once=Lg,st.EventEmitter=st,st.prototype._events=void 0,st.prototype._eventsCount=0,st.prototype._maxListeners=void 0;var fh=10;function qs(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(st,"defaultMaxListeners",{enumerable:!0,get:function(){return fh},set:function(r){if(typeof r!="number"||r<0||hh(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");fh=r}}),st.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},st.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||hh(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function lh(r){return r._maxListeners===void 0?st.defaultMaxListeners:r._maxListeners}st.prototype.getMaxListeners=function(){return lh(this)},st.prototype.emit=function(e){for(var t=[],s=1;s<arguments.length;s++)t.push(arguments[s]);var o=e==="error",c=this._events;if(c!==void 0)o=o&&c.error===void 0;else if(!o)return!1;if(o){var u;if(t.length>0&&(u=t[0]),u instanceof Error)throw u;var l=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw l.context=u,l}var y=c[e];if(y===void 0)return!1;if(typeof y=="function")uh(y,this,t);else for(var p=y.length,_=_h(y,p),s=0;s<p;++s)uh(_[s],this,t);return!0};function dh(r,e,t,s){var o,c,u;if(qs(t),c=r._events,c===void 0?(c=r._events=Object.create(null),r._eventsCount=0):(c.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),c=r._events),u=c[e]),u===void 0)u=c[e]=t,++r._eventsCount;else if(typeof u=="function"?u=c[e]=s?[t,u]:[u,t]:s?u.unshift(t):u.push(t),o=lh(r),o>0&&u.length>o&&!u.warned){u.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=r,l.type=e,l.count=u.length,Cg(l)}return r}st.prototype.addListener=function(e,t){return dh(this,e,t,!1)},st.prototype.on=st.prototype.addListener,st.prototype.prependListener=function(e,t){return dh(this,e,t,!0)};function Tg(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ph(r,e,t){var s={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},o=Tg.bind(s);return o.listener=t,s.wrapFn=o,o}st.prototype.once=function(e,t){return qs(t),this.on(e,ph(this,e,t)),this},st.prototype.prependOnceListener=function(e,t){return qs(t),this.prependListener(e,ph(this,e,t)),this},st.prototype.removeListener=function(e,t){var s,o,c,u,l;if(qs(t),o=this._events,o===void 0)return this;if(s=o[e],s===void 0)return this;if(s===t||s.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,s.listener||t));else if(typeof s!="function"){for(c=-1,u=s.length-1;u>=0;u--)if(s[u]===t||s[u].listener===t){l=s[u].listener,c=u;break}if(c<0)return this;c===0?s.shift():Rg(s,c),s.length===1&&(o[e]=s[0]),o.removeListener!==void 0&&this.emit("removeListener",e,l||t)}return this},st.prototype.off=st.prototype.removeListener,st.prototype.removeAllListeners=function(e){var t,s,o;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[e]),this;if(arguments.length===0){var c=Object.keys(s),u;for(o=0;o<c.length;++o)u=c[o],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=s[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this};function gh(r,e,t){var s=r._events;if(s===void 0)return[];var o=s[e];return o===void 0?[]:typeof o=="function"?t?[o.listener||o]:[o]:t?Ng(o):_h(o,o.length)}st.prototype.listeners=function(e){return gh(this,e,!0)},st.prototype.rawListeners=function(e){return gh(this,e,!1)},st.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):yh.call(r,e)},st.prototype.listenerCount=yh;function yh(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}st.prototype.eventNames=function(){return this._eventsCount>0?Ms(this._events):[]};function _h(r,e){for(var t=new Array(e),s=0;s<e;++s)t[s]=r[s];return t}function Rg(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Ng(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Lg(r,e){return new Promise(function(t,s){function o(u){r.removeListener(e,c),s(u)}function c(){typeof r.removeListener=="function"&&r.removeListener("error",o),t([].slice.call(arguments))}vh(r,e,c,{once:!0}),e!=="error"&&Fg(r,o,{once:!0})})}function Fg(r,e,t){typeof r.on=="function"&&vh(r,"error",e,t)}function vh(r,e,t,s){if(typeof r.on=="function")s.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function o(c){s.once&&r.removeEventListener(e,o),t(c)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}const $g=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Ug=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Mg=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function qg(r,e){if(r==="__proto__"||r==="constructor"&&e&&typeof e=="object"&&"prototype"in e){Bg(r);return}return e}function Bg(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function Bs(r,e={}){if(typeof r!="string")return r;const t=r.trim();if(r[0]==='"'&&r.at(-1)==='"'&&!r.includes("\\"))return t.slice(1,-1);if(t.length<=9){const s=t.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!Mg.test(r)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if($g.test(r)||Ug.test(r)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,qg)}return JSON.parse(r)}catch(s){if(e.strict)throw s;return r}}function Hg(r){return!r||typeof r.then!="function"?Promise.resolve(r):r}function Gt(r,...e){try{return Hg(r(...e))}catch(t){return Promise.reject(t)}}function jg(r){const e=typeof r;return r===null||e!=="object"&&e!=="function"}function zg(r){const e=Object.getPrototypeOf(r);return!e||e.isPrototypeOf(Object)}function Hs(r){if(jg(r))return String(r);if(zg(r)||Array.isArray(r))return JSON.stringify(r);if(typeof r.toJSON=="function")return Hs(r.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function wh(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const wa="base64:";function Kg(r){if(typeof r=="string")return r;wh();const e=Buffer.from(r).toString("base64");return wa+e}function Wg(r){return typeof r!="string"||!r.startsWith(wa)?r:(wh(),Buffer.from(r.slice(wa.length),"base64"))}function yr(r){return r?r.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Gg(...r){return yr(r.join(":"))}function js(r){return r=yr(r),r?r+":":""}function eO(r){return r}const Vg="memory",kg=()=>{const r=new Map;return{name:Vg,options:{},hasItem(e){return r.has(e)},getItem(e){return r.get(e)||null},getItemRaw(e){return r.get(e)||null},setItem(e,t){r.set(e,t)},setItemRaw(e,t){r.set(e,t)},removeItem(e){r.delete(e)},getKeys(){return Array.from(r.keys())},clear(){r.clear()},dispose(){r.clear()}}};function Yg(r={}){const e={mounts:{"":r.driver||kg()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=p=>{for(const _ of e.mountpoints)if(p.startsWith(_))return{base:_,relativeKey:p.slice(_.length),driver:e.mounts[_]};return{base:"",relativeKey:p,driver:e.mounts[""]}},s=(p,_)=>e.mountpoints.filter(D=>D.startsWith(p)||_&&p.startsWith(D)).map(D=>({relativeBase:p.length>D.length?p.slice(D.length):void 0,mountpoint:D,driver:e.mounts[D]})),o=(p,_)=>{if(e.watching){_=yr(_);for(const D of e.watchListeners)D(p,_)}},c=async()=>{if(!e.watching){e.watching=!0;for(const p in e.mounts)e.unwatch[p]=await mh(e.mounts[p],o,p)}},u=async()=>{if(e.watching){for(const p in e.unwatch)await e.unwatch[p]();e.unwatch={},e.watching=!1}},l=(p,_,D)=>{const S=new Map,P=I=>{let B=S.get(I.base);return B||(B={driver:I.driver,base:I.base,items:[]},S.set(I.base,B)),B};for(const I of p){const B=typeof I=="string",z=yr(B?I:I.key),ne=B?void 0:I.value,L=B||!I.options?_:{..._,...I.options},M=t(z);P(M).items.push({key:z,value:ne,relativeKey:M.relativeKey,options:L})}return Promise.all([...S.values()].map(I=>D(I))).then(I=>I.flat())},y={hasItem(p,_={}){p=yr(p);const{relativeKey:D,driver:S}=t(p);return Gt(S.hasItem,D,_)},getItem(p,_={}){p=yr(p);const{relativeKey:D,driver:S}=t(p);return Gt(S.getItem,D,_).then(P=>Bs(P))},getItems(p,_){return l(p,_,D=>D.driver.getItems?Gt(D.driver.getItems,D.items.map(S=>({key:S.relativeKey,options:S.options})),_).then(S=>S.map(P=>({key:Gg(D.base,P.key),value:Bs(P.value)}))):Promise.all(D.items.map(S=>Gt(D.driver.getItem,S.relativeKey,S.options).then(P=>({key:S.key,value:Bs(P)})))))},getItemRaw(p,_={}){p=yr(p);const{relativeKey:D,driver:S}=t(p);return S.getItemRaw?Gt(S.getItemRaw,D,_):Gt(S.getItem,D,_).then(P=>Wg(P))},async setItem(p,_,D={}){if(_===void 0)return y.removeItem(p);p=yr(p);const{relativeKey:S,driver:P}=t(p);P.setItem&&(await Gt(P.setItem,S,Hs(_),D),P.watch||o("update",p))},async setItems(p,_){await l(p,_,async D=>{D.driver.setItems&&await Gt(D.driver.setItems,D.items.map(S=>({key:S.relativeKey,value:Hs(S.value),options:S.options})),_),D.driver.setItem&&await Promise.all(D.items.map(S=>Gt(D.driver.setItem,S.relativeKey,Hs(S.value),S.options)))})},async setItemRaw(p,_,D={}){if(_===void 0)return y.removeItem(p,D);p=yr(p);const{relativeKey:S,driver:P}=t(p);if(P.setItemRaw)await Gt(P.setItemRaw,S,_,D);else if(P.setItem)await Gt(P.setItem,S,Kg(_),D);else return;P.watch||o("update",p)},async removeItem(p,_={}){typeof _=="boolean"&&(_={removeMeta:_}),p=yr(p);const{relativeKey:D,driver:S}=t(p);S.removeItem&&(await Gt(S.removeItem,D,_),(_.removeMeta||_.removeMata)&&await Gt(S.removeItem,D+"$",_),S.watch||o("remove",p))},async getMeta(p,_={}){typeof _=="boolean"&&(_={nativeOnly:_}),p=yr(p);const{relativeKey:D,driver:S}=t(p),P=Object.create(null);if(S.getMeta&&Object.assign(P,await Gt(S.getMeta,D,_)),!_.nativeOnly){const I=await Gt(S.getItem,D+"$",_).then(B=>Bs(B));I&&typeof I=="object"&&(typeof I.atime=="string"&&(I.atime=new Date(I.atime)),typeof I.mtime=="string"&&(I.mtime=new Date(I.mtime)),Object.assign(P,I))}return P},setMeta(p,_,D={}){return this.setItem(p+"$",_,D)},removeMeta(p,_={}){return this.removeItem(p+"$",_)},async getKeys(p,_={}){p=js(p);const D=s(p,!0);let S=[];const P=[];for(const I of D){const z=(await Gt(I.driver.getKeys,I.relativeBase,_)).map(ne=>I.mountpoint+yr(ne)).filter(ne=>!S.some(L=>ne.startsWith(L)));P.push(...z),S=[I.mountpoint,...S.filter(ne=>!ne.startsWith(I.mountpoint))]}return p?P.filter(I=>I.startsWith(p)&&!I.endsWith("$")):P.filter(I=>!I.endsWith("$"))},async clear(p,_={}){p=js(p),await Promise.all(s(p,!1).map(async D=>{if(D.driver.clear)return Gt(D.driver.clear,D.relativeBase,_);if(D.driver.removeItem){const S=await D.driver.getKeys(D.relativeBase||"",_);return Promise.all(S.map(P=>D.driver.removeItem(P,_)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(p=>bh(p)))},async watch(p){return await c(),e.watchListeners.push(p),async()=>{e.watchListeners=e.watchListeners.filter(_=>_!==p),e.watchListeners.length===0&&await u()}},async unwatch(){e.watchListeners=[],await u()},mount(p,_){if(p=js(p),p&&e.mounts[p])throw new Error(`already mounted at ${p}`);return p&&(e.mountpoints.push(p),e.mountpoints.sort((D,S)=>S.length-D.length)),e.mounts[p]=_,e.watching&&Promise.resolve(mh(_,o,p)).then(D=>{e.unwatch[p]=D}).catch(console.error),y},async unmount(p,_=!0){p=js(p),!(!p||!e.mounts[p])&&(e.watching&&p in e.unwatch&&(e.unwatch[p](),delete e.unwatch[p]),_&&await bh(e.mounts[p]),e.mountpoints=e.mountpoints.filter(D=>D!==p),delete e.mounts[p])},getMount(p=""){p=yr(p)+":";const _=t(p);return{driver:_.driver,base:_.base}},getMounts(p="",_={}){return p=yr(p),s(p,_.parents).map(S=>({driver:S.driver,base:S.mountpoint}))}};return y}function mh(r,e,t){return r.watch?r.watch((s,o)=>e(s,t+o)):()=>{}}async function bh(r){typeof r.dispose=="function"&&await Gt(r.dispose)}function Wn(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function Eh(r,e){const t=indexedDB.open(r);t.onupgradeneeded=()=>t.result.createObjectStore(e);const s=Wn(t);return(o,c)=>s.then(u=>c(u.transaction(e,o).objectStore(e)))}let ma;function Ji(){return ma||(ma=Eh("keyval-store","keyval")),ma}function Dh(r,e=Ji()){return e("readonly",t=>Wn(t.get(r)))}function Jg(r,e,t=Ji()){return t("readwrite",s=>(s.put(e,r),Wn(s.transaction)))}function Xg(r,e=Ji()){return e("readwrite",t=>(t.delete(r),Wn(t.transaction)))}function Qg(r=Ji()){return r("readwrite",e=>(e.clear(),Wn(e.transaction)))}function Zg(r,e){return r.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Wn(r.transaction)}function e0(r=Ji()){return r("readonly",e=>{if(e.getAllKeys)return Wn(e.getAllKeys());const t=[];return Zg(e,s=>t.push(s.key)).then(()=>t)})}const t0=r=>JSON.stringify(r,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),r0=r=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=r.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Xi(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return r0(r)}catch{return r}}function Gn(r){return typeof r=="string"?r:t0(r)||""}const n0="idb-keyval";var i0=(r={})=>{const e=r.base&&r.base.length>0?`${r.base}:`:"",t=o=>e+o;let s;return r.dbName&&r.storeName&&(s=Eh(r.dbName,r.storeName)),{name:n0,options:r,async hasItem(o){return!(typeof await Dh(t(o),s)>"u")},async getItem(o){return await Dh(t(o),s)??null},setItem(o,c){return Jg(t(o),c,s)},removeItem(o){return Xg(t(o),s)},getKeys(){return e0(s)},clear(){return Qg(s)}}};const s0="WALLET_CONNECT_V2_INDEXED_DB",o0="keyvaluestorage";class a0{constructor(){this.indexedDb=Yg({driver:i0({dbName:s0,storeName:o0})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,Gn(t))}async removeItem(e){await this.indexedDb.removeItem(e)}}var ba=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},zs={exports:{}};(function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,s){this[t]=String(s)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ba<"u"&&ba.localStorage?zs.exports=ba.localStorage:typeof window<"u"&&window.localStorage?zs.exports=window.localStorage:zs.exports=new e})();function c0(r){var e;return[r[0],Xi((e=r[1])!=null?e:"")]}class u0{constructor(){this.localStorage=zs.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(c0)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return Xi(t)}async setItem(e,t){this.localStorage.setItem(e,Gn(t))}async removeItem(e){this.localStorage.removeItem(e)}}const h0="wc_storage_version",Sh=1,f0=async(r,e,t)=>{const s=h0,o=await e.getItem(s);if(o&&o>=Sh){t(e);return}const c=await r.getKeys();if(!c.length){t(e);return}const u=[];for(;c.length;){const l=c.shift();if(!l)continue;const y=l.toLowerCase();if(y.includes("wc@")||y.includes("walletconnect")||y.includes("wc_")||y.includes("wallet_connect")){const p=await r.getItem(l);await e.setItem(l,p),u.push(l)}}await e.setItem(s,Sh),t(e),l0(r,u)},l0=async(r,e)=>{e.length&&e.forEach(async t=>{await r.removeItem(t)})};class d0{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new u0;this.storage=e;try{const t=new a0;f0(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}}var vi={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Ea=function(r,e){return Ea=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Ea(r,e)};function p0(r,e){Ea(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Da=function(){return Da=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Da.apply(this,arguments)};function g0(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(r);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(r,s[o])&&(t[s[o]]=r[s[o]]);return t}function y0(r,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(r,e,t,s);else for(var l=r.length-1;l>=0;l--)(u=r[l])&&(c=(o<3?u(c):o>3?u(e,t,c):u(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function _0(r,e){return function(t,s){e(t,s,r)}}function v0(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function w0(r,e,t,s){function o(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function l(_){try{p(s.next(_))}catch(D){u(D)}}function y(_){try{p(s.throw(_))}catch(D){u(D)}}function p(_){_.done?c(_.value):o(_.value).then(l,y)}p((s=s.apply(r,e||[])).next())})}function m0(r,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,u;return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(p){return function(_){return y([p,_])}}function y(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(r,t)}catch(_){p=[6,_],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function b0(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}function E0(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function Sa(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],s=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&s>=r.length&&(r=void 0),{value:r&&r[s++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function xh(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var s=t.call(r),o,c=[],u;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(l){u={error:l}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(u)throw u.error}}return c}function D0(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(xh(arguments[e]));return r}function S0(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var s=Array(r),o=0,e=0;e<t;e++)for(var c=arguments[e],u=0,l=c.length;u<l;u++,o++)s[o]=c[u];return s}function Qi(r){return this instanceof Qi?(this.v=r,this):new Qi(r)}function x0(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(r,e||[]),o,c=[];return o={},u("next"),u("throw"),u("return"),o[Symbol.asyncIterator]=function(){return this},o;function u(S){s[S]&&(o[S]=function(P){return new Promise(function(I,B){c.push([S,P,I,B])>1||l(S,P)})})}function l(S,P){try{y(s[S](P))}catch(I){D(c[0][3],I)}}function y(S){S.value instanceof Qi?Promise.resolve(S.value.v).then(p,_):D(c[0][2],S)}function p(S){l("next",S)}function _(S){l("throw",S)}function D(S,P){S(P),c.shift(),c.length&&l(c[0][0],c[0][1])}}function I0(r){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=r[o]?function(u){return(t=!t)?{value:Qi(r[o](u)),done:o==="return"}:c?c(u):u}:c}}function O0(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Sa=="function"?Sa(r):r[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=r[c]&&function(u){return new Promise(function(l,y){u=r[c](u),o(l,y,u.done,u.value)})}}function o(c,u,l,y){Promise.resolve(y).then(function(p){c({value:p,done:l})},u)}}function P0(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function A0(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function C0(r){return r&&r.__esModule?r:{default:r}}function T0(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function R0(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}var N0=Object.freeze({__proto__:null,__extends:p0,get __assign(){return Da},__rest:g0,__decorate:y0,__param:_0,__metadata:v0,__awaiter:w0,__generator:m0,__createBinding:b0,__exportStar:E0,__values:Sa,__read:xh,__spread:D0,__spreadArrays:S0,__await:Qi,__asyncGenerator:x0,__asyncDelegator:I0,__asyncValues:O0,__makeTemplateObject:P0,__importStar:A0,__importDefault:C0,__classPrivateFieldGet:T0,__classPrivateFieldSet:R0}),Ks=Kn(N0),Zi={},_e={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var xa=function(r,e){return xa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},xa(r,e)};function L0(r,e){xa(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ia=function(){return Ia=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Ia.apply(this,arguments)};function F0(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(r);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(r,s[o])&&(t[s[o]]=r[s[o]]);return t}function $0(r,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(r,e,t,s);else for(var l=r.length-1;l>=0;l--)(u=r[l])&&(c=(o<3?u(c):o>3?u(e,t,c):u(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function U0(r,e){return function(t,s){e(t,s,r)}}function M0(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function q0(r,e,t,s){function o(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function l(_){try{p(s.next(_))}catch(D){u(D)}}function y(_){try{p(s.throw(_))}catch(D){u(D)}}function p(_){_.done?c(_.value):o(_.value).then(l,y)}p((s=s.apply(r,e||[])).next())})}function B0(r,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,u;return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(p){return function(_){return y([p,_])}}function y(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(r,t)}catch(_){p=[6,_],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function H0(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}function j0(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function Oa(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],s=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&s>=r.length&&(r=void 0),{value:r&&r[s++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ih(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var s=t.call(r),o,c=[],u;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(l){u={error:l}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(u)throw u.error}}return c}function z0(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(Ih(arguments[e]));return r}function K0(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var s=Array(r),o=0,e=0;e<t;e++)for(var c=arguments[e],u=0,l=c.length;u<l;u++,o++)s[o]=c[u];return s}function es(r){return this instanceof es?(this.v=r,this):new es(r)}function W0(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(r,e||[]),o,c=[];return o={},u("next"),u("throw"),u("return"),o[Symbol.asyncIterator]=function(){return this},o;function u(S){s[S]&&(o[S]=function(P){return new Promise(function(I,B){c.push([S,P,I,B])>1||l(S,P)})})}function l(S,P){try{y(s[S](P))}catch(I){D(c[0][3],I)}}function y(S){S.value instanceof es?Promise.resolve(S.value.v).then(p,_):D(c[0][2],S)}function p(S){l("next",S)}function _(S){l("throw",S)}function D(S,P){S(P),c.shift(),c.length&&l(c[0][0],c[0][1])}}function G0(r){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=r[o]?function(u){return(t=!t)?{value:es(r[o](u)),done:o==="return"}:c?c(u):u}:c}}function V0(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Oa=="function"?Oa(r):r[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=r[c]&&function(u){return new Promise(function(l,y){u=r[c](u),o(l,y,u.done,u.value)})}}function o(c,u,l,y){Promise.resolve(y).then(function(p){c({value:p,done:l})},u)}}function k0(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function Y0(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function J0(r){return r&&r.__esModule?r:{default:r}}function X0(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function Q0(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}var Z0=Object.freeze({__proto__:null,__extends:L0,get __assign(){return Ia},__rest:F0,__decorate:$0,__param:U0,__metadata:M0,__awaiter:q0,__generator:B0,__createBinding:H0,__exportStar:j0,__values:Oa,__read:Ih,__spread:z0,__spreadArrays:K0,__await:es,__asyncGenerator:W0,__asyncDelegator:G0,__asyncValues:V0,__makeTemplateObject:k0,__importStar:Y0,__importDefault:J0,__classPrivateFieldGet:X0,__classPrivateFieldSet:Q0}),Ws=Kn(Z0),Pa={},ts={},Oh;function ey(){if(Oh)return ts;Oh=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return ts.delay=r,ts}var Vn={},Aa={},kn={},Ph;function ty(){return Ph||(Ph=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.ONE_THOUSAND=kn.ONE_HUNDRED=void 0,kn.ONE_HUNDRED=100,kn.ONE_THOUSAND=1e3),kn}var Ca={},Ah;function ry(){return Ah||(Ah=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365}(Ca)),Ca}var Ch;function Th(){return Ch||(Ch=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Ws;e.__exportStar(ty(),r),e.__exportStar(ry(),r)}(Aa)),Aa}var Rh;function ny(){if(Rh)return Vn;Rh=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.fromMiliseconds=Vn.toMiliseconds=void 0;const r=Th();function e(s){return s*r.ONE_THOUSAND}Vn.toMiliseconds=e;function t(s){return Math.floor(s/r.ONE_THOUSAND)}return Vn.fromMiliseconds=t,Vn}var Nh;function iy(){return Nh||(Nh=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Ws;e.__exportStar(ey(),r),e.__exportStar(ny(),r)}(Pa)),Pa}var wi={},Lh;function sy(){if(Lh)return wi;Lh=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return wi.Watch=r,wi.default=r,wi}var Ta={},rs={},Fh;function oy(){if(Fh)return rs;Fh=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.IWatch=void 0;class r{}return rs.IWatch=r,rs}var $h;function ay(){return $h||($h=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Ws.__exportStar(oy(),r)}(Ta)),Ta}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Ws;e.__exportStar(iy(),r),e.__exportStar(sy(),r),e.__exportStar(ay(),r),e.__exportStar(Th(),r)})(_e);var Ra={},ns={};class Yn{}var cy=Object.freeze({__proto__:null,IEvents:Yn}),uy=Kn(cy),Uh;function hy(){if(Uh)return ns;Uh=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.IHeartBeat=void 0;const r=uy;class e extends r.IEvents{constructor(s){super()}}return ns.IHeartBeat=e,ns}var Mh;function qh(){return Mh||(Mh=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Ks.__exportStar(hy(),r)}(Ra)),Ra}var Na={},Jn={},Bh;function fy(){if(Bh)return Jn;Bh=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.HEARTBEAT_EVENTS=Jn.HEARTBEAT_INTERVAL=void 0;const r=_e;return Jn.HEARTBEAT_INTERVAL=r.FIVE_SECONDS,Jn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Jn}var Hh;function jh(){return Hh||(Hh=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Ks.__exportStar(fy(),r)}(Na)),Na}var zh;function ly(){if(zh)return Zi;zh=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.HeartBeat=void 0;const r=Ks,e=Zt.exports,t=_e,s=qh(),o=jh();class c extends s.IHeartBeat{constructor(l){super(l),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=l?.interval||o.HEARTBEAT_INTERVAL}static init(l){return r.__awaiter(this,void 0,void 0,function*(){const y=new c(l);return yield y.init(),y})}init(){return r.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(l,y){this.events.on(l,y)}once(l,y){this.events.once(l,y)}off(l,y){this.events.off(l,y)}removeListener(l,y){this.events.removeListener(l,y)}initialize(){return r.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Zi.HeartBeat=c,Zi}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Ks;e.__exportStar(ly(),r),e.__exportStar(qh(),r),e.__exportStar(jh(),r)})(vi);var ke={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var La=function(r,e){return La=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},La(r,e)};function dy(r,e){La(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Fa=function(){return Fa=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Fa.apply(this,arguments)};function py(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(r);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(r,s[o])&&(t[s[o]]=r[s[o]]);return t}function gy(r,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(r,e,t,s);else for(var l=r.length-1;l>=0;l--)(u=r[l])&&(c=(o<3?u(c):o>3?u(e,t,c):u(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function yy(r,e){return function(t,s){e(t,s,r)}}function _y(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function vy(r,e,t,s){function o(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function l(_){try{p(s.next(_))}catch(D){u(D)}}function y(_){try{p(s.throw(_))}catch(D){u(D)}}function p(_){_.done?c(_.value):o(_.value).then(l,y)}p((s=s.apply(r,e||[])).next())})}function wy(r,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,u;return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(p){return function(_){return y([p,_])}}function y(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(r,t)}catch(_){p=[6,_],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function my(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}function by(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function $a(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],s=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&s>=r.length&&(r=void 0),{value:r&&r[s++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Kh(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var s=t.call(r),o,c=[],u;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(l){u={error:l}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(u)throw u.error}}return c}function Ey(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(Kh(arguments[e]));return r}function Dy(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var s=Array(r),o=0,e=0;e<t;e++)for(var c=arguments[e],u=0,l=c.length;u<l;u++,o++)s[o]=c[u];return s}function is(r){return this instanceof is?(this.v=r,this):new is(r)}function Sy(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(r,e||[]),o,c=[];return o={},u("next"),u("throw"),u("return"),o[Symbol.asyncIterator]=function(){return this},o;function u(S){s[S]&&(o[S]=function(P){return new Promise(function(I,B){c.push([S,P,I,B])>1||l(S,P)})})}function l(S,P){try{y(s[S](P))}catch(I){D(c[0][3],I)}}function y(S){S.value instanceof is?Promise.resolve(S.value.v).then(p,_):D(c[0][2],S)}function p(S){l("next",S)}function _(S){l("throw",S)}function D(S,P){S(P),c.shift(),c.length&&l(c[0][0],c[0][1])}}function xy(r){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=r[o]?function(u){return(t=!t)?{value:is(r[o](u)),done:o==="return"}:c?c(u):u}:c}}function Iy(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof $a=="function"?$a(r):r[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=r[c]&&function(u){return new Promise(function(l,y){u=r[c](u),o(l,y,u.done,u.value)})}}function o(c,u,l,y){Promise.resolve(y).then(function(p){c({value:p,done:l})},u)}}function Oy(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function Py(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function Ay(r){return r&&r.__esModule?r:{default:r}}function Cy(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function Ty(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}var Ry=Object.freeze({__proto__:null,__extends:dy,get __assign(){return Fa},__rest:py,__decorate:gy,__param:yy,__metadata:_y,__awaiter:vy,__generator:wy,__createBinding:my,__exportStar:by,__values:$a,__read:Kh,__spread:Ey,__spreadArrays:Dy,__await:is,__asyncGenerator:Sy,__asyncDelegator:xy,__asyncValues:Iy,__makeTemplateObject:Oy,__importStar:Py,__importDefault:Ay,__classPrivateFieldGet:Cy,__classPrivateFieldSet:Ty}),Ny=Kn(Ry),Ua,Wh;function Ly(){if(Wh)return Ua;Wh=1;function r(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}Ua=e;function e(t,s,o){var c=o&&o.stringify||r,u=1;if(typeof t=="object"&&t!==null){var l=s.length+u;if(l===1)return t;var y=new Array(l);y[0]=c(t);for(var p=1;p<l;p++)y[p]=c(s[p]);return y.join(" ")}if(typeof t!="string")return t;var _=s.length;if(_===0)return t;for(var D="",S=1-u,P=-1,I=t&&t.length||0,B=0;B<I;){if(t.charCodeAt(B)===37&&B+1<I){switch(P=P>-1?P:0,t.charCodeAt(B+1)){case 100:case 102:if(S>=_||s[S]==null)break;P<B&&(D+=t.slice(P,B)),D+=Number(s[S]),P=B+2,B++;break;case 105:if(S>=_||s[S]==null)break;P<B&&(D+=t.slice(P,B)),D+=Math.floor(Number(s[S])),P=B+2,B++;break;case 79:case 111:case 106:if(S>=_||s[S]===void 0)break;P<B&&(D+=t.slice(P,B));var z=typeof s[S];if(z==="string"){D+="'"+s[S]+"'",P=B+2,B++;break}if(z==="function"){D+=s[S].name||"<anonymous>",P=B+2,B++;break}D+=c(s[S]),P=B+2,B++;break;case 115:if(S>=_)break;P<B&&(D+=t.slice(P,B)),D+=String(s[S]),P=B+2,B++;break;case 37:P<B&&(D+=t.slice(P,B)),D+="%",P=B+2,B++,S--;break}++S}++B}return P===-1?t:(P<I&&(D+=t.slice(P)),D)}return Ua}var Ma,Gh;function Fy(){if(Gh)return Ma;Gh=1;const r=Ly();Ma=o;const e=T().console||{},t={mapHttpRequest:I,mapHttpResponse:I,wrapRequestSerializer:B,wrapResponseSerializer:B,wrapErrorSerializer:B,req:I,res:I,err:S};function s(E,h){return Array.isArray(E)?E.filter(function(V){return V!=="!stdSerializers.err"}):E===!0?Object.keys(h):!1}function o(E){E=E||{},E.browser=E.browser||{};const h=E.browser.transmit;if(h&&typeof h.send!="function")throw Error("pino: transmit option must have a send function");const m=E.browser.write||e;E.browser.write&&(E.browser.asObject=!0);const V=E.serializers||{},Y=s(E.browser.serialize,V);let se=E.browser.serialize;Array.isArray(E.browser.serialize)&&E.browser.serialize.indexOf("!stdSerializers.err")>-1&&(se=!1);const ue=["error","fatal","warn","info","debug","trace"];typeof m=="function"&&(m.error=m.fatal=m.warn=m.info=m.debug=m.trace=m),E.enabled===!1&&(E.level="silent");const de=E.level||"info",b=Object.create(m);b.log||(b.log=z),Object.defineProperty(b,"levelVal",{get:ee}),Object.defineProperty(b,"level",{get:X,set:W});const C={transmit:h,serialize:Y,asObject:E.browser.asObject,levels:ue,timestamp:P(E)};b.levels=o.levels,b.level=de,b.setMaxListeners=b.getMaxListeners=b.emit=b.addListener=b.on=b.prependListener=b.once=b.prependOnceListener=b.removeListener=b.removeAllListeners=b.listeners=b.listenerCount=b.eventNames=b.write=b.flush=z,b.serializers=V,b._serialize=Y,b._stdErrSerialize=se,b.child=G,h&&(b._logEvent=D());function ee(){return this.level==="silent"?1/0:this.levels.values[this.level]}function X(){return this._level}function W(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,c(C,b,"error","log"),c(C,b,"fatal","error"),c(C,b,"warn","error"),c(C,b,"info","log"),c(C,b,"debug","log"),c(C,b,"trace","log")}function G(J,re){if(!J)throw new Error("missing bindings for child Pino");re=re||{},Y&&J.serializers&&(re.serializers=J.serializers);const me=re.serializers;if(Y&&me){var oe=Object.assign({},V,me),be=E.browser.serialize===!0?Object.keys(oe):Y;delete J.serializers,y([J],be,oe,this._stdErrSerialize)}function fe(ve){this._childLevel=(ve._childLevel|0)+1,this.error=p(ve,J,"error"),this.fatal=p(ve,J,"fatal"),this.warn=p(ve,J,"warn"),this.info=p(ve,J,"info"),this.debug=p(ve,J,"debug"),this.trace=p(ve,J,"trace"),oe&&(this.serializers=oe,this._serialize=be),h&&(this._logEvent=D([].concat(ve._logEvent.bindings,J)))}return fe.prototype=this,new fe(this)}return b}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:ne,epochTime:L,unixTime:M,isoTime:A});function c(E,h,m,V){const Y=Object.getPrototypeOf(h);h[m]=h.levelVal>h.levels.values[m]?z:Y[m]?Y[m]:e[m]||e[V]||z,u(E,h,m)}function u(E,h,m){!E.transmit&&h[m]===z||(h[m]=function(V){return function(){const se=E.timestamp(),ue=new Array(arguments.length),de=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var b=0;b<ue.length;b++)ue[b]=arguments[b];if(E.serialize&&!E.asObject&&y(ue,this._serialize,this.serializers,this._stdErrSerialize),E.asObject?V.call(de,l(this,m,ue,se)):V.apply(de,ue),E.transmit){const C=E.transmit.level||h.level,ee=o.levels.values[C],X=o.levels.values[m];if(X<ee)return;_(this,{ts:se,methodLevel:m,methodValue:X,transmitLevel:C,transmitValue:o.levels.values[E.transmit.level||h.level],send:E.transmit.send,val:h.levelVal},ue)}}}(h[m]))}function l(E,h,m,V){E._serialize&&y(m,E._serialize,E.serializers,E._stdErrSerialize);const Y=m.slice();let se=Y[0];const ue={};V&&(ue.time=V),ue.level=o.levels.values[h];let de=(E._childLevel|0)+1;if(de<1&&(de=1),se!==null&&typeof se=="object"){for(;de--&&typeof Y[0]=="object";)Object.assign(ue,Y.shift());se=Y.length?r(Y.shift(),Y):void 0}else typeof se=="string"&&(se=r(Y.shift(),Y));return se!==void 0&&(ue.msg=se),ue}function y(E,h,m,V){for(const Y in E)if(V&&E[Y]instanceof Error)E[Y]=o.stdSerializers.err(E[Y]);else if(typeof E[Y]=="object"&&!Array.isArray(E[Y]))for(const se in E[Y])h&&h.indexOf(se)>-1&&se in m&&(E[Y][se]=m[se](E[Y][se]))}function p(E,h,m){return function(){const V=new Array(1+arguments.length);V[0]=h;for(var Y=1;Y<V.length;Y++)V[Y]=arguments[Y-1];return E[m].apply(this,V)}}function _(E,h,m){const V=h.send,Y=h.ts,se=h.methodLevel,ue=h.methodValue,de=h.val,b=E._logEvent.bindings;y(m,E._serialize||Object.keys(E.serializers),E.serializers,E._stdErrSerialize===void 0?!0:E._stdErrSerialize),E._logEvent.ts=Y,E._logEvent.messages=m.filter(function(C){return b.indexOf(C)===-1}),E._logEvent.level.label=se,E._logEvent.level.value=ue,V(se,E._logEvent,de),E._logEvent=D(b)}function D(E){return{ts:0,messages:[],bindings:E||[],level:{label:"",value:0}}}function S(E){const h={type:E.constructor.name,msg:E.message,stack:E.stack};for(const m in E)h[m]===void 0&&(h[m]=E[m]);return h}function P(E){return typeof E.timestamp=="function"?E.timestamp:E.timestamp===!1?ne:L}function I(){return{}}function B(E){return E}function z(){}function ne(){return!1}function L(){return Date.now()}function M(){return Math.round(Date.now()/1e3)}function A(){return new Date(Date.now()).toISOString()}function T(){function E(h){return typeof h<"u"&&h}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return E(self)||E(window)||E(this)||{}}}return Ma}var Xn={},Vh;function kh(){return Vh||(Vh=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.PINO_CUSTOM_CONTEXT_KEY=Xn.PINO_LOGGER_DEFAULTS=void 0,Xn.PINO_LOGGER_DEFAULTS={level:"info"},Xn.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Xn}var ir={},Yh;function $y(){if(Yh)return ir;Yh=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.generateChildLogger=ir.formatChildLoggerContext=ir.getLoggerContext=ir.setBrowserLoggerContext=ir.getBrowserLoggerContext=ir.getDefaultLoggerOptions=void 0;const r=kh();function e(l){return Object.assign(Object.assign({},l),{level:l?.level||r.PINO_LOGGER_DEFAULTS.level})}ir.getDefaultLoggerOptions=e;function t(l,y=r.PINO_CUSTOM_CONTEXT_KEY){return l[y]||""}ir.getBrowserLoggerContext=t;function s(l,y,p=r.PINO_CUSTOM_CONTEXT_KEY){return l[p]=y,l}ir.setBrowserLoggerContext=s;function o(l,y=r.PINO_CUSTOM_CONTEXT_KEY){let p="";return typeof l.bindings>"u"?p=t(l,y):p=l.bindings().context||"",p}ir.getLoggerContext=o;function c(l,y,p=r.PINO_CUSTOM_CONTEXT_KEY){const _=o(l,p);return _.trim()?`${_}/${y}`:y}ir.formatChildLoggerContext=c;function u(l,y,p=r.PINO_CUSTOM_CONTEXT_KEY){const _=c(l,y,p),D=l.child({context:_});return s(D,_,p)}return ir.generateChildLogger=u,ir}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.pino=void 0;const e=Ny,t=e.__importDefault(Fy());Object.defineProperty(r,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(kh(),r),e.__exportStar($y(),r)})(ke);class Uy extends Yn{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class My extends Yn{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class qy{constructor(e,t){this.logger=e,this.core=t}}class By extends Yn{constructor(e,t){super(),this.relayer=e,this.logger=t}}class Hy extends Yn{constructor(e){super()}}class jy{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}}class zy extends Yn{constructor(e,t){super(),this.relayer=e,this.logger=t}}class Ky extends Yn{constructor(e,t){super(),this.core=e,this.logger=t}}class Wy{constructor(e,t){this.projectId=e,this.logger=t}}class Gy{constructor(e,t){this.projectId=e,this.logger=t}}class Vy{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class ky{constructor(e){this.client=e}}var qa={},mi={},Gs={},Vs={};Object.defineProperty(Vs,"__esModule",{value:!0}),Vs.BrowserRandomSource=void 0;const Jh=65536;class Yy{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=Jh)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,Jh)));return t}}Vs.BrowserRandomSource=Yy;function Jy(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ks={},xr={};Object.defineProperty(xr,"__esModule",{value:!0});function Xy(r){for(var e=0;e<r.length;e++)r[e]=0;return r}xr.wipe=Xy;var Qy={},Zy=Object.freeze({__proto__:null,default:Qy}),e_=Kn(Zy);Object.defineProperty(ks,"__esModule",{value:!0}),ks.NodeRandomSource=void 0;const t_=xr;class r_{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Jy<"u"){const e=e_;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,t_.wipe)(t),s}}ks.NodeRandomSource=r_,Object.defineProperty(Gs,"__esModule",{value:!0}),Gs.SystemRandomSource=void 0;const n_=Vs,i_=ks;class s_{constructor(){if(this.isAvailable=!1,this.name="",this._source=new n_.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new i_.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Gs.SystemRandomSource=s_;var Ne={},Xh={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});function e(l,y){var p=l>>>16&65535,_=l&65535,D=y>>>16&65535,S=y&65535;return _*S+(p*S+_*D<<16>>>0)|0}r.mul=Math.imul||e;function t(l,y){return l+y|0}r.add=t;function s(l,y){return l-y|0}r.sub=s;function o(l,y){return l<<y|l>>>32-y}r.rotl=o;function c(l,y){return l<<32-y|l>>>y}r.rotr=c;function u(l){return typeof l=="number"&&isFinite(l)&&Math.floor(l)===l}r.isInteger=Number.isInteger||u,r.MAX_SAFE_INTEGER=9007199254740991,r.isSafeInteger=function(l){return r.isInteger(l)&&l>=-r.MAX_SAFE_INTEGER&&l<=r.MAX_SAFE_INTEGER}})(Xh),Object.defineProperty(Ne,"__esModule",{value:!0});var Qh=Xh;function o_(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])<<16>>16}Ne.readInt16BE=o_;function a_(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])>>>0}Ne.readUint16BE=a_;function c_(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])<<16>>16}Ne.readInt16LE=c_;function u_(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])>>>0}Ne.readUint16LE=u_;function Zh(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>8,e[t+1]=r>>>0,e}Ne.writeUint16BE=Zh,Ne.writeInt16BE=Zh;function ef(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e}Ne.writeUint16LE=ef,Ne.writeInt16LE=ef;function Ba(r,e){return e===void 0&&(e=0),r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}Ne.readInt32BE=Ba;function Ha(r,e){return e===void 0&&(e=0),(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}Ne.readUint32BE=Ha;function ja(r,e){return e===void 0&&(e=0),r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]}Ne.readInt32LE=ja;function za(r,e){return e===void 0&&(e=0),(r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e])>>>0}Ne.readUint32LE=za;function Ys(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}Ne.writeUint32BE=Ys,Ne.writeInt32BE=Ys;function Js(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24,e}Ne.writeUint32LE=Js,Ne.writeInt32LE=Js;function h_(r,e){e===void 0&&(e=0);var t=Ba(r,e),s=Ba(r,e+4);return t*4294967296+s-(s>>31)*4294967296}Ne.readInt64BE=h_;function f_(r,e){e===void 0&&(e=0);var t=Ha(r,e),s=Ha(r,e+4);return t*4294967296+s}Ne.readUint64BE=f_;function l_(r,e){e===void 0&&(e=0);var t=ja(r,e),s=ja(r,e+4);return s*4294967296+t-(t>>31)*4294967296}Ne.readInt64LE=l_;function d_(r,e){e===void 0&&(e=0);var t=za(r,e),s=za(r,e+4);return s*4294967296+t}Ne.readUint64LE=d_;function tf(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Ys(r/4294967296>>>0,e,t),Ys(r>>>0,e,t+4),e}Ne.writeUint64BE=tf,Ne.writeInt64BE=tf;function rf(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Js(r>>>0,e,t),Js(r/4294967296>>>0,e,t+4),e}Ne.writeUint64LE=rf,Ne.writeInt64LE=rf;function p_(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=r/8+t-1;c>=t;c--)s+=e[c]*o,o*=256;return s}Ne.readUintBE=p_;function g_(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=t;c<t+r/8;c++)s+=e[c]*o,o*=256;return s}Ne.readUintLE=g_;function y_(r,e,t,s){if(t===void 0&&(t=new Uint8Array(r/8)),s===void 0&&(s=0),r%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Qh.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=r/8+s-1;c>=s;c--)t[c]=e/o&255,o*=256;return t}Ne.writeUintBE=y_;function __(r,e,t,s){if(t===void 0&&(t=new Uint8Array(r/8)),s===void 0&&(s=0),r%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Qh.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+r/8;c++)t[c]=e/o&255,o*=256;return t}Ne.writeUintLE=__;function v_(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e)}Ne.readFloat32BE=v_;function w_(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e,!0)}Ne.readFloat32LE=w_;function m_(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e)}Ne.readFloat64BE=m_;function b_(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e,!0)}Ne.readFloat64LE=b_;function E_(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,r),e}Ne.writeFloat32BE=E_;function D_(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,r,!0),e}Ne.writeFloat32LE=D_;function S_(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,r),e}Ne.writeFloat64BE=S_;function x_(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,r,!0),e}Ne.writeFloat64LE=x_,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.randomStringForEntropy=r.randomString=r.randomUint32=r.randomBytes=r.defaultRandomSource=void 0;const e=Gs,t=Ne,s=xr;r.defaultRandomSource=new e.SystemRandomSource;function o(p,_=r.defaultRandomSource){return _.randomBytes(p)}r.randomBytes=o;function c(p=r.defaultRandomSource){const _=o(4,p),D=(0,t.readUint32LE)(_);return(0,s.wipe)(_),D}r.randomUint32=c;const u="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function l(p,_=u,D=r.defaultRandomSource){if(_.length<2)throw new Error("randomString charset is too short");if(_.length>256)throw new Error("randomString charset is too long");let S="";const P=_.length,I=256-256%P;for(;p>0;){const B=o(Math.ceil(p*256/I),D);for(let z=0;z<B.length&&p>0;z++){const ne=B[z];ne<I&&(S+=_.charAt(ne%P),p--)}(0,s.wipe)(B)}return S}r.randomString=l;function y(p,_=u,D=r.defaultRandomSource){const S=Math.ceil(p/(Math.log(_.length)/Math.LN2));return l(S,_,D)}r.randomStringForEntropy=y}(mi);var nf={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=Ne,t=xr;r.DIGEST_LENGTH=64,r.BLOCK_SIZE=128;var s=function(){function l(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return l.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},l.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},l.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},l.prototype.update=function(y,p){if(p===void 0&&(p=y.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var _=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<r.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=y[_++],p--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(_=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,y,_,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=y[_++],p--;return this},l.prototype.finish=function(y){if(!this._finished){var p=this._bytesHashed,_=this._bufferLength,D=p/536870912|0,S=p<<3,P=p%128<112?128:256;this._buffer[_]=128;for(var I=_+1;I<P-8;I++)this._buffer[I]=0;e.writeUint32BE(D,this._buffer,P-8),e.writeUint32BE(S,this._buffer,P-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,P),this._finished=!0}for(var I=0;I<this.digestLength/8;I++)e.writeUint32BE(this._stateHi[I],y,I*8),e.writeUint32BE(this._stateLo[I],y,I*8+4);return this},l.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},l.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},l.prototype.restoreState=function(y){return this._stateHi.set(y.stateHi),this._stateLo.set(y.stateLo),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},l.prototype.cleanSavedState=function(y){t.wipe(y.stateHi),t.wipe(y.stateLo),y.buffer&&t.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},l}();r.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(l,y,p,_,D,S,P){for(var I=p[0],B=p[1],z=p[2],ne=p[3],L=p[4],M=p[5],A=p[6],T=p[7],E=_[0],h=_[1],m=_[2],V=_[3],Y=_[4],se=_[5],ue=_[6],de=_[7],b,C,ee,X,W,G,J,re;P>=128;){for(var me=0;me<16;me++){var oe=8*me+S;l[me]=e.readUint32BE(D,oe),y[me]=e.readUint32BE(D,oe+4)}for(var me=0;me<80;me++){var be=I,fe=B,ve=z,j=ne,H=L,F=M,d=A,R=T,ae=E,le=h,xe=m,je=V,We=Y,Ue=se,yt=ue,_t=de;if(b=T,C=de,W=C&65535,G=C>>>16,J=b&65535,re=b>>>16,b=(L>>>14|Y<<32-14)^(L>>>18|Y<<32-18)^(Y>>>41-32|L<<32-(41-32)),C=(Y>>>14|L<<32-14)^(Y>>>18|L<<32-18)^(L>>>41-32|Y<<32-(41-32)),W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,b=L&M^~L&A,C=Y&se^~Y&ue,W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,b=o[me*2],C=o[me*2+1],W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,b=l[me%16],C=y[me%16],W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,G+=W>>>16,J+=G>>>16,re+=J>>>16,ee=J&65535|re<<16,X=W&65535|G<<16,b=ee,C=X,W=C&65535,G=C>>>16,J=b&65535,re=b>>>16,b=(I>>>28|E<<32-28)^(E>>>34-32|I<<32-(34-32))^(E>>>39-32|I<<32-(39-32)),C=(E>>>28|I<<32-28)^(I>>>34-32|E<<32-(34-32))^(I>>>39-32|E<<32-(39-32)),W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,b=I&B^I&z^B&z,C=E&h^E&m^h&m,W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,G+=W>>>16,J+=G>>>16,re+=J>>>16,R=J&65535|re<<16,_t=W&65535|G<<16,b=j,C=je,W=C&65535,G=C>>>16,J=b&65535,re=b>>>16,b=ee,C=X,W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,G+=W>>>16,J+=G>>>16,re+=J>>>16,j=J&65535|re<<16,je=W&65535|G<<16,B=be,z=fe,ne=ve,L=j,M=H,A=F,T=d,I=R,h=ae,m=le,V=xe,Y=je,se=We,ue=Ue,de=yt,E=_t,me%16===15)for(var oe=0;oe<16;oe++)b=l[oe],C=y[oe],W=C&65535,G=C>>>16,J=b&65535,re=b>>>16,b=l[(oe+9)%16],C=y[(oe+9)%16],W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,ee=l[(oe+1)%16],X=y[(oe+1)%16],b=(ee>>>1|X<<32-1)^(ee>>>8|X<<32-8)^ee>>>7,C=(X>>>1|ee<<32-1)^(X>>>8|ee<<32-8)^(X>>>7|ee<<32-7),W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,ee=l[(oe+14)%16],X=y[(oe+14)%16],b=(ee>>>19|X<<32-19)^(X>>>61-32|ee<<32-(61-32))^ee>>>6,C=(X>>>19|ee<<32-19)^(ee>>>61-32|X<<32-(61-32))^(X>>>6|ee<<32-6),W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,G+=W>>>16,J+=G>>>16,re+=J>>>16,l[oe]=J&65535|re<<16,y[oe]=W&65535|G<<16}b=I,C=E,W=C&65535,G=C>>>16,J=b&65535,re=b>>>16,b=p[0],C=_[0],W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,G+=W>>>16,J+=G>>>16,re+=J>>>16,p[0]=I=J&65535|re<<16,_[0]=E=W&65535|G<<16,b=B,C=h,W=C&65535,G=C>>>16,J=b&65535,re=b>>>16,b=p[1],C=_[1],W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,G+=W>>>16,J+=G>>>16,re+=J>>>16,p[1]=B=J&65535|re<<16,_[1]=h=W&65535|G<<16,b=z,C=m,W=C&65535,G=C>>>16,J=b&65535,re=b>>>16,b=p[2],C=_[2],W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,G+=W>>>16,J+=G>>>16,re+=J>>>16,p[2]=z=J&65535|re<<16,_[2]=m=W&65535|G<<16,b=ne,C=V,W=C&65535,G=C>>>16,J=b&65535,re=b>>>16,b=p[3],C=_[3],W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,G+=W>>>16,J+=G>>>16,re+=J>>>16,p[3]=ne=J&65535|re<<16,_[3]=V=W&65535|G<<16,b=L,C=Y,W=C&65535,G=C>>>16,J=b&65535,re=b>>>16,b=p[4],C=_[4],W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,G+=W>>>16,J+=G>>>16,re+=J>>>16,p[4]=L=J&65535|re<<16,_[4]=Y=W&65535|G<<16,b=M,C=se,W=C&65535,G=C>>>16,J=b&65535,re=b>>>16,b=p[5],C=_[5],W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,G+=W>>>16,J+=G>>>16,re+=J>>>16,p[5]=M=J&65535|re<<16,_[5]=se=W&65535|G<<16,b=A,C=ue,W=C&65535,G=C>>>16,J=b&65535,re=b>>>16,b=p[6],C=_[6],W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,G+=W>>>16,J+=G>>>16,re+=J>>>16,p[6]=A=J&65535|re<<16,_[6]=ue=W&65535|G<<16,b=T,C=de,W=C&65535,G=C>>>16,J=b&65535,re=b>>>16,b=p[7],C=_[7],W+=C&65535,G+=C>>>16,J+=b&65535,re+=b>>>16,G+=W>>>16,J+=G>>>16,re+=J>>>16,p[7]=T=J&65535|re<<16,_[7]=de=W&65535|G<<16,S+=128,P-=128}return S}function u(l){var y=new s;y.update(l);var p=y.digest();return y.clean(),p}r.hash=u})(nf),function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.convertSecretKeyToX25519=r.convertPublicKeyToX25519=r.verify=r.sign=r.extractPublicKeyFromSecretKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.SEED_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=r.SIGNATURE_LENGTH=void 0;const e=mi,t=nf,s=xr;r.SIGNATURE_LENGTH=64,r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=64,r.SEED_LENGTH=32;function o(j){const H=new Float64Array(16);if(j)for(let F=0;F<j.length;F++)H[F]=j[F];return H}const c=new Uint8Array(32);c[0]=9;const u=o(),l=o([1]),y=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),_=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),D=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),S=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function P(j,H){for(let F=0;F<16;F++)j[F]=H[F]|0}function I(j){let H=1;for(let F=0;F<16;F++){let d=j[F]+H+65535;H=Math.floor(d/65536),j[F]=d-H*65536}j[0]+=H-1+37*(H-1)}function B(j,H,F){const d=~(F-1);for(let R=0;R<16;R++){const ae=d&(j[R]^H[R]);j[R]^=ae,H[R]^=ae}}function z(j,H){const F=o(),d=o();for(let R=0;R<16;R++)d[R]=H[R];I(d),I(d),I(d);for(let R=0;R<2;R++){F[0]=d[0]-65517;for(let le=1;le<15;le++)F[le]=d[le]-65535-(F[le-1]>>16&1),F[le-1]&=65535;F[15]=d[15]-32767-(F[14]>>16&1);const ae=F[15]>>16&1;F[14]&=65535,B(d,F,1-ae)}for(let R=0;R<16;R++)j[2*R]=d[R]&255,j[2*R+1]=d[R]>>8}function ne(j,H){let F=0;for(let d=0;d<32;d++)F|=j[d]^H[d];return(1&F-1>>>8)-1}function L(j,H){const F=new Uint8Array(32),d=new Uint8Array(32);return z(F,j),z(d,H),ne(F,d)}function M(j){const H=new Uint8Array(32);return z(H,j),H[0]&1}function A(j,H){for(let F=0;F<16;F++)j[F]=H[2*F]+(H[2*F+1]<<8);j[15]&=32767}function T(j,H,F){for(let d=0;d<16;d++)j[d]=H[d]+F[d]}function E(j,H,F){for(let d=0;d<16;d++)j[d]=H[d]-F[d]}function h(j,H,F){let d,R,ae=0,le=0,xe=0,je=0,We=0,Ue=0,yt=0,_t=0,qe=0,Ie=0,Le=0,Fe=0,Be=0,Pe=0,$e=0,Se=0,Ae=0,ze=0,Oe=0,Ge=0,Ye=0,et=0,tt=0,Xe=0,hr=0,wr=0,en=0,fr=0,gn=0,Rn=0,ni=0,St=F[0],vt=F[1],xt=F[2],It=F[3],Et=F[4],wt=F[5],Ut=F[6],Mt=F[7],Ot=F[8],qt=F[9],Pt=F[10],Rt=F[11],At=F[12],lt=F[13],Bt=F[14],Ht=F[15];d=H[0],ae+=d*St,le+=d*vt,xe+=d*xt,je+=d*It,We+=d*Et,Ue+=d*wt,yt+=d*Ut,_t+=d*Mt,qe+=d*Ot,Ie+=d*qt,Le+=d*Pt,Fe+=d*Rt,Be+=d*At,Pe+=d*lt,$e+=d*Bt,Se+=d*Ht,d=H[1],le+=d*St,xe+=d*vt,je+=d*xt,We+=d*It,Ue+=d*Et,yt+=d*wt,_t+=d*Ut,qe+=d*Mt,Ie+=d*Ot,Le+=d*qt,Fe+=d*Pt,Be+=d*Rt,Pe+=d*At,$e+=d*lt,Se+=d*Bt,Ae+=d*Ht,d=H[2],xe+=d*St,je+=d*vt,We+=d*xt,Ue+=d*It,yt+=d*Et,_t+=d*wt,qe+=d*Ut,Ie+=d*Mt,Le+=d*Ot,Fe+=d*qt,Be+=d*Pt,Pe+=d*Rt,$e+=d*At,Se+=d*lt,Ae+=d*Bt,ze+=d*Ht,d=H[3],je+=d*St,We+=d*vt,Ue+=d*xt,yt+=d*It,_t+=d*Et,qe+=d*wt,Ie+=d*Ut,Le+=d*Mt,Fe+=d*Ot,Be+=d*qt,Pe+=d*Pt,$e+=d*Rt,Se+=d*At,Ae+=d*lt,ze+=d*Bt,Oe+=d*Ht,d=H[4],We+=d*St,Ue+=d*vt,yt+=d*xt,_t+=d*It,qe+=d*Et,Ie+=d*wt,Le+=d*Ut,Fe+=d*Mt,Be+=d*Ot,Pe+=d*qt,$e+=d*Pt,Se+=d*Rt,Ae+=d*At,ze+=d*lt,Oe+=d*Bt,Ge+=d*Ht,d=H[5],Ue+=d*St,yt+=d*vt,_t+=d*xt,qe+=d*It,Ie+=d*Et,Le+=d*wt,Fe+=d*Ut,Be+=d*Mt,Pe+=d*Ot,$e+=d*qt,Se+=d*Pt,Ae+=d*Rt,ze+=d*At,Oe+=d*lt,Ge+=d*Bt,Ye+=d*Ht,d=H[6],yt+=d*St,_t+=d*vt,qe+=d*xt,Ie+=d*It,Le+=d*Et,Fe+=d*wt,Be+=d*Ut,Pe+=d*Mt,$e+=d*Ot,Se+=d*qt,Ae+=d*Pt,ze+=d*Rt,Oe+=d*At,Ge+=d*lt,Ye+=d*Bt,et+=d*Ht,d=H[7],_t+=d*St,qe+=d*vt,Ie+=d*xt,Le+=d*It,Fe+=d*Et,Be+=d*wt,Pe+=d*Ut,$e+=d*Mt,Se+=d*Ot,Ae+=d*qt,ze+=d*Pt,Oe+=d*Rt,Ge+=d*At,Ye+=d*lt,et+=d*Bt,tt+=d*Ht,d=H[8],qe+=d*St,Ie+=d*vt,Le+=d*xt,Fe+=d*It,Be+=d*Et,Pe+=d*wt,$e+=d*Ut,Se+=d*Mt,Ae+=d*Ot,ze+=d*qt,Oe+=d*Pt,Ge+=d*Rt,Ye+=d*At,et+=d*lt,tt+=d*Bt,Xe+=d*Ht,d=H[9],Ie+=d*St,Le+=d*vt,Fe+=d*xt,Be+=d*It,Pe+=d*Et,$e+=d*wt,Se+=d*Ut,Ae+=d*Mt,ze+=d*Ot,Oe+=d*qt,Ge+=d*Pt,Ye+=d*Rt,et+=d*At,tt+=d*lt,Xe+=d*Bt,hr+=d*Ht,d=H[10],Le+=d*St,Fe+=d*vt,Be+=d*xt,Pe+=d*It,$e+=d*Et,Se+=d*wt,Ae+=d*Ut,ze+=d*Mt,Oe+=d*Ot,Ge+=d*qt,Ye+=d*Pt,et+=d*Rt,tt+=d*At,Xe+=d*lt,hr+=d*Bt,wr+=d*Ht,d=H[11],Fe+=d*St,Be+=d*vt,Pe+=d*xt,$e+=d*It,Se+=d*Et,Ae+=d*wt,ze+=d*Ut,Oe+=d*Mt,Ge+=d*Ot,Ye+=d*qt,et+=d*Pt,tt+=d*Rt,Xe+=d*At,hr+=d*lt,wr+=d*Bt,en+=d*Ht,d=H[12],Be+=d*St,Pe+=d*vt,$e+=d*xt,Se+=d*It,Ae+=d*Et,ze+=d*wt,Oe+=d*Ut,Ge+=d*Mt,Ye+=d*Ot,et+=d*qt,tt+=d*Pt,Xe+=d*Rt,hr+=d*At,wr+=d*lt,en+=d*Bt,fr+=d*Ht,d=H[13],Pe+=d*St,$e+=d*vt,Se+=d*xt,Ae+=d*It,ze+=d*Et,Oe+=d*wt,Ge+=d*Ut,Ye+=d*Mt,et+=d*Ot,tt+=d*qt,Xe+=d*Pt,hr+=d*Rt,wr+=d*At,en+=d*lt,fr+=d*Bt,gn+=d*Ht,d=H[14],$e+=d*St,Se+=d*vt,Ae+=d*xt,ze+=d*It,Oe+=d*Et,Ge+=d*wt,Ye+=d*Ut,et+=d*Mt,tt+=d*Ot,Xe+=d*qt,hr+=d*Pt,wr+=d*Rt,en+=d*At,fr+=d*lt,gn+=d*Bt,Rn+=d*Ht,d=H[15],Se+=d*St,Ae+=d*vt,ze+=d*xt,Oe+=d*It,Ge+=d*Et,Ye+=d*wt,et+=d*Ut,tt+=d*Mt,Xe+=d*Ot,hr+=d*qt,wr+=d*Pt,en+=d*Rt,fr+=d*At,gn+=d*lt,Rn+=d*Bt,ni+=d*Ht,ae+=38*Ae,le+=38*ze,xe+=38*Oe,je+=38*Ge,We+=38*Ye,Ue+=38*et,yt+=38*tt,_t+=38*Xe,qe+=38*hr,Ie+=38*wr,Le+=38*en,Fe+=38*fr,Be+=38*gn,Pe+=38*Rn,$e+=38*ni,R=1,d=ae+R+65535,R=Math.floor(d/65536),ae=d-R*65536,d=le+R+65535,R=Math.floor(d/65536),le=d-R*65536,d=xe+R+65535,R=Math.floor(d/65536),xe=d-R*65536,d=je+R+65535,R=Math.floor(d/65536),je=d-R*65536,d=We+R+65535,R=Math.floor(d/65536),We=d-R*65536,d=Ue+R+65535,R=Math.floor(d/65536),Ue=d-R*65536,d=yt+R+65535,R=Math.floor(d/65536),yt=d-R*65536,d=_t+R+65535,R=Math.floor(d/65536),_t=d-R*65536,d=qe+R+65535,R=Math.floor(d/65536),qe=d-R*65536,d=Ie+R+65535,R=Math.floor(d/65536),Ie=d-R*65536,d=Le+R+65535,R=Math.floor(d/65536),Le=d-R*65536,d=Fe+R+65535,R=Math.floor(d/65536),Fe=d-R*65536,d=Be+R+65535,R=Math.floor(d/65536),Be=d-R*65536,d=Pe+R+65535,R=Math.floor(d/65536),Pe=d-R*65536,d=$e+R+65535,R=Math.floor(d/65536),$e=d-R*65536,d=Se+R+65535,R=Math.floor(d/65536),Se=d-R*65536,ae+=R-1+37*(R-1),R=1,d=ae+R+65535,R=Math.floor(d/65536),ae=d-R*65536,d=le+R+65535,R=Math.floor(d/65536),le=d-R*65536,d=xe+R+65535,R=Math.floor(d/65536),xe=d-R*65536,d=je+R+65535,R=Math.floor(d/65536),je=d-R*65536,d=We+R+65535,R=Math.floor(d/65536),We=d-R*65536,d=Ue+R+65535,R=Math.floor(d/65536),Ue=d-R*65536,d=yt+R+65535,R=Math.floor(d/65536),yt=d-R*65536,d=_t+R+65535,R=Math.floor(d/65536),_t=d-R*65536,d=qe+R+65535,R=Math.floor(d/65536),qe=d-R*65536,d=Ie+R+65535,R=Math.floor(d/65536),Ie=d-R*65536,d=Le+R+65535,R=Math.floor(d/65536),Le=d-R*65536,d=Fe+R+65535,R=Math.floor(d/65536),Fe=d-R*65536,d=Be+R+65535,R=Math.floor(d/65536),Be=d-R*65536,d=Pe+R+65535,R=Math.floor(d/65536),Pe=d-R*65536,d=$e+R+65535,R=Math.floor(d/65536),$e=d-R*65536,d=Se+R+65535,R=Math.floor(d/65536),Se=d-R*65536,ae+=R-1+37*(R-1),j[0]=ae,j[1]=le,j[2]=xe,j[3]=je,j[4]=We,j[5]=Ue,j[6]=yt,j[7]=_t,j[8]=qe,j[9]=Ie,j[10]=Le,j[11]=Fe,j[12]=Be,j[13]=Pe,j[14]=$e,j[15]=Se}function m(j,H){h(j,H,H)}function V(j,H){const F=o();let d;for(d=0;d<16;d++)F[d]=H[d];for(d=253;d>=0;d--)m(F,F),d!==2&&d!==4&&h(F,F,H);for(d=0;d<16;d++)j[d]=F[d]}function Y(j,H){const F=o();let d;for(d=0;d<16;d++)F[d]=H[d];for(d=250;d>=0;d--)m(F,F),d!==1&&h(F,F,H);for(d=0;d<16;d++)j[d]=F[d]}function se(j,H){const F=o(),d=o(),R=o(),ae=o(),le=o(),xe=o(),je=o(),We=o(),Ue=o();E(F,j[1],j[0]),E(Ue,H[1],H[0]),h(F,F,Ue),T(d,j[0],j[1]),T(Ue,H[0],H[1]),h(d,d,Ue),h(R,j[3],H[3]),h(R,R,p),h(ae,j[2],H[2]),T(ae,ae,ae),E(le,d,F),E(xe,ae,R),T(je,ae,R),T(We,d,F),h(j[0],le,xe),h(j[1],We,je),h(j[2],je,xe),h(j[3],le,We)}function ue(j,H,F){for(let d=0;d<4;d++)B(j[d],H[d],F)}function de(j,H){const F=o(),d=o(),R=o();V(R,H[2]),h(F,H[0],R),h(d,H[1],R),z(j,d),j[31]^=M(F)<<7}function b(j,H,F){P(j[0],u),P(j[1],l),P(j[2],l),P(j[3],u);for(let d=255;d>=0;--d){const R=F[d/8|0]>>(d&7)&1;ue(j,H,R),se(H,j),se(j,j),ue(j,H,R)}}function C(j,H){const F=[o(),o(),o(),o()];P(F[0],_),P(F[1],D),P(F[2],l),h(F[3],_,D),b(j,F,H)}function ee(j){if(j.length!==r.SEED_LENGTH)throw new Error(`ed25519: seed must be ${r.SEED_LENGTH} bytes`);const H=(0,t.hash)(j);H[0]&=248,H[31]&=127,H[31]|=64;const F=new Uint8Array(32),d=[o(),o(),o(),o()];C(d,H),de(F,d);const R=new Uint8Array(64);return R.set(j),R.set(F,32),{publicKey:F,secretKey:R}}r.generateKeyPairFromSeed=ee;function X(j){const H=(0,e.randomBytes)(32,j),F=ee(H);return(0,s.wipe)(H),F}r.generateKeyPair=X;function W(j){if(j.length!==r.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${r.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(j.subarray(32))}r.extractPublicKeyFromSecretKey=W;const G=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(j,H){let F,d,R,ae;for(d=63;d>=32;--d){for(F=0,R=d-32,ae=d-12;R<ae;++R)H[R]+=F-16*H[d]*G[R-(d-32)],F=Math.floor((H[R]+128)/256),H[R]-=F*256;H[R]+=F,H[d]=0}for(F=0,R=0;R<32;R++)H[R]+=F-(H[31]>>4)*G[R],F=H[R]>>8,H[R]&=255;for(R=0;R<32;R++)H[R]-=F*G[R];for(d=0;d<32;d++)H[d+1]+=H[d]>>8,j[d]=H[d]&255}function re(j){const H=new Float64Array(64);for(let F=0;F<64;F++)H[F]=j[F];for(let F=0;F<64;F++)j[F]=0;J(j,H)}function me(j,H){const F=new Float64Array(64),d=[o(),o(),o(),o()],R=(0,t.hash)(j.subarray(0,32));R[0]&=248,R[31]&=127,R[31]|=64;const ae=new Uint8Array(64);ae.set(R.subarray(32),32);const le=new t.SHA512;le.update(ae.subarray(32)),le.update(H);const xe=le.digest();le.clean(),re(xe),C(d,xe),de(ae,d),le.reset(),le.update(ae.subarray(0,32)),le.update(j.subarray(32)),le.update(H);const je=le.digest();re(je);for(let We=0;We<32;We++)F[We]=xe[We];for(let We=0;We<32;We++)for(let Ue=0;Ue<32;Ue++)F[We+Ue]+=je[We]*R[Ue];return J(ae.subarray(32),F),ae}r.sign=me;function oe(j,H){const F=o(),d=o(),R=o(),ae=o(),le=o(),xe=o(),je=o();return P(j[2],l),A(j[1],H),m(R,j[1]),h(ae,R,y),E(R,R,j[2]),T(ae,j[2],ae),m(le,ae),m(xe,le),h(je,xe,le),h(F,je,R),h(F,F,ae),Y(F,F),h(F,F,R),h(F,F,ae),h(F,F,ae),h(j[0],F,ae),m(d,j[0]),h(d,d,ae),L(d,R)&&h(j[0],j[0],S),m(d,j[0]),h(d,d,ae),L(d,R)?-1:(M(j[0])===H[31]>>7&&E(j[0],u,j[0]),h(j[3],j[0],j[1]),0)}function be(j,H,F){const d=new Uint8Array(32),R=[o(),o(),o(),o()],ae=[o(),o(),o(),o()];if(F.length!==r.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${r.SIGNATURE_LENGTH} bytes`);if(oe(ae,j))return!1;const le=new t.SHA512;le.update(F.subarray(0,32)),le.update(j),le.update(H);const xe=le.digest();return re(xe),b(R,ae,xe),C(ae,F.subarray(32)),se(R,ae),de(d,R),!ne(F,d)}r.verify=be;function fe(j){let H=[o(),o(),o(),o()];if(oe(H,j))throw new Error("Ed25519: invalid public key");let F=o(),d=o(),R=H[1];T(F,l,R),E(d,l,R),V(d,d),h(F,F,d);let ae=new Uint8Array(32);return z(ae,F),ae}r.convertPublicKeyToX25519=fe;function ve(j){const H=(0,t.hash)(j.subarray(0,32));H[0]&=248,H[31]&=127,H[31]|=64;const F=new Uint8Array(H.subarray(0,32));return(0,s.wipe)(H),F}r.convertSecretKeyToX25519=ve}(qa);const I_="EdDSA",O_="JWT",sf=".",of="base64url",P_="utf8",A_="utf8",C_=":",T_="did",R_="key",af="base58btc",N_="z",L_="K36",F_=32;function Ka(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function cf(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Ka(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function Wa(r,e){e||(e=r.reduce((o,c)=>o+c.length,0));const t=cf(e);let s=0;for(const o of r)t.set(o,s),s+=o.length;return Ka(t)}function $_(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<r.length;o++){var c=r.charAt(o),u=c.charCodeAt(0);if(t[u]!==255)throw new TypeError(c+" is ambiguous");t[u]=o}var l=r.length,y=r.charAt(0),p=Math.log(l)/Math.log(256),_=Math.log(256)/Math.log(l);function D(I){if(I instanceof Uint8Array||(ArrayBuffer.isView(I)?I=new Uint8Array(I.buffer,I.byteOffset,I.byteLength):Array.isArray(I)&&(I=Uint8Array.from(I))),!(I instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(I.length===0)return"";for(var B=0,z=0,ne=0,L=I.length;ne!==L&&I[ne]===0;)ne++,B++;for(var M=(L-ne)*_+1>>>0,A=new Uint8Array(M);ne!==L;){for(var T=I[ne],E=0,h=M-1;(T!==0||E<z)&&h!==-1;h--,E++)T+=256*A[h]>>>0,A[h]=T%l>>>0,T=T/l>>>0;if(T!==0)throw new Error("Non-zero carry");z=E,ne++}for(var m=M-z;m!==M&&A[m]===0;)m++;for(var V=y.repeat(B);m<M;++m)V+=r.charAt(A[m]);return V}function S(I){if(typeof I!="string")throw new TypeError("Expected String");if(I.length===0)return new Uint8Array;var B=0;if(I[B]!==" "){for(var z=0,ne=0;I[B]===y;)z++,B++;for(var L=(I.length-B)*p+1>>>0,M=new Uint8Array(L);I[B];){var A=t[I.charCodeAt(B)];if(A===255)return;for(var T=0,E=L-1;(A!==0||T<ne)&&E!==-1;E--,T++)A+=l*M[E]>>>0,M[E]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");ne=T,B++}if(I[B]!==" "){for(var h=L-ne;h!==L&&M[h]===0;)h++;for(var m=new Uint8Array(z+(L-h)),V=z;h!==L;)m[V++]=M[h++];return m}}}function P(I){var B=S(I);if(B)return B;throw new Error(`Non-${e} character`)}return{encode:D,decodeUnsafe:S,decode:P}}var U_=$_,M_=U_;const uf=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},q_=r=>new TextEncoder().encode(r),B_=r=>new TextDecoder().decode(r);class H_{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class j_{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return hf(this,e)}}class z_{constructor(e){this.decoders=e}or(e){return hf(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const hf=(r,e)=>new z_({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class K_{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new H_(e,t,s),this.decoder=new j_(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Xs=({name:r,prefix:e,encode:t,decode:s})=>new K_(r,e,t,s),ss=({prefix:r,name:e,alphabet:t})=>{const{encode:s,decode:o}=M_(t,e);return Xs({prefix:r,name:e,encode:s,decode:c=>uf(o(c))})},W_=(r,e,t,s)=>{const o={};for(let _=0;_<e.length;++_)o[e[_]]=_;let c=r.length;for(;r[c-1]==="=";)--c;const u=new Uint8Array(c*t/8|0);let l=0,y=0,p=0;for(let _=0;_<c;++_){const D=o[r[_]];if(D===void 0)throw new SyntaxError(`Non-${s} character`);y=y<<t|D,l+=t,l>=8&&(l-=8,u[p++]=255&y>>l)}if(l>=t||255&y<<8-l)throw new SyntaxError("Unexpected end of data");return u},G_=(r,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",u=0,l=0;for(let y=0;y<r.length;++y)for(l=l<<8|r[y],u+=8;u>t;)u-=t,c+=e[o&l>>u];if(u&&(c+=e[o&l<<t-u]),s)for(;c.length*t&7;)c+="=";return c},Jt=({name:r,prefix:e,bitsPerChar:t,alphabet:s})=>Xs({prefix:e,name:r,encode(o){return G_(o,s,t)},decode(o){return W_(o,s,t,r)}}),V_=Xs({prefix:"\0",name:"identity",encode:r=>B_(r),decode:r=>q_(r)});var k_=Object.freeze({__proto__:null,identity:V_});const Y_=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var J_=Object.freeze({__proto__:null,base2:Y_});const X_=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Q_=Object.freeze({__proto__:null,base8:X_});const Z_=ss({prefix:"9",name:"base10",alphabet:"0123456789"});var ev=Object.freeze({__proto__:null,base10:Z_});const tv=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),rv=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var nv=Object.freeze({__proto__:null,base16:tv,base16upper:rv});const iv=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),sv=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ov=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),av=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),cv=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),uv=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),hv=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),fv=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),lv=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var dv=Object.freeze({__proto__:null,base32:iv,base32upper:sv,base32pad:ov,base32padupper:av,base32hex:cv,base32hexupper:uv,base32hexpad:hv,base32hexpadupper:fv,base32z:lv});const pv=ss({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),gv=ss({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var yv=Object.freeze({__proto__:null,base36:pv,base36upper:gv});const _v=ss({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),vv=ss({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var wv=Object.freeze({__proto__:null,base58btc:_v,base58flickr:vv});const mv=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),bv=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ev=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Dv=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Sv=Object.freeze({__proto__:null,base64:mv,base64pad:bv,base64url:Ev,base64urlpad:Dv});const ff=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),xv=ff.reduce((r,e,t)=>(r[t]=e,r),[]),Iv=ff.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function Ov(r){return r.reduce((e,t)=>(e+=xv[t],e),"")}function Pv(r){const e=[];for(const t of r){const s=Iv[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const Av=Xs({prefix:"\u{1F680}",name:"base256emoji",encode:Ov,decode:Pv});var Cv=Object.freeze({__proto__:null,base256emoji:Av}),Tv=df,lf=128,Rv=127,Nv=~Rv,Lv=Math.pow(2,31);function df(r,e,t){e=e||[],t=t||0;for(var s=t;r>=Lv;)e[t++]=r&255|lf,r/=128;for(;r&Nv;)e[t++]=r&255|lf,r>>>=7;return e[t]=r|0,df.bytes=t-s+1,e}var Fv=Ga,$v=128,pf=127;function Ga(r,s){var t=0,s=s||0,o=0,c=s,u,l=r.length;do{if(c>=l)throw Ga.bytes=0,new RangeError("Could not decode varint");u=r[c++],t+=o<28?(u&pf)<<o:(u&pf)*Math.pow(2,o),o+=7}while(u>=$v);return Ga.bytes=c-s,t}var Uv=Math.pow(2,7),Mv=Math.pow(2,14),qv=Math.pow(2,21),Bv=Math.pow(2,28),Hv=Math.pow(2,35),jv=Math.pow(2,42),zv=Math.pow(2,49),Kv=Math.pow(2,56),Wv=Math.pow(2,63),Gv=function(r){return r<Uv?1:r<Mv?2:r<qv?3:r<Bv?4:r<Hv?5:r<jv?6:r<zv?7:r<Kv?8:r<Wv?9:10},Vv={encode:Tv,decode:Fv,encodingLength:Gv},gf=Vv;const yf=(r,e,t=0)=>(gf.encode(r,e,t),e),_f=r=>gf.encodingLength(r),Va=(r,e)=>{const t=e.byteLength,s=_f(r),o=s+_f(t),c=new Uint8Array(o+t);return yf(r,c,0),yf(t,c,s),c.set(e,o),new kv(r,t,e,c)};class kv{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const vf=({name:r,code:e,encode:t})=>new Yv(r,e,t);class Yv{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Va(this.code,t):t.then(s=>Va(this.code,s))}else throw Error("Unknown type, must be binary type")}}const wf=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),Jv=vf({name:"sha2-256",code:18,encode:wf("SHA-256")}),Xv=vf({name:"sha2-512",code:19,encode:wf("SHA-512")});var Qv=Object.freeze({__proto__:null,sha256:Jv,sha512:Xv});const mf=0,Zv="identity",bf=uf;var e1=Object.freeze({__proto__:null,identity:{code:mf,name:Zv,encode:bf,digest:r=>Va(mf,bf(r))}});new TextEncoder,new TextDecoder;const Ef={...k_,...J_,...Q_,...ev,...nv,...dv,...yv,...wv,...Sv,...Cv};({...Qv,...e1});function Df(r,e,t,s){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:s}}}const Sf=Df("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),ka=Df("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=cf(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),xf={utf8:Sf,"utf-8":Sf,hex:Ef.base16,latin1:ka,ascii:ka,binary:ka,...Ef};function sr(r,e="utf8"){const t=xf[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function _r(r,e="utf8"){const t=xf[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Ka(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function Qs(r){return sr(_r(Gn(r),P_),of)}function If(r){const e=_r(L_,af),t=N_+sr(Wa([e,r]),af);return[T_,R_,t].join(C_)}function t1(r){return sr(r,of)}function r1(r){return _r([Qs(r.header),Qs(r.payload)].join(sf),A_)}function n1(r){return[Qs(r.header),Qs(r.payload),t1(r.signature)].join(sf)}function Of(r=mi.randomBytes(F_)){return qa.generateKeyPairFromSeed(r)}async function i1(r,e,t,s,o=_e.fromMiliseconds(Date.now())){const c={alg:I_,typ:O_},u=If(s.publicKey),l=o+t,y={iss:u,sub:r,aud:e,iat:o,exp:l},p=r1({header:c,payload:y}),_=qa.sign(s.secretKey,p);return n1({header:c,payload:y,signature:_})}var Ya={},Zs={};Object.defineProperty(Zs,"__esModule",{value:!0});var er=Ne,Ja=xr,s1=20;function o1(r,e,t){for(var s=1634760805,o=857760878,c=2036477234,u=1797285236,l=t[3]<<24|t[2]<<16|t[1]<<8|t[0],y=t[7]<<24|t[6]<<16|t[5]<<8|t[4],p=t[11]<<24|t[10]<<16|t[9]<<8|t[8],_=t[15]<<24|t[14]<<16|t[13]<<8|t[12],D=t[19]<<24|t[18]<<16|t[17]<<8|t[16],S=t[23]<<24|t[22]<<16|t[21]<<8|t[20],P=t[27]<<24|t[26]<<16|t[25]<<8|t[24],I=t[31]<<24|t[30]<<16|t[29]<<8|t[28],B=e[3]<<24|e[2]<<16|e[1]<<8|e[0],z=e[7]<<24|e[6]<<16|e[5]<<8|e[4],ne=e[11]<<24|e[10]<<16|e[9]<<8|e[8],L=e[15]<<24|e[14]<<16|e[13]<<8|e[12],M=s,A=o,T=c,E=u,h=l,m=y,V=p,Y=_,se=D,ue=S,de=P,b=I,C=B,ee=z,X=ne,W=L,G=0;G<s1;G+=2)M=M+h|0,C^=M,C=C>>>32-16|C<<16,se=se+C|0,h^=se,h=h>>>32-12|h<<12,A=A+m|0,ee^=A,ee=ee>>>32-16|ee<<16,ue=ue+ee|0,m^=ue,m=m>>>32-12|m<<12,T=T+V|0,X^=T,X=X>>>32-16|X<<16,de=de+X|0,V^=de,V=V>>>32-12|V<<12,E=E+Y|0,W^=E,W=W>>>32-16|W<<16,b=b+W|0,Y^=b,Y=Y>>>32-12|Y<<12,T=T+V|0,X^=T,X=X>>>32-8|X<<8,de=de+X|0,V^=de,V=V>>>32-7|V<<7,E=E+Y|0,W^=E,W=W>>>32-8|W<<8,b=b+W|0,Y^=b,Y=Y>>>32-7|Y<<7,A=A+m|0,ee^=A,ee=ee>>>32-8|ee<<8,ue=ue+ee|0,m^=ue,m=m>>>32-7|m<<7,M=M+h|0,C^=M,C=C>>>32-8|C<<8,se=se+C|0,h^=se,h=h>>>32-7|h<<7,M=M+m|0,W^=M,W=W>>>32-16|W<<16,de=de+W|0,m^=de,m=m>>>32-12|m<<12,A=A+V|0,C^=A,C=C>>>32-16|C<<16,b=b+C|0,V^=b,V=V>>>32-12|V<<12,T=T+Y|0,ee^=T,ee=ee>>>32-16|ee<<16,se=se+ee|0,Y^=se,Y=Y>>>32-12|Y<<12,E=E+h|0,X^=E,X=X>>>32-16|X<<16,ue=ue+X|0,h^=ue,h=h>>>32-12|h<<12,T=T+Y|0,ee^=T,ee=ee>>>32-8|ee<<8,se=se+ee|0,Y^=se,Y=Y>>>32-7|Y<<7,E=E+h|0,X^=E,X=X>>>32-8|X<<8,ue=ue+X|0,h^=ue,h=h>>>32-7|h<<7,A=A+V|0,C^=A,C=C>>>32-8|C<<8,b=b+C|0,V^=b,V=V>>>32-7|V<<7,M=M+m|0,W^=M,W=W>>>32-8|W<<8,de=de+W|0,m^=de,m=m>>>32-7|m<<7;er.writeUint32LE(M+s|0,r,0),er.writeUint32LE(A+o|0,r,4),er.writeUint32LE(T+c|0,r,8),er.writeUint32LE(E+u|0,r,12),er.writeUint32LE(h+l|0,r,16),er.writeUint32LE(m+y|0,r,20),er.writeUint32LE(V+p|0,r,24),er.writeUint32LE(Y+_|0,r,28),er.writeUint32LE(se+D|0,r,32),er.writeUint32LE(ue+S|0,r,36),er.writeUint32LE(de+P|0,r,40),er.writeUint32LE(b+I|0,r,44),er.writeUint32LE(C+B|0,r,48),er.writeUint32LE(ee+z|0,r,52),er.writeUint32LE(X+ne|0,r,56),er.writeUint32LE(W+L|0,r,60)}function Pf(r,e,t,s,o){if(o===void 0&&(o=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,u;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),u=c.length-e.length,c.set(e,u)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,u=o}for(var l=new Uint8Array(64),y=0;y<t.length;y+=64){o1(l,c,r);for(var p=y;p<y+64&&p<t.length;p++)s[p]=t[p]^l[p-y];c1(c,0,u)}return Ja.wipe(l),o===0&&Ja.wipe(c),s}Zs.streamXOR=Pf;function a1(r,e,t,s){return s===void 0&&(s=0),Ja.wipe(t),Pf(r,e,t,t,s)}Zs.stream=a1;function c1(r,e,t){for(var s=1;t--;)s=s+(r[e]&255)|0,r[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var Af={},On={};Object.defineProperty(On,"__esModule",{value:!0});function u1(r,e,t){return~(r-1)&e|r-1&t}On.select=u1;function h1(r,e){return(r|0)-(e|0)-1>>>31&1}On.lessOrEqual=h1;function Cf(r,e){if(r.length!==e.length)return 0;for(var t=0,s=0;s<r.length;s++)t|=r[s]^e[s];return 1&t-1>>>8}On.compare=Cf;function f1(r,e){return r.length===0||e.length===0?!1:Cf(r,e)!==0}On.equal=f1,function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=On,t=xr;r.DIGEST_LENGTH=16;var s=function(){function u(l){this.digestLength=r.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var y=l[0]|l[1]<<8;this._r[0]=y&8191;var p=l[2]|l[3]<<8;this._r[1]=(y>>>13|p<<3)&8191;var _=l[4]|l[5]<<8;this._r[2]=(p>>>10|_<<6)&7939;var D=l[6]|l[7]<<8;this._r[3]=(_>>>7|D<<9)&8191;var S=l[8]|l[9]<<8;this._r[4]=(D>>>4|S<<12)&255,this._r[5]=S>>>1&8190;var P=l[10]|l[11]<<8;this._r[6]=(S>>>14|P<<2)&8191;var I=l[12]|l[13]<<8;this._r[7]=(P>>>11|I<<5)&8065;var B=l[14]|l[15]<<8;this._r[8]=(I>>>8|B<<8)&8191,this._r[9]=B>>>5&127,this._pad[0]=l[16]|l[17]<<8,this._pad[1]=l[18]|l[19]<<8,this._pad[2]=l[20]|l[21]<<8,this._pad[3]=l[22]|l[23]<<8,this._pad[4]=l[24]|l[25]<<8,this._pad[5]=l[26]|l[27]<<8,this._pad[6]=l[28]|l[29]<<8,this._pad[7]=l[30]|l[31]<<8}return u.prototype._blocks=function(l,y,p){for(var _=this._fin?0:2048,D=this._h[0],S=this._h[1],P=this._h[2],I=this._h[3],B=this._h[4],z=this._h[5],ne=this._h[6],L=this._h[7],M=this._h[8],A=this._h[9],T=this._r[0],E=this._r[1],h=this._r[2],m=this._r[3],V=this._r[4],Y=this._r[5],se=this._r[6],ue=this._r[7],de=this._r[8],b=this._r[9];p>=16;){var C=l[y+0]|l[y+1]<<8;D+=C&8191;var ee=l[y+2]|l[y+3]<<8;S+=(C>>>13|ee<<3)&8191;var X=l[y+4]|l[y+5]<<8;P+=(ee>>>10|X<<6)&8191;var W=l[y+6]|l[y+7]<<8;I+=(X>>>7|W<<9)&8191;var G=l[y+8]|l[y+9]<<8;B+=(W>>>4|G<<12)&8191,z+=G>>>1&8191;var J=l[y+10]|l[y+11]<<8;ne+=(G>>>14|J<<2)&8191;var re=l[y+12]|l[y+13]<<8;L+=(J>>>11|re<<5)&8191;var me=l[y+14]|l[y+15]<<8;M+=(re>>>8|me<<8)&8191,A+=me>>>5|_;var oe=0,be=oe;be+=D*T,be+=S*(5*b),be+=P*(5*de),be+=I*(5*ue),be+=B*(5*se),oe=be>>>13,be&=8191,be+=z*(5*Y),be+=ne*(5*V),be+=L*(5*m),be+=M*(5*h),be+=A*(5*E),oe+=be>>>13,be&=8191;var fe=oe;fe+=D*E,fe+=S*T,fe+=P*(5*b),fe+=I*(5*de),fe+=B*(5*ue),oe=fe>>>13,fe&=8191,fe+=z*(5*se),fe+=ne*(5*Y),fe+=L*(5*V),fe+=M*(5*m),fe+=A*(5*h),oe+=fe>>>13,fe&=8191;var ve=oe;ve+=D*h,ve+=S*E,ve+=P*T,ve+=I*(5*b),ve+=B*(5*de),oe=ve>>>13,ve&=8191,ve+=z*(5*ue),ve+=ne*(5*se),ve+=L*(5*Y),ve+=M*(5*V),ve+=A*(5*m),oe+=ve>>>13,ve&=8191;var j=oe;j+=D*m,j+=S*h,j+=P*E,j+=I*T,j+=B*(5*b),oe=j>>>13,j&=8191,j+=z*(5*de),j+=ne*(5*ue),j+=L*(5*se),j+=M*(5*Y),j+=A*(5*V),oe+=j>>>13,j&=8191;var H=oe;H+=D*V,H+=S*m,H+=P*h,H+=I*E,H+=B*T,oe=H>>>13,H&=8191,H+=z*(5*b),H+=ne*(5*de),H+=L*(5*ue),H+=M*(5*se),H+=A*(5*Y),oe+=H>>>13,H&=8191;var F=oe;F+=D*Y,F+=S*V,F+=P*m,F+=I*h,F+=B*E,oe=F>>>13,F&=8191,F+=z*T,F+=ne*(5*b),F+=L*(5*de),F+=M*(5*ue),F+=A*(5*se),oe+=F>>>13,F&=8191;var d=oe;d+=D*se,d+=S*Y,d+=P*V,d+=I*m,d+=B*h,oe=d>>>13,d&=8191,d+=z*E,d+=ne*T,d+=L*(5*b),d+=M*(5*de),d+=A*(5*ue),oe+=d>>>13,d&=8191;var R=oe;R+=D*ue,R+=S*se,R+=P*Y,R+=I*V,R+=B*m,oe=R>>>13,R&=8191,R+=z*h,R+=ne*E,R+=L*T,R+=M*(5*b),R+=A*(5*de),oe+=R>>>13,R&=8191;var ae=oe;ae+=D*de,ae+=S*ue,ae+=P*se,ae+=I*Y,ae+=B*V,oe=ae>>>13,ae&=8191,ae+=z*m,ae+=ne*h,ae+=L*E,ae+=M*T,ae+=A*(5*b),oe+=ae>>>13,ae&=8191;var le=oe;le+=D*b,le+=S*de,le+=P*ue,le+=I*se,le+=B*Y,oe=le>>>13,le&=8191,le+=z*V,le+=ne*m,le+=L*h,le+=M*E,le+=A*T,oe+=le>>>13,le&=8191,oe=(oe<<2)+oe|0,oe=oe+be|0,be=oe&8191,oe=oe>>>13,fe+=oe,D=be,S=fe,P=ve,I=j,B=H,z=F,ne=d,L=R,M=ae,A=le,y+=16,p-=16}this._h[0]=D,this._h[1]=S,this._h[2]=P,this._h[3]=I,this._h[4]=B,this._h[5]=z,this._h[6]=ne,this._h[7]=L,this._h[8]=M,this._h[9]=A},u.prototype.finish=function(l,y){y===void 0&&(y=0);var p=new Uint16Array(10),_,D,S,P;if(this._leftover){for(P=this._leftover,this._buffer[P++]=1;P<16;P++)this._buffer[P]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(_=this._h[1]>>>13,this._h[1]&=8191,P=2;P<10;P++)this._h[P]+=_,_=this._h[P]>>>13,this._h[P]&=8191;for(this._h[0]+=_*5,_=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=_,_=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=_,p[0]=this._h[0]+5,_=p[0]>>>13,p[0]&=8191,P=1;P<10;P++)p[P]=this._h[P]+_,_=p[P]>>>13,p[P]&=8191;for(p[9]-=8192,D=(_^1)-1,P=0;P<10;P++)p[P]&=D;for(D=~D,P=0;P<10;P++)this._h[P]=this._h[P]&D|p[P];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,S=this._h[0]+this._pad[0],this._h[0]=S&65535,P=1;P<8;P++)S=(this._h[P]+this._pad[P]|0)+(S>>>16)|0,this._h[P]=S&65535;return l[y+0]=this._h[0]>>>0,l[y+1]=this._h[0]>>>8,l[y+2]=this._h[1]>>>0,l[y+3]=this._h[1]>>>8,l[y+4]=this._h[2]>>>0,l[y+5]=this._h[2]>>>8,l[y+6]=this._h[3]>>>0,l[y+7]=this._h[3]>>>8,l[y+8]=this._h[4]>>>0,l[y+9]=this._h[4]>>>8,l[y+10]=this._h[5]>>>0,l[y+11]=this._h[5]>>>8,l[y+12]=this._h[6]>>>0,l[y+13]=this._h[6]>>>8,l[y+14]=this._h[7]>>>0,l[y+15]=this._h[7]>>>8,this._finished=!0,this},u.prototype.update=function(l){var y=0,p=l.length,_;if(this._leftover){_=16-this._leftover,_>p&&(_=p);for(var D=0;D<_;D++)this._buffer[this._leftover+D]=l[y+D];if(p-=_,y+=_,this._leftover+=_,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(p>=16&&(_=p-p%16,this._blocks(l,y,_),y+=_,p-=_),p){for(var D=0;D<p;D++)this._buffer[this._leftover+D]=l[y+D];this._leftover+=p}return this},u.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var l=new Uint8Array(16);return this.finish(l),l},u.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},u}();r.Poly1305=s;function o(u,l){var y=new s(u);y.update(l);var p=y.digest();return y.clean(),p}r.oneTimeAuth=o;function c(u,l){return u.length!==r.DIGEST_LENGTH||l.length!==r.DIGEST_LENGTH?!1:e.equal(u,l)}r.equal=c}(Af),function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=Zs,t=Af,s=xr,o=Ne,c=On;r.KEY_LENGTH=32,r.NONCE_LENGTH=12,r.TAG_LENGTH=16;var u=new Uint8Array(16),l=function(){function y(p){if(this.nonceLength=r.NONCE_LENGTH,this.tagLength=r.TAG_LENGTH,p.length!==r.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(p)}return y.prototype.seal=function(p,_,D,S){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var P=new Uint8Array(16);P.set(p,P.length-p.length);var I=new Uint8Array(32);e.stream(this._key,P,I,4);var B=_.length+this.tagLength,z;if(S){if(S.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");z=S}else z=new Uint8Array(B);return e.streamXOR(this._key,P,_,z,4),this._authenticate(z.subarray(z.length-this.tagLength,z.length),I,z.subarray(0,z.length-this.tagLength),D),s.wipe(P),z},y.prototype.open=function(p,_,D,S){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(_.length<this.tagLength)return null;var P=new Uint8Array(16);P.set(p,P.length-p.length);var I=new Uint8Array(32);e.stream(this._key,P,I,4);var B=new Uint8Array(this.tagLength);if(this._authenticate(B,I,_.subarray(0,_.length-this.tagLength),D),!c.equal(B,_.subarray(_.length-this.tagLength,_.length)))return null;var z=_.length-this.tagLength,ne;if(S){if(S.length!==z)throw new Error("ChaCha20Poly1305: incorrect destination length");ne=S}else ne=new Uint8Array(z);return e.streamXOR(this._key,P,_.subarray(0,_.length-this.tagLength),ne,4),s.wipe(P),ne},y.prototype.clean=function(){return s.wipe(this._key),this},y.prototype._authenticate=function(p,_,D,S){var P=new t.Poly1305(_);S&&(P.update(S),S.length%16>0&&P.update(u.subarray(S.length%16))),P.update(D),D.length%16>0&&P.update(u.subarray(D.length%16));var I=new Uint8Array(8);S&&o.writeUint64LE(S.length,I),P.update(I),o.writeUint64LE(D.length,I),P.update(I);for(var B=P.digest(),z=0;z<B.length;z++)p[z]=B[z];P.clean(),s.wipe(B),s.wipe(I)},y}();r.ChaCha20Poly1305=l}(Ya);var Tf={},os={},Xa={};Object.defineProperty(Xa,"__esModule",{value:!0});function l1(r){return typeof r.saveState<"u"&&typeof r.restoreState<"u"&&typeof r.cleanSavedState<"u"}Xa.isSerializableHash=l1,Object.defineProperty(os,"__esModule",{value:!0});var Qr=Xa,d1=On,p1=xr,Rf=function(){function r(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),Qr.isSerializableHash(this._inner)&&Qr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),p1.wipe(s)}return r.prototype.reset=function(){if(!Qr.isSerializableHash(this._inner)||!Qr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){Qr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Qr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(e){return this._inner.update(e),this},r.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(!Qr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(e){if(!Qr.isSerializableHash(this._inner)||!Qr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(e){if(!Qr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},r}();os.HMAC=Rf;function g1(r,e,t){var s=new Rf(r,e);s.update(t);var o=s.digest();return s.clean(),o}os.hmac=g1,os.equal=d1.equal,Object.defineProperty(Tf,"__esModule",{value:!0});var Nf=os,Lf=xr,y1=function(){function r(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=Nf.hmac(this._hash,s,t);this._hmac=new Nf.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},r.prototype.clean=function(){this._hmac.clean(),Lf.wipe(this._buffer),Lf.wipe(this._counter),this._bufpos=0},r}(),_1=Tf.HKDF=y1,eo={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=Ne,t=xr;r.DIGEST_LENGTH=32,r.BLOCK_SIZE=64;var s=function(){function l(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return l.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},l.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},l.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},l.prototype.update=function(y,p){if(p===void 0&&(p=y.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var _=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&p>0;)this._buffer[this._bufferLength++]=y[_++],p--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(_=c(this._temp,this._state,y,_,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=y[_++],p--;return this},l.prototype.finish=function(y){if(!this._finished){var p=this._bytesHashed,_=this._bufferLength,D=p/536870912|0,S=p<<3,P=p%64<56?64:128;this._buffer[_]=128;for(var I=_+1;I<P-8;I++)this._buffer[I]=0;e.writeUint32BE(D,this._buffer,P-8),e.writeUint32BE(S,this._buffer,P-4),c(this._temp,this._state,this._buffer,0,P),this._finished=!0}for(var I=0;I<this.digestLength/4;I++)e.writeUint32BE(this._state[I],y,I*4);return this},l.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},l.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},l.prototype.restoreState=function(y){return this._state.set(y.state),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},l.prototype.cleanSavedState=function(y){t.wipe(y.state),y.buffer&&t.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},l}();r.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(l,y,p,_,D){for(;D>=64;){for(var S=y[0],P=y[1],I=y[2],B=y[3],z=y[4],ne=y[5],L=y[6],M=y[7],A=0;A<16;A++){var T=_+A*4;l[A]=e.readUint32BE(p,T)}for(var A=16;A<64;A++){var E=l[A-2],h=(E>>>17|E<<32-17)^(E>>>19|E<<32-19)^E>>>10;E=l[A-15];var m=(E>>>7|E<<32-7)^(E>>>18|E<<32-18)^E>>>3;l[A]=(h+l[A-7]|0)+(m+l[A-16]|0)}for(var A=0;A<64;A++){var h=(((z>>>6|z<<26)^(z>>>11|z<<21)^(z>>>25|z<<7))+(z&ne^~z&L)|0)+(M+(o[A]+l[A]|0)|0)|0,m=((S>>>2|S<<32-2)^(S>>>13|S<<32-13)^(S>>>22|S<<32-22))+(S&P^S&I^P&I)|0;M=L,L=ne,ne=z,z=B+h|0,B=I,I=P,P=S,S=h+m|0}y[0]+=S,y[1]+=P,y[2]+=I,y[3]+=B,y[4]+=z,y[5]+=ne,y[6]+=L,y[7]+=M,_+=64,D-=64}return _}function u(l){var y=new s;y.update(l);var p=y.digest();return y.clean(),p}r.hash=u})(eo);var Qa={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.sharedKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.scalarMultBase=r.scalarMult=r.SHARED_KEY_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=void 0;const e=mi,t=xr;r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=32,r.SHARED_KEY_LENGTH=32;function s(A){const T=new Float64Array(16);if(A)for(let E=0;E<A.length;E++)T[E]=A[E];return T}const o=new Uint8Array(32);o[0]=9;const c=s([56129,1]);function u(A){let T=1;for(let E=0;E<16;E++){let h=A[E]+T+65535;T=Math.floor(h/65536),A[E]=h-T*65536}A[0]+=T-1+37*(T-1)}function l(A,T,E){const h=~(E-1);for(let m=0;m<16;m++){const V=h&(A[m]^T[m]);A[m]^=V,T[m]^=V}}function y(A,T){const E=s(),h=s();for(let m=0;m<16;m++)h[m]=T[m];u(h),u(h),u(h);for(let m=0;m<2;m++){E[0]=h[0]-65517;for(let Y=1;Y<15;Y++)E[Y]=h[Y]-65535-(E[Y-1]>>16&1),E[Y-1]&=65535;E[15]=h[15]-32767-(E[14]>>16&1);const V=E[15]>>16&1;E[14]&=65535,l(h,E,1-V)}for(let m=0;m<16;m++)A[2*m]=h[m]&255,A[2*m+1]=h[m]>>8}function p(A,T){for(let E=0;E<16;E++)A[E]=T[2*E]+(T[2*E+1]<<8);A[15]&=32767}function _(A,T,E){for(let h=0;h<16;h++)A[h]=T[h]+E[h]}function D(A,T,E){for(let h=0;h<16;h++)A[h]=T[h]-E[h]}function S(A,T,E){let h,m,V=0,Y=0,se=0,ue=0,de=0,b=0,C=0,ee=0,X=0,W=0,G=0,J=0,re=0,me=0,oe=0,be=0,fe=0,ve=0,j=0,H=0,F=0,d=0,R=0,ae=0,le=0,xe=0,je=0,We=0,Ue=0,yt=0,_t=0,qe=E[0],Ie=E[1],Le=E[2],Fe=E[3],Be=E[4],Pe=E[5],$e=E[6],Se=E[7],Ae=E[8],ze=E[9],Oe=E[10],Ge=E[11],Ye=E[12],et=E[13],tt=E[14],Xe=E[15];h=T[0],V+=h*qe,Y+=h*Ie,se+=h*Le,ue+=h*Fe,de+=h*Be,b+=h*Pe,C+=h*$e,ee+=h*Se,X+=h*Ae,W+=h*ze,G+=h*Oe,J+=h*Ge,re+=h*Ye,me+=h*et,oe+=h*tt,be+=h*Xe,h=T[1],Y+=h*qe,se+=h*Ie,ue+=h*Le,de+=h*Fe,b+=h*Be,C+=h*Pe,ee+=h*$e,X+=h*Se,W+=h*Ae,G+=h*ze,J+=h*Oe,re+=h*Ge,me+=h*Ye,oe+=h*et,be+=h*tt,fe+=h*Xe,h=T[2],se+=h*qe,ue+=h*Ie,de+=h*Le,b+=h*Fe,C+=h*Be,ee+=h*Pe,X+=h*$e,W+=h*Se,G+=h*Ae,J+=h*ze,re+=h*Oe,me+=h*Ge,oe+=h*Ye,be+=h*et,fe+=h*tt,ve+=h*Xe,h=T[3],ue+=h*qe,de+=h*Ie,b+=h*Le,C+=h*Fe,ee+=h*Be,X+=h*Pe,W+=h*$e,G+=h*Se,J+=h*Ae,re+=h*ze,me+=h*Oe,oe+=h*Ge,be+=h*Ye,fe+=h*et,ve+=h*tt,j+=h*Xe,h=T[4],de+=h*qe,b+=h*Ie,C+=h*Le,ee+=h*Fe,X+=h*Be,W+=h*Pe,G+=h*$e,J+=h*Se,re+=h*Ae,me+=h*ze,oe+=h*Oe,be+=h*Ge,fe+=h*Ye,ve+=h*et,j+=h*tt,H+=h*Xe,h=T[5],b+=h*qe,C+=h*Ie,ee+=h*Le,X+=h*Fe,W+=h*Be,G+=h*Pe,J+=h*$e,re+=h*Se,me+=h*Ae,oe+=h*ze,be+=h*Oe,fe+=h*Ge,ve+=h*Ye,j+=h*et,H+=h*tt,F+=h*Xe,h=T[6],C+=h*qe,ee+=h*Ie,X+=h*Le,W+=h*Fe,G+=h*Be,J+=h*Pe,re+=h*$e,me+=h*Se,oe+=h*Ae,be+=h*ze,fe+=h*Oe,ve+=h*Ge,j+=h*Ye,H+=h*et,F+=h*tt,d+=h*Xe,h=T[7],ee+=h*qe,X+=h*Ie,W+=h*Le,G+=h*Fe,J+=h*Be,re+=h*Pe,me+=h*$e,oe+=h*Se,be+=h*Ae,fe+=h*ze,ve+=h*Oe,j+=h*Ge,H+=h*Ye,F+=h*et,d+=h*tt,R+=h*Xe,h=T[8],X+=h*qe,W+=h*Ie,G+=h*Le,J+=h*Fe,re+=h*Be,me+=h*Pe,oe+=h*$e,be+=h*Se,fe+=h*Ae,ve+=h*ze,j+=h*Oe,H+=h*Ge,F+=h*Ye,d+=h*et,R+=h*tt,ae+=h*Xe,h=T[9],W+=h*qe,G+=h*Ie,J+=h*Le,re+=h*Fe,me+=h*Be,oe+=h*Pe,be+=h*$e,fe+=h*Se,ve+=h*Ae,j+=h*ze,H+=h*Oe,F+=h*Ge,d+=h*Ye,R+=h*et,ae+=h*tt,le+=h*Xe,h=T[10],G+=h*qe,J+=h*Ie,re+=h*Le,me+=h*Fe,oe+=h*Be,be+=h*Pe,fe+=h*$e,ve+=h*Se,j+=h*Ae,H+=h*ze,F+=h*Oe,d+=h*Ge,R+=h*Ye,ae+=h*et,le+=h*tt,xe+=h*Xe,h=T[11],J+=h*qe,re+=h*Ie,me+=h*Le,oe+=h*Fe,be+=h*Be,fe+=h*Pe,ve+=h*$e,j+=h*Se,H+=h*Ae,F+=h*ze,d+=h*Oe,R+=h*Ge,ae+=h*Ye,le+=h*et,xe+=h*tt,je+=h*Xe,h=T[12],re+=h*qe,me+=h*Ie,oe+=h*Le,be+=h*Fe,fe+=h*Be,ve+=h*Pe,j+=h*$e,H+=h*Se,F+=h*Ae,d+=h*ze,R+=h*Oe,ae+=h*Ge,le+=h*Ye,xe+=h*et,je+=h*tt,We+=h*Xe,h=T[13],me+=h*qe,oe+=h*Ie,be+=h*Le,fe+=h*Fe,ve+=h*Be,j+=h*Pe,H+=h*$e,F+=h*Se,d+=h*Ae,R+=h*ze,ae+=h*Oe,le+=h*Ge,xe+=h*Ye,je+=h*et,We+=h*tt,Ue+=h*Xe,h=T[14],oe+=h*qe,be+=h*Ie,fe+=h*Le,ve+=h*Fe,j+=h*Be,H+=h*Pe,F+=h*$e,d+=h*Se,R+=h*Ae,ae+=h*ze,le+=h*Oe,xe+=h*Ge,je+=h*Ye,We+=h*et,Ue+=h*tt,yt+=h*Xe,h=T[15],be+=h*qe,fe+=h*Ie,ve+=h*Le,j+=h*Fe,H+=h*Be,F+=h*Pe,d+=h*$e,R+=h*Se,ae+=h*Ae,le+=h*ze,xe+=h*Oe,je+=h*Ge,We+=h*Ye,Ue+=h*et,yt+=h*tt,_t+=h*Xe,V+=38*fe,Y+=38*ve,se+=38*j,ue+=38*H,de+=38*F,b+=38*d,C+=38*R,ee+=38*ae,X+=38*le,W+=38*xe,G+=38*je,J+=38*We,re+=38*Ue,me+=38*yt,oe+=38*_t,m=1,h=V+m+65535,m=Math.floor(h/65536),V=h-m*65536,h=Y+m+65535,m=Math.floor(h/65536),Y=h-m*65536,h=se+m+65535,m=Math.floor(h/65536),se=h-m*65536,h=ue+m+65535,m=Math.floor(h/65536),ue=h-m*65536,h=de+m+65535,m=Math.floor(h/65536),de=h-m*65536,h=b+m+65535,m=Math.floor(h/65536),b=h-m*65536,h=C+m+65535,m=Math.floor(h/65536),C=h-m*65536,h=ee+m+65535,m=Math.floor(h/65536),ee=h-m*65536,h=X+m+65535,m=Math.floor(h/65536),X=h-m*65536,h=W+m+65535,m=Math.floor(h/65536),W=h-m*65536,h=G+m+65535,m=Math.floor(h/65536),G=h-m*65536,h=J+m+65535,m=Math.floor(h/65536),J=h-m*65536,h=re+m+65535,m=Math.floor(h/65536),re=h-m*65536,h=me+m+65535,m=Math.floor(h/65536),me=h-m*65536,h=oe+m+65535,m=Math.floor(h/65536),oe=h-m*65536,h=be+m+65535,m=Math.floor(h/65536),be=h-m*65536,V+=m-1+37*(m-1),m=1,h=V+m+65535,m=Math.floor(h/65536),V=h-m*65536,h=Y+m+65535,m=Math.floor(h/65536),Y=h-m*65536,h=se+m+65535,m=Math.floor(h/65536),se=h-m*65536,h=ue+m+65535,m=Math.floor(h/65536),ue=h-m*65536,h=de+m+65535,m=Math.floor(h/65536),de=h-m*65536,h=b+m+65535,m=Math.floor(h/65536),b=h-m*65536,h=C+m+65535,m=Math.floor(h/65536),C=h-m*65536,h=ee+m+65535,m=Math.floor(h/65536),ee=h-m*65536,h=X+m+65535,m=Math.floor(h/65536),X=h-m*65536,h=W+m+65535,m=Math.floor(h/65536),W=h-m*65536,h=G+m+65535,m=Math.floor(h/65536),G=h-m*65536,h=J+m+65535,m=Math.floor(h/65536),J=h-m*65536,h=re+m+65535,m=Math.floor(h/65536),re=h-m*65536,h=me+m+65535,m=Math.floor(h/65536),me=h-m*65536,h=oe+m+65535,m=Math.floor(h/65536),oe=h-m*65536,h=be+m+65535,m=Math.floor(h/65536),be=h-m*65536,V+=m-1+37*(m-1),A[0]=V,A[1]=Y,A[2]=se,A[3]=ue,A[4]=de,A[5]=b,A[6]=C,A[7]=ee,A[8]=X,A[9]=W,A[10]=G,A[11]=J,A[12]=re,A[13]=me,A[14]=oe,A[15]=be}function P(A,T){S(A,T,T)}function I(A,T){const E=s();for(let h=0;h<16;h++)E[h]=T[h];for(let h=253;h>=0;h--)P(E,E),h!==2&&h!==4&&S(E,E,T);for(let h=0;h<16;h++)A[h]=E[h]}function B(A,T){const E=new Uint8Array(32),h=new Float64Array(80),m=s(),V=s(),Y=s(),se=s(),ue=s(),de=s();for(let X=0;X<31;X++)E[X]=A[X];E[31]=A[31]&127|64,E[0]&=248,p(h,T);for(let X=0;X<16;X++)V[X]=h[X];m[0]=se[0]=1;for(let X=254;X>=0;--X){const W=E[X>>>3]>>>(X&7)&1;l(m,V,W),l(Y,se,W),_(ue,m,Y),D(m,m,Y),_(Y,V,se),D(V,V,se),P(se,ue),P(de,m),S(m,Y,m),S(Y,V,ue),_(ue,m,Y),D(m,m,Y),P(V,m),D(Y,se,de),S(m,Y,c),_(m,m,se),S(Y,Y,m),S(m,se,de),S(se,V,h),P(V,ue),l(m,V,W),l(Y,se,W)}for(let X=0;X<16;X++)h[X+16]=m[X],h[X+32]=Y[X],h[X+48]=V[X],h[X+64]=se[X];const b=h.subarray(32),C=h.subarray(16);I(b,b),S(C,C,b);const ee=new Uint8Array(32);return y(ee,C),ee}r.scalarMult=B;function z(A){return B(A,o)}r.scalarMultBase=z;function ne(A){if(A.length!==r.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${r.SECRET_KEY_LENGTH} bytes`);const T=new Uint8Array(A);return{publicKey:z(T),secretKey:T}}r.generateKeyPairFromSeed=ne;function L(A){const T=(0,e.randomBytes)(32,A),E=ne(T);return(0,t.wipe)(T),E}r.generateKeyPair=L;function M(A,T,E=!1){if(A.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(T.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const h=B(A,T);if(E){let m=0;for(let V=0;V<h.length;V++)m|=h[V];if(m===0)throw new Error("X25519: invalid shared key")}return h}r.sharedKey=M})(Qa);var Ff=function(r,e,t){if(t||arguments.length===2)for(var s=0,o=e.length,c;s<o;s++)(c||!(s in e))&&(c||(c=Array.prototype.slice.call(e,0,s)),c[s]=e[s]);return r.concat(c||Array.prototype.slice.call(e))},v1=function(){function r(e,t,s){this.name=e,this.version=t,this.os=s,this.type="browser"}return r}(),w1=function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r}(),m1=function(){function r(e,t,s,o){this.name=e,this.version=t,this.os=s,this.bot=o,this.type="bot-device"}return r}(),b1=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),E1=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),D1=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,S1=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,$f=3,x1=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",D1]],Uf=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function I1(r){return r?Mf(r):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new E1:typeof navigator<"u"?Mf(navigator.userAgent):A1()}function O1(r){return r!==""&&x1.reduce(function(e,t){var s=t[0],o=t[1];if(e)return e;var c=o.exec(r);return!!c&&[s,c]},!1)}function Mf(r){var e=O1(r);if(!e)return null;var t=e[0],s=e[1];if(t==="searchbot")return new b1;var o=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);o?o.length<$f&&(o=Ff(Ff([],o,!0),C1($f-o.length),!0)):o=[];var c=o.join("."),u=P1(r),l=S1.exec(r);return l&&l[1]?new m1(t,c,u,l[1]):new v1(t,c,u)}function P1(r){for(var e=0,t=Uf.length;e<t;e++){var s=Uf[e],o=s[0],c=s[1],u=c.exec(r);if(u)return o}return null}function A1(){var r=typeof process<"u"&&process.version;return r?new w1(process.version.slice(1)):null}function C1(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var ft={};Object.defineProperty(ft,"__esModule",{value:!0}),ft.getLocalStorage=ft.getLocalStorageOrThrow=ft.getCrypto=ft.getCryptoOrThrow=qf=ft.getLocation=ft.getLocationOrThrow=ec=ft.getNavigator=ft.getNavigatorOrThrow=Za=ft.getDocument=ft.getDocumentOrThrow=ft.getFromWindowOrThrow=ft.getFromWindow=void 0;function Qn(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}ft.getFromWindow=Qn;function bi(r){const e=Qn(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}ft.getFromWindowOrThrow=bi;function T1(){return bi("document")}ft.getDocumentOrThrow=T1;function R1(){return Qn("document")}var Za=ft.getDocument=R1;function N1(){return bi("navigator")}ft.getNavigatorOrThrow=N1;function L1(){return Qn("navigator")}var ec=ft.getNavigator=L1;function F1(){return bi("location")}ft.getLocationOrThrow=F1;function $1(){return Qn("location")}var qf=ft.getLocation=$1;function U1(){return bi("crypto")}ft.getCryptoOrThrow=U1;function M1(){return Qn("crypto")}ft.getCrypto=M1;function q1(){return bi("localStorage")}ft.getLocalStorageOrThrow=q1;function B1(){return Qn("localStorage")}ft.getLocalStorage=B1;var tc={};Object.defineProperty(tc,"__esModule",{value:!0});var Bf=tc.getWindowMetadata=void 0;const Hf=ft;function H1(){let r,e;try{r=Hf.getDocumentOrThrow(),e=Hf.getLocationOrThrow()}catch{return null}function t(){const D=r.getElementsByTagName("link"),S=[];for(let P=0;P<D.length;P++){const I=D[P],B=I.getAttribute("rel");if(B&&B.toLowerCase().indexOf("icon")>-1){const z=I.getAttribute("href");if(z)if(z.toLowerCase().indexOf("https:")===-1&&z.toLowerCase().indexOf("http:")===-1&&z.indexOf("//")!==0){let ne=e.protocol+"//"+e.host;if(z.indexOf("/")===0)ne+=z;else{const L=e.pathname.split("/");L.pop();const M=L.join("/");ne+=M+"/"+z}S.push(ne)}else if(z.indexOf("//")===0){const ne=e.protocol+z;S.push(ne)}else S.push(z)}}return S}function s(...D){const S=r.getElementsByTagName("meta");for(let P=0;P<S.length;P++){const I=S[P],B=["itemprop","property","name"].map(z=>I.getAttribute(z)).filter(z=>z?D.includes(z):!1);if(B.length&&B){const z=I.getAttribute("content");if(z)return z}}return""}function o(){let D=s("name","og:site_name","og:title","twitter:title");return D||(D=r.title),D}function c(){return s("description","og:description","twitter:description","keywords")}const u=o(),l=c(),y=e.origin,p=t();return{description:l,url:y,icons:p,name:u}}Bf=tc.getWindowMetadata=H1;var as={},j1=r=>encodeURIComponent(r).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),jf="%[a-f0-9]{2}",zf=new RegExp("("+jf+")|([^%]+?)","gi"),Kf=new RegExp("("+jf+")+","gi");function rc(r,e){try{return[decodeURIComponent(r.join(""))]}catch{}if(r.length===1)return r;e=e||1;var t=r.slice(0,e),s=r.slice(e);return Array.prototype.concat.call([],rc(t),rc(s))}function z1(r){try{return decodeURIComponent(r)}catch{for(var e=r.match(zf)||[],t=1;t<e.length;t++)r=rc(e,t).join(""),e=r.match(zf)||[];return r}}function K1(r){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},t=Kf.exec(r);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var s=z1(t[0]);s!==t[0]&&(e[t[0]]=s)}t=Kf.exec(r)}e["%C2"]="\uFFFD";for(var o=Object.keys(e),c=0;c<o.length;c++){var u=o[c];r=r.replace(new RegExp(u,"g"),e[u])}return r}var W1=function(r){if(typeof r!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof r+"`");try{return r=r.replace(/\+/g," "),decodeURIComponent(r)}catch{return K1(r)}},G1=(r,e)=>{if(!(typeof r=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[r];const t=r.indexOf(e);return t===-1?[r]:[r.slice(0,t),r.slice(t+e.length)]},V1=function(r,e){for(var t={},s=Object.keys(r),o=Array.isArray(e),c=0;c<s.length;c++){var u=s[c],l=r[u];(o?e.indexOf(u)!==-1:e(u,l,r))&&(t[u]=l)}return t};(function(r){const e=j1,t=W1,s=G1,o=V1,c=L=>L==null,u=Symbol("encodeFragmentIdentifier");function l(L){switch(L.arrayFormat){case"index":return M=>(A,T)=>{const E=A.length;return T===void 0||L.skipNull&&T===null||L.skipEmptyString&&T===""?A:T===null?[...A,[_(M,L),"[",E,"]"].join("")]:[...A,[_(M,L),"[",_(E,L),"]=",_(T,L)].join("")]};case"bracket":return M=>(A,T)=>T===void 0||L.skipNull&&T===null||L.skipEmptyString&&T===""?A:T===null?[...A,[_(M,L),"[]"].join("")]:[...A,[_(M,L),"[]=",_(T,L)].join("")];case"colon-list-separator":return M=>(A,T)=>T===void 0||L.skipNull&&T===null||L.skipEmptyString&&T===""?A:T===null?[...A,[_(M,L),":list="].join("")]:[...A,[_(M,L),":list=",_(T,L)].join("")];case"comma":case"separator":case"bracket-separator":{const M=L.arrayFormat==="bracket-separator"?"[]=":"=";return A=>(T,E)=>E===void 0||L.skipNull&&E===null||L.skipEmptyString&&E===""?T:(E=E===null?"":E,T.length===0?[[_(A,L),M,_(E,L)].join("")]:[[T,_(E,L)].join(L.arrayFormatSeparator)])}default:return M=>(A,T)=>T===void 0||L.skipNull&&T===null||L.skipEmptyString&&T===""?A:T===null?[...A,_(M,L)]:[...A,[_(M,L),"=",_(T,L)].join("")]}}function y(L){let M;switch(L.arrayFormat){case"index":return(A,T,E)=>{if(M=/\[(\d*)\]$/.exec(A),A=A.replace(/\[\d*\]$/,""),!M){E[A]=T;return}E[A]===void 0&&(E[A]={}),E[A][M[1]]=T};case"bracket":return(A,T,E)=>{if(M=/(\[\])$/.exec(A),A=A.replace(/\[\]$/,""),!M){E[A]=T;return}if(E[A]===void 0){E[A]=[T];return}E[A]=[].concat(E[A],T)};case"colon-list-separator":return(A,T,E)=>{if(M=/(:list)$/.exec(A),A=A.replace(/:list$/,""),!M){E[A]=T;return}if(E[A]===void 0){E[A]=[T];return}E[A]=[].concat(E[A],T)};case"comma":case"separator":return(A,T,E)=>{const h=typeof T=="string"&&T.includes(L.arrayFormatSeparator),m=typeof T=="string"&&!h&&D(T,L).includes(L.arrayFormatSeparator);T=m?D(T,L):T;const V=h||m?T.split(L.arrayFormatSeparator).map(Y=>D(Y,L)):T===null?T:D(T,L);E[A]=V};case"bracket-separator":return(A,T,E)=>{const h=/(\[\])$/.test(A);if(A=A.replace(/\[\]$/,""),!h){E[A]=T&&D(T,L);return}const m=T===null?[]:T.split(L.arrayFormatSeparator).map(V=>D(V,L));if(E[A]===void 0){E[A]=m;return}E[A]=[].concat(E[A],m)};default:return(A,T,E)=>{if(E[A]===void 0){E[A]=T;return}E[A]=[].concat(E[A],T)}}}function p(L){if(typeof L!="string"||L.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function _(L,M){return M.encode?M.strict?e(L):encodeURIComponent(L):L}function D(L,M){return M.decode?t(L):L}function S(L){return Array.isArray(L)?L.sort():typeof L=="object"?S(Object.keys(L)).sort((M,A)=>Number(M)-Number(A)).map(M=>L[M]):L}function P(L){const M=L.indexOf("#");return M!==-1&&(L=L.slice(0,M)),L}function I(L){let M="";const A=L.indexOf("#");return A!==-1&&(M=L.slice(A)),M}function B(L){L=P(L);const M=L.indexOf("?");return M===-1?"":L.slice(M+1)}function z(L,M){return M.parseNumbers&&!Number.isNaN(Number(L))&&typeof L=="string"&&L.trim()!==""?L=Number(L):M.parseBooleans&&L!==null&&(L.toLowerCase()==="true"||L.toLowerCase()==="false")&&(L=L.toLowerCase()==="true"),L}function ne(L,M){M=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},M),p(M.arrayFormatSeparator);const A=y(M),T=Object.create(null);if(typeof L!="string"||(L=L.trim().replace(/^[?#&]/,""),!L))return T;for(const E of L.split("&")){if(E==="")continue;let[h,m]=s(M.decode?E.replace(/\+/g," "):E,"=");m=m===void 0?null:["comma","separator","bracket-separator"].includes(M.arrayFormat)?m:D(m,M),A(D(h,M),m,T)}for(const E of Object.keys(T)){const h=T[E];if(typeof h=="object"&&h!==null)for(const m of Object.keys(h))h[m]=z(h[m],M);else T[E]=z(h,M)}return M.sort===!1?T:(M.sort===!0?Object.keys(T).sort():Object.keys(T).sort(M.sort)).reduce((E,h)=>{const m=T[h];return m&&typeof m=="object"&&!Array.isArray(m)?E[h]=S(m):E[h]=m,E},Object.create(null))}r.extract=B,r.parse=ne,r.stringify=(L,M)=>{if(!L)return"";M=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},M),p(M.arrayFormatSeparator);const A=m=>M.skipNull&&c(L[m])||M.skipEmptyString&&L[m]==="",T=l(M),E={};for(const m of Object.keys(L))A(m)||(E[m]=L[m]);const h=Object.keys(E);return M.sort!==!1&&h.sort(M.sort),h.map(m=>{const V=L[m];return V===void 0?"":V===null?_(m,M):Array.isArray(V)?V.length===0&&M.arrayFormat==="bracket-separator"?_(m,M)+"[]":V.reduce(T(m),[]).join("&"):_(m,M)+"="+_(V,M)}).filter(m=>m.length>0).join("&")},r.parseUrl=(L,M)=>{M=Object.assign({decode:!0},M);const[A,T]=s(L,"#");return Object.assign({url:A.split("?")[0]||"",query:ne(B(L),M)},M&&M.parseFragmentIdentifier&&T?{fragmentIdentifier:D(T,M)}:{})},r.stringifyUrl=(L,M)=>{M=Object.assign({encode:!0,strict:!0,[u]:!0},M);const A=P(L.url).split("?")[0]||"",T=r.extract(L.url),E=r.parse(T,{sort:!1}),h=Object.assign(E,L.query);let m=r.stringify(h,M);m&&(m=`?${m}`);let V=I(L.url);return L.fragmentIdentifier&&(V=`#${M[u]?_(L.fragmentIdentifier,M):L.fragmentIdentifier}`),`${A}${m}${V}`},r.pick=(L,M,A)=>{A=Object.assign({parseFragmentIdentifier:!0,[u]:!1},A);const{url:T,query:E,fragmentIdentifier:h}=r.parseUrl(L,A);return r.stringifyUrl({url:T,query:o(E,M),fragmentIdentifier:h},A)},r.exclude=(L,M,A)=>{const T=Array.isArray(M)?E=>!M.includes(E):(E,h)=>!M(E,h);return r.pick(L,T,A)}})(as);const k1={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},Y1=":";function J1(r){const[e,t]=r.split(Y1);return{namespace:e,reference:t}}function Wf(r,e){return r.includes(":")?[r]:e.chains||[]}const Gf="base10",or="base16",nc="base64pad",ic="utf8",Vf=0,Zn=1,X1=0,kf=1,sc=12,oc=32;function Q1(){const r=Qa.generateKeyPair();return{privateKey:sr(r.secretKey,or),publicKey:sr(r.publicKey,or)}}function ac(){const r=mi.randomBytes(oc);return sr(r,or)}function Z1(r,e){const t=Qa.sharedKey(_r(r,or),_r(e,or),!0),s=new _1(eo.SHA256,t).expand(oc);return sr(s,or)}function ew(r){const e=eo.hash(_r(r,or));return sr(e,or)}function Ei(r){const e=eo.hash(_r(r,ic));return sr(e,or)}function tw(r){return _r(`${r}`,Gf)}function cs(r){return Number(sr(r,Gf))}function rw(r){const e=tw(typeof r.type<"u"?r.type:Vf);if(cs(e)===Zn&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?_r(r.senderPublicKey,or):void 0,s=typeof r.iv<"u"?_r(r.iv,or):mi.randomBytes(sc),o=new Ya.ChaCha20Poly1305(_r(r.symKey,or)).seal(s,_r(r.message,ic));return iw({type:e,sealed:o,iv:s,senderPublicKey:t})}function nw(r){const e=new Ya.ChaCha20Poly1305(_r(r.symKey,or)),{sealed:t,iv:s}=to(r.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return sr(o,ic)}function iw(r){if(cs(r.type)===Zn){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return sr(Wa([r.type,r.senderPublicKey,r.iv,r.sealed]),nc)}return sr(Wa([r.type,r.iv,r.sealed]),nc)}function to(r){const e=_r(r,nc),t=e.slice(X1,kf),s=kf;if(cs(t)===Zn){const l=s+oc,y=l+sc,p=e.slice(s,l),_=e.slice(l,y),D=e.slice(y);return{type:t,sealed:D,iv:_,senderPublicKey:p}}const o=s+sc,c=e.slice(s,o),u=e.slice(o);return{type:t,sealed:u,iv:c}}function sw(r,e){const t=to(r);return Yf({type:cs(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?sr(t.senderPublicKey,or):void 0,receiverPublicKey:e?.receiverPublicKey})}function Yf(r){const e=r?.type||Vf;if(e===Zn){if(typeof r?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof r?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r?.senderPublicKey,receiverPublicKey:r?.receiverPublicKey}}function Jf(r){return r.type===Zn&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}var ow=Object.defineProperty,Xf=Object.getOwnPropertySymbols,aw=Object.prototype.hasOwnProperty,cw=Object.prototype.propertyIsEnumerable,Qf=(r,e,t)=>e in r?ow(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Zf=(r,e)=>{for(var t in e||(e={}))aw.call(e,t)&&Qf(r,t,e[t]);if(Xf)for(var t of Xf(e))cw.call(e,t)&&Qf(r,t,e[t]);return r};const uw="ReactNative",Ir={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},hw="js";function cc(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Di(){return!Za()&&!!ec()&&navigator.product===uw}function Si(){return!cc()&&!!ec()&&!!Za()}function us(){return Di()?Ir.reactNative:cc()?Ir.node:Si()?Ir.browser:Ir.unknown}function fw(){var r;try{return Di()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(r=global.Application)==null?void 0:r.applicationId:void 0}catch{return}}function lw(r,e){let t=as.parse(r);return t=Zf(Zf({},t),e),r=as.stringify(t),r}function dw(){return Bf()||{name:"",description:"",url:"",icons:[""]}}function pw(){if(us()===Ir.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:s}=global.Platform;return[t,s].join("-")}const r=I1();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function gw(){var r;const e=us();return e===Ir.browser?[e,((r=qf())==null?void 0:r.host)||"unknown"].join(":"):e}function yw(r,e,t){const s=pw(),o=gw();return[[r,e].join("-"),[hw,t].join("-"),s,o].join("/")}function _w({protocol:r,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:u,bundleId:l}){const y=t.split("?"),p=yw(r,e,s),_={auth:o,ua:p,projectId:c,useOnCloseEvent:u||void 0,origin:l||void 0},D=lw(y[1]||"",_);return y[0]+"?"+D}function ei(r,e){return r.filter(t=>e.includes(t)).length===r.length}function el(r){return Object.fromEntries(r.entries())}function tl(r){return new Map(Object.entries(r))}function xi(r=_e.FIVE_MINUTES,e){const t=_e.toMiliseconds(r||_e.FIVE_MINUTES);let s,o,c;return{resolve:u=>{c&&s&&(clearTimeout(c),s(u))},reject:u=>{c&&o&&(clearTimeout(c),o(u))},done:()=>new Promise((u,l)=>{c=setTimeout(()=>{l(new Error(e))},t),s=u,o=l})}}function hs(r,e,t){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(t)),e);try{const u=await r;s(u)}catch(u){o(u)}clearTimeout(c)})}function rl(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function vw(r){return rl("topic",r)}function ww(r){return rl("id",r)}function nl(r){const[e,t]=r.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function Or(r,e){return _e.fromMiliseconds((e||Date.now())+_e.toMiliseconds(r))}function Pn(r){return Date.now()>=_e.toMiliseconds(r)}function Tt(r,e){return`${r}${e?`:${e}`:""}`}function uc(r=[],e=[]){return[...new Set([...r,...e])]}async function mw({id:r,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s?.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${r}&sessionTopic=${e}`,u=us();u===Ir.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):u===Ir.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch(s){console.error(s)}}async function bw(r,e){try{return await r.getItem(e)||(Si()?localStorage.getItem(e):void 0)}catch(t){console.error(t)}}const Ew="irn";function hc(r){return r?.relay||{protocol:Ew}}function ro(r){const e=k1[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}var Dw=Object.defineProperty,Sw=Object.defineProperties,xw=Object.getOwnPropertyDescriptors,il=Object.getOwnPropertySymbols,Iw=Object.prototype.hasOwnProperty,Ow=Object.prototype.propertyIsEnumerable,sl=(r,e,t)=>e in r?Dw(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Pw=(r,e)=>{for(var t in e||(e={}))Iw.call(e,t)&&sl(r,t,e[t]);if(il)for(var t of il(e))Ow.call(e,t)&&sl(r,t,e[t]);return r},Aw=(r,e)=>Sw(r,xw(e));function Cw(r,e="-"){const t={},s="relay"+e;return Object.keys(r).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),u=r[o];t[c]=u}}),t}function ol(r){r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,s=r.substring(0,e),o=r.substring(e+1,t).split("@"),c=typeof t<"u"?r.substring(t):"",u=as.parse(c);return{protocol:s,topic:Tw(o[0]),version:parseInt(o[1],10),symKey:u.symKey,relay:Cw(u),expiryTimestamp:u.expiryTimestamp?parseInt(u.expiryTimestamp,10):void 0}}function Tw(r){return r.startsWith("//")?r.substring(2):r}function Rw(r,e="-"){const t="relay",s={};return Object.keys(r).forEach(o=>{const c=t+e+o;r[o]&&(s[c]=r[o])}),s}function Nw(r){return`${r.protocol}:${r.topic}@${r.version}?`+as.stringify(Aw(Pw({symKey:r.symKey},Rw(r.relay)),{expiryTimestamp:r.expiryTimestamp}))}function Ii(r){const e=[];return r.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function Lw(r){const e=[];return Object.values(r).forEach(t=>{e.push(...Ii(t.accounts))}),e}function Fw(r,e){const t=[];return Object.values(r).forEach(s=>{Ii(s.accounts).includes(e)&&t.push(...s.methods)}),t}function $w(r,e){const t=[];return Object.values(r).forEach(s=>{Ii(s.accounts).includes(e)&&t.push(...s.events)}),t}function fc(r){return r.includes(":")}function fs(r){return fc(r)?r.split(":")[0]:r}const Uw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Mw={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ce(r,e){const{message:t,code:s}=Mw[r];return{message:e?`${t} ${e}`:t,code:s}}function bt(r,e){const{message:t,code:s}=Uw[r];return{message:e?`${t} ${e}`:t,code:s}}function ti(r,e){return Array.isArray(r)?typeof e<"u"&&r.length?r.every(e):!0:!1}function ls(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function ar(r){return typeof r>"u"}function Vt(r,e){return e&&ar(r)?!0:typeof r=="string"&&!!r.trim().length}function lc(r,e){return e&&ar(r)?!0:typeof r=="number"&&!isNaN(r)}function qw(r,e){const{requiredNamespaces:t}=e,s=Object.keys(r.namespaces),o=Object.keys(t);let c=!0;return ei(o,s)?(s.forEach(u=>{const{accounts:l,methods:y,events:p}=r.namespaces[u],_=Ii(l),D=t[u];(!ei(Wf(u,D),_)||!ei(D.methods,y)||!ei(D.events,p))&&(c=!1)}),c):!1}function no(r){return Vt(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function Bw(r){if(Vt(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&no(t)}}return!1}function Hw(r){if(Vt(r,!1))try{return typeof new URL(r)<"u"}catch{return!1}return!1}function jw(r){var e;return(e=r?.proposer)==null?void 0:e.publicKey}function zw(r){return r?.topic}function Kw(r,e){let t=null;return Vt(r?.publicKey,!1)||(t=ce("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function al(r){let e=!0;return ti(r)?r.length&&(e=r.every(t=>Vt(t,!1))):e=!1,e}function Ww(r,e,t){let s=null;return ti(e)&&e.length?e.forEach(o=>{s||no(o)||(s=bt("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):no(r)||(s=bt("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function Gw(r,e,t){let s=null;return Object.entries(r).forEach(([o,c])=>{if(s)return;const u=Ww(o,Wf(o,c),`${e} ${t}`);u&&(s=u)}),s}function Vw(r,e){let t=null;return ti(r)?r.forEach(s=>{t||Bw(s)||(t=bt("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=bt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function kw(r,e){let t=null;return Object.values(r).forEach(s=>{if(t)return;const o=Vw(s?.accounts,`${e} namespace`);o&&(t=o)}),t}function Yw(r,e){let t=null;return al(r?.methods)?al(r?.events)||(t=bt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=bt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function cl(r,e){let t=null;return Object.values(r).forEach(s=>{if(t)return;const o=Yw(s,`${e}, namespace`);o&&(t=o)}),t}function Jw(r,e,t){let s=null;if(r&&ls(r)){const o=cl(r,e);o&&(s=o);const c=Gw(r,e,t);c&&(s=c)}else s=ce("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function dc(r,e){let t=null;if(r&&ls(r)){const s=cl(r,e);s&&(t=s);const o=kw(r,e);o&&(t=o)}else t=ce("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function ul(r){return Vt(r.protocol,!0)}function Xw(r,e){let t=!1;return e&&!r?t=!0:r&&ti(r)&&r.length&&r.forEach(s=>{t=ul(s)}),t}function Qw(r){return typeof r=="number"}function vr(r){return typeof r<"u"&&typeof r!==null}function Zw(r){return!(!r||typeof r!="object"||!r.code||!lc(r.code,!1)||!r.message||!Vt(r.message,!1))}function em(r){return!(ar(r)||!Vt(r.method,!1))}function tm(r){return!(ar(r)||ar(r.result)&&ar(r.error)||!lc(r.id,!1)||!Vt(r.jsonrpc,!1))}function rm(r){return!(ar(r)||!Vt(r.name,!1))}function hl(r,e){return!(!no(e)||!Lw(r).includes(e))}function nm(r,e,t){return Vt(t,!1)?Fw(r,e).includes(t):!1}function im(r,e,t){return Vt(t,!1)?$w(r,e).includes(t):!1}function fl(r,e,t){let s=null;const o=sm(r),c=om(e),u=Object.keys(o),l=Object.keys(c),y=ll(Object.keys(r)),p=ll(Object.keys(e)),_=y.filter(D=>!p.includes(D));return _.length&&(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${_.toString()}
      Received: ${Object.keys(e).toString()}`)),ei(u,l)||(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${u.toString()}
      Approved: ${l.toString()}`)),Object.keys(e).forEach(D=>{if(!D.includes(":")||s)return;const S=Ii(e[D].accounts);S.includes(D)||(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${D}
        Required: ${D}
        Approved: ${S.toString()}`))}),u.forEach(D=>{s||(ei(o[D].methods,c[D].methods)?ei(o[D].events,c[D].events)||(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${D}`)):s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${D}`))}),s}function sm(r){const e={};return Object.keys(r).forEach(t=>{var s;t.includes(":")?e[t]=r[t]:(s=r[t].chains)==null||s.forEach(o=>{e[o]={methods:r[t].methods,events:r[t].events}})}),e}function ll(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function om(r){const e={};return Object.keys(r).forEach(t=>{if(t.includes(":"))e[t]=r[t];else{const s=Ii(r[t].accounts);s?.forEach(o=>{e[o]={accounts:r[t].accounts.filter(c=>c.includes(`${o}:`)),methods:r[t].methods,events:r[t].events}})}}),e}function am(r,e){return lc(r,!1)&&r<=e.max&&r>=e.min}function dl(){const r=us();return new Promise(e=>{switch(r){case Ir.browser:e(cm());break;case Ir.reactNative:e(um());break;case Ir.node:e(hm());break;default:e(!0)}})}function cm(){return Si()&&navigator?.onLine}async function um(){if(Di()&&typeof global<"u"&&global!=null&&global.NetInfo){const r=await(global==null?void 0:global.NetInfo.fetch());return r?.isConnected}return!0}function hm(){return!0}function fm(r){switch(us()){case Ir.browser:lm(r);break;case Ir.reactNative:dm(r);break}}function lm(r){!Di()&&Si()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function dm(r){Di()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>r(e?.isConnected))}const pc={};class io{static get(e){return pc[e]}static set(e,t){pc[e]=t}static delete(e){delete pc[e]}}const pm="PARSE_ERROR",gm="INVALID_REQUEST",ym="METHOD_NOT_FOUND",_m="INVALID_PARAMS",pl="INTERNAL_ERROR",gc="SERVER_ERROR",vm=[-32700,-32600,-32601,-32602,-32603],ds={[pm]:{code:-32700,message:"Parse error"},[gm]:{code:-32600,message:"Invalid Request"},[ym]:{code:-32601,message:"Method not found"},[_m]:{code:-32602,message:"Invalid params"},[pl]:{code:-32603,message:"Internal error"},[gc]:{code:-32e3,message:"Server error"}},gl=gc;function wm(r){return vm.includes(r)}function yl(r){return Object.keys(ds).includes(r)?ds[r]:ds[gl]}function mm(r){const e=Object.values(ds).find(t=>t.code===r);return e||ds[gl]}function _l(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}var vl={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var yc=function(r,e){return yc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},yc(r,e)};function bm(r,e){yc(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var _c=function(){return _c=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},_c.apply(this,arguments)};function Em(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(r);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(r,s[o])&&(t[s[o]]=r[s[o]]);return t}function Dm(r,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(r,e,t,s);else for(var l=r.length-1;l>=0;l--)(u=r[l])&&(c=(o<3?u(c):o>3?u(e,t,c):u(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function Sm(r,e){return function(t,s){e(t,s,r)}}function xm(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function Im(r,e,t,s){function o(c){return c instanceof t?c:new t(function(u){u(c)})}return new(t||(t=Promise))(function(c,u){function l(_){try{p(s.next(_))}catch(D){u(D)}}function y(_){try{p(s.throw(_))}catch(D){u(D)}}function p(_){_.done?c(_.value):o(_.value).then(l,y)}p((s=s.apply(r,e||[])).next())})}function Om(r,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,u;return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(p){return function(_){return y([p,_])}}function y(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(r,t)}catch(_){p=[6,_],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Pm(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}function Am(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function vc(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],s=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&s>=r.length&&(r=void 0),{value:r&&r[s++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function wl(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var s=t.call(r),o,c=[],u;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(l){u={error:l}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(u)throw u.error}}return c}function Cm(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(wl(arguments[e]));return r}function Tm(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var s=Array(r),o=0,e=0;e<t;e++)for(var c=arguments[e],u=0,l=c.length;u<l;u++,o++)s[o]=c[u];return s}function ps(r){return this instanceof ps?(this.v=r,this):new ps(r)}function Rm(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(r,e||[]),o,c=[];return o={},u("next"),u("throw"),u("return"),o[Symbol.asyncIterator]=function(){return this},o;function u(S){s[S]&&(o[S]=function(P){return new Promise(function(I,B){c.push([S,P,I,B])>1||l(S,P)})})}function l(S,P){try{y(s[S](P))}catch(I){D(c[0][3],I)}}function y(S){S.value instanceof ps?Promise.resolve(S.value.v).then(p,_):D(c[0][2],S)}function p(S){l("next",S)}function _(S){l("throw",S)}function D(S,P){S(P),c.shift(),c.length&&l(c[0][0],c[0][1])}}function Nm(r){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=r[o]?function(u){return(t=!t)?{value:ps(r[o](u)),done:o==="return"}:c?c(u):u}:c}}function Lm(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof vc=="function"?vc(r):r[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=r[c]&&function(u){return new Promise(function(l,y){u=r[c](u),o(l,y,u.done,u.value)})}}function o(c,u,l,y){Promise.resolve(y).then(function(p){c({value:p,done:l})},u)}}function Fm(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function $m(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function Um(r){return r&&r.__esModule?r:{default:r}}function Mm(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function qm(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}var Bm=Object.freeze({__proto__:null,__extends:bm,get __assign(){return _c},__rest:Em,__decorate:Dm,__param:Sm,__metadata:xm,__awaiter:Im,__generator:Om,__createBinding:Pm,__exportStar:Am,__values:vc,__read:wl,__spread:Cm,__spreadArrays:Tm,__await:ps,__asyncGenerator:Rm,__asyncDelegator:Nm,__asyncValues:Lm,__makeTemplateObject:Fm,__importStar:$m,__importDefault:Um,__classPrivateFieldGet:Mm,__classPrivateFieldSet:qm}),Hm=Kn(Bm),an={},ml;function jm(){if(ml)return an;ml=1,Object.defineProperty(an,"__esModule",{value:!0}),an.isBrowserCryptoAvailable=an.getSubtleCrypto=an.getBrowerCrypto=void 0;function r(){return $t?.crypto||$t?.msCrypto||{}}an.getBrowerCrypto=r;function e(){const s=r();return s.subtle||s.webkitSubtle}an.getSubtleCrypto=e;function t(){return!!r()&&!!e()}return an.isBrowserCryptoAvailable=t,an}var cn={},bl;function zm(){if(bl)return cn;bl=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.isBrowser=cn.isNode=cn.isReactNative=void 0;function r(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}cn.isReactNative=r;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}cn.isNode=e;function t(){return!r()&&!e()}return cn.isBrowser=t,cn}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Hm;e.__exportStar(jm(),r),e.__exportStar(zm(),r)})(vl);function wc(r=3){const e=Date.now()*Math.pow(10,r),t=Math.floor(Math.random()*Math.pow(10,r));return e+t}function El(r=6){return BigInt(wc(r))}function Oi(r,e,t){return{id:t||wc(),jsonrpc:"2.0",method:r,params:e}}function so(r,e){return{id:r,jsonrpc:"2.0",result:e}}function oo(r,e,t){return{id:r,jsonrpc:"2.0",error:Km(e,t)}}function Km(r,e){return typeof r>"u"?yl(pl):(typeof r=="string"&&(r=Object.assign(Object.assign({},yl(gc)),{message:r})),typeof e<"u"&&(r.data=e),wm(r.code)&&(r=mm(r.code)),r)}class Wm{}class Gm extends Wm{constructor(){super()}}class Vm extends Gm{constructor(e){super()}}const km="^https?:",Ym="^wss?:";function Jm(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Dl(r,e){const t=Jm(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function Sl(r){return Dl(r,km)}function xl(r){return Dl(r,Ym)}function Xm(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function Il(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function mc(r){return Il(r)&&"method"in r}function ao(r){return Il(r)&&(un(r)||Kr(r))}function un(r){return"result"in r}function Kr(r){return"error"in r}class hn extends Vm{constructor(e){super(e),this.events=new Zt.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Oi(e.method,e.params||[],e.id||El().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{Kr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ao(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Qm=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Zm=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Ol=r=>r.split("?")[0],Pl=10,eb=Qm();class tb{constructor(e){if(this.url=e,this.events=new Zt.exports.EventEmitter,this.registering=!1,!xl(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Gn(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!xl(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=new URLSearchParams(e).get("origin"),c=vl.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!Xm(e)},u=new eb(e,[],c);Zm()?u.onerror=l=>{const y=l;s(this.emitError(y.error))}:u.on("error",l=>{s(this.emitError(l))}),u.onopen=()=>{this.onOpen(u),t(u)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Xi(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=oo(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return _l(e,Ol(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Pl&&this.events.setMaxListeners(Pl)}emitError(e){const t=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${Ol(this.url)}`));return this.events.emit("register_error",t),t}}var bc={exports:{}};(function(r,e){var t=200,s="__lodash_hash_undefined__",o=1,c=2,u=9007199254740991,l="[object Arguments]",y="[object Array]",p="[object AsyncFunction]",_="[object Boolean]",D="[object Date]",S="[object Error]",P="[object Function]",I="[object GeneratorFunction]",B="[object Map]",z="[object Number]",ne="[object Null]",L="[object Object]",M="[object Promise]",A="[object Proxy]",T="[object RegExp]",E="[object Set]",h="[object String]",m="[object Symbol]",V="[object Undefined]",Y="[object WeakMap]",se="[object ArrayBuffer]",ue="[object DataView]",de="[object Float32Array]",b="[object Float64Array]",C="[object Int8Array]",ee="[object Int16Array]",X="[object Int32Array]",W="[object Uint8Array]",G="[object Uint8ClampedArray]",J="[object Uint16Array]",re="[object Uint32Array]",me=/[\\^$.*+?()[\]{}|]/g,oe=/^\[object .+?Constructor\]$/,be=/^(?:0|[1-9]\d*)$/,fe={};fe[de]=fe[b]=fe[C]=fe[ee]=fe[X]=fe[W]=fe[G]=fe[J]=fe[re]=!0,fe[l]=fe[y]=fe[se]=fe[_]=fe[ue]=fe[D]=fe[S]=fe[P]=fe[B]=fe[z]=fe[L]=fe[T]=fe[E]=fe[h]=fe[Y]=!1;var ve=typeof $t=="object"&&$t&&$t.Object===Object&&$t,j=typeof self=="object"&&self&&self.Object===Object&&self,H=ve||j||Function("return this")(),F=e&&!e.nodeType&&e,d=F&&!0&&r&&!r.nodeType&&r,R=d&&d.exports===F,ae=R&&ve.process,le=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),xe=le&&le.isTypedArray;function je(x,U){for(var te=-1,pe=x==null?0:x.length,ct=0,Te=[];++te<pe;){var dt=x[te];U(dt,te,x)&&(Te[ct++]=dt)}return Te}function We(x,U){for(var te=-1,pe=U.length,ct=x.length;++te<pe;)x[ct+te]=U[te];return x}function Ue(x,U){for(var te=-1,pe=x==null?0:x.length;++te<pe;)if(U(x[te],te,x))return!0;return!1}function yt(x,U){for(var te=-1,pe=Array(x);++te<x;)pe[te]=U(te);return pe}function _t(x){return function(U){return x(U)}}function qe(x,U){return x.has(U)}function Ie(x,U){return x?.[U]}function Le(x){var U=-1,te=Array(x.size);return x.forEach(function(pe,ct){te[++U]=[ct,pe]}),te}function Fe(x,U){return function(te){return x(U(te))}}function Be(x){var U=-1,te=Array(x.size);return x.forEach(function(pe){te[++U]=pe}),te}var Pe=Array.prototype,$e=Function.prototype,Se=Object.prototype,Ae=H["__core-js_shared__"],ze=$e.toString,Oe=Se.hasOwnProperty,Ge=function(){var x=/[^.]+$/.exec(Ae&&Ae.keys&&Ae.keys.IE_PROTO||"");return x?"Symbol(src)_1."+x:""}(),Ye=Se.toString,et=RegExp("^"+ze.call(Oe).replace(me,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=R?H.Buffer:void 0,Xe=H.Symbol,hr=H.Uint8Array,wr=Se.propertyIsEnumerable,en=Pe.splice,fr=Xe?Xe.toStringTag:void 0,gn=Object.getOwnPropertySymbols,Rn=tt?tt.isBuffer:void 0,ni=Fe(Object.keys,Object),St=Pr(H,"DataView"),vt=Pr(H,"Map"),xt=Pr(H,"Promise"),It=Pr(H,"Set"),Et=Pr(H,"WeakMap"),wt=Pr(Object,"create"),Ut=_n(St),Mt=_n(vt),Ot=_n(xt),qt=_n(It),Pt=_n(Et),Rt=Xe?Xe.prototype:void 0,At=Rt?Rt.valueOf:void 0;function lt(x){var U=-1,te=x==null?0:x.length;for(this.clear();++U<te;){var pe=x[U];this.set(pe[0],pe[1])}}function Bt(){this.__data__=wt?wt(null):{},this.size=0}function Ht(x){var U=this.has(x)&&delete this.__data__[x];return this.size-=U?1:0,U}function qc(x){var U=this.__data__;if(wt){var te=U[x];return te===s?void 0:te}return Oe.call(U,x)?U[x]:void 0}function Bc(x){var U=this.__data__;return wt?U[x]!==void 0:Oe.call(U,x)}function Hc(x,U){var te=this.__data__;return this.size+=this.has(x)?0:1,te[x]=wt&&U===void 0?s:U,this}lt.prototype.clear=Bt,lt.prototype.delete=Ht,lt.prototype.get=qc,lt.prototype.has=Bc,lt.prototype.set=Hc;function Fr(x){var U=-1,te=x==null?0:x.length;for(this.clear();++U<te;){var pe=x[U];this.set(pe[0],pe[1])}}function jc(){this.__data__=[],this.size=0}function zc(x){var U=this.__data__,te=ii(U,x);if(te<0)return!1;var pe=U.length-1;return te==pe?U.pop():en.call(U,te,1),--this.size,!0}function Kc(x){var U=this.__data__,te=ii(U,x);return te<0?void 0:U[te][1]}function Wc(x){return ii(this.__data__,x)>-1}function Gc(x,U){var te=this.__data__,pe=ii(te,x);return pe<0?(++this.size,te.push([x,U])):te[pe][1]=U,this}Fr.prototype.clear=jc,Fr.prototype.delete=zc,Fr.prototype.get=Kc,Fr.prototype.has=Wc,Fr.prototype.set=Gc;function yn(x){var U=-1,te=x==null?0:x.length;for(this.clear();++U<te;){var pe=x[U];this.set(pe[0],pe[1])}}function Ci(){this.size=0,this.__data__={hash:new lt,map:new(vt||Fr),string:new lt}}function Vc(x){var U=Nn(this,x).delete(x);return this.size-=U?1:0,U}function Ti(x){return Nn(this,x).get(x)}function kc(x){return Nn(this,x).has(x)}function Yc(x,U){var te=Nn(this,x),pe=te.size;return te.set(x,U),this.size+=te.size==pe?0:1,this}yn.prototype.clear=Ci,yn.prototype.delete=Vc,yn.prototype.get=Ti,yn.prototype.has=kc,yn.prototype.set=Yc;function Ri(x){var U=-1,te=x==null?0:x.length;for(this.__data__=new yn;++U<te;)this.add(x[U])}function go(x){return this.__data__.set(x,s),this}function yo(x){return this.__data__.has(x)}Ri.prototype.add=Ri.prototype.push=go,Ri.prototype.has=yo;function Gr(x){var U=this.__data__=new Fr(x);this.size=U.size}function Jc(){this.__data__=new Fr,this.size=0}function Xc(x){var U=this.__data__,te=U.delete(x);return this.size=U.size,te}function Qc(x){return this.__data__.get(x)}function Zc(x){return this.__data__.has(x)}function _o(x,U){var te=this.__data__;if(te instanceof Fr){var pe=te.__data__;if(!vt||pe.length<t-1)return pe.push([x,U]),this.size=++te.size,this;te=this.__data__=new yn(pe)}return te.set(x,U),this.size=te.size,this}Gr.prototype.clear=Jc,Gr.prototype.delete=Xc,Gr.prototype.get=Qc,Gr.prototype.has=Zc,Gr.prototype.set=_o;function vo(x,U){var te=Fi(x),pe=!te&&Co(x),ct=!te&&!pe&&bs(x),Te=!te&&!pe&&!ct&&No(x),dt=te||pe||ct||Te,jt=dt?yt(x.length,String):[],Qe=jt.length;for(var ut in x)(U||Oe.call(x,ut))&&!(dt&&(ut=="length"||ct&&(ut=="offset"||ut=="parent")||Te&&(ut=="buffer"||ut=="byteLength"||ut=="byteOffset")||xo(ut,Qe)))&&jt.push(ut);return jt}function ii(x,U){for(var te=x.length;te--;)if(Ao(x[te][0],U))return te;return-1}function ws(x,U,te){var pe=U(x);return Fi(x)?pe:We(pe,te(x))}function si(x){return x==null?x===void 0?V:ne:fr&&fr in Object(x)?Do(x):ru(x)}function ms(x){return ai(x)&&si(x)==l}function oi(x,U,te,pe,ct){return x===U?!0:x==null||U==null||!ai(x)&&!ai(U)?x!==x&&U!==U:wo(x,U,te,pe,oi,ct)}function wo(x,U,te,pe,ct,Te){var dt=Fi(x),jt=Fi(U),Qe=dt?y:tn(x),ut=jt?y:tn(U);Qe=Qe==l?L:Qe,ut=ut==l?L:ut;var Nt=Qe==L,mr=ut==L,zt=Qe==ut;if(zt&&bs(x)){if(!bs(U))return!1;dt=!0,Nt=!1}if(zt&&!Nt)return Te||(Te=new Gr),dt||No(x)?Ni(x,U,te,pe,ct,Te):tu(x,U,Qe,te,pe,ct,Te);if(!(te&o)){var pt=Nt&&Oe.call(x,"__wrapped__"),lr=mr&&Oe.call(U,"__wrapped__");if(pt||lr){var Vr=pt?x.value():x,$r=lr?U.value():U;return Te||(Te=new Gr),ct(Vr,$r,te,pe,Te)}}return zt?(Te||(Te=new Gr),Eo(x,U,te,pe,ct,Te)):!1}function eu(x){if(!Ro(x)||Oo(x))return!1;var U=$i(x)?et:oe;return U.test(_n(x))}function mo(x){return ai(x)&&To(x.length)&&!!fe[si(x)]}function bo(x){if(!Po(x))return ni(x);var U=[];for(var te in Object(x))Oe.call(x,te)&&te!="constructor"&&U.push(te);return U}function Ni(x,U,te,pe,ct,Te){var dt=te&o,jt=x.length,Qe=U.length;if(jt!=Qe&&!(dt&&Qe>jt))return!1;var ut=Te.get(x);if(ut&&Te.get(U))return ut==U;var Nt=-1,mr=!0,zt=te&c?new Ri:void 0;for(Te.set(x,U),Te.set(U,x);++Nt<jt;){var pt=x[Nt],lr=U[Nt];if(pe)var Vr=dt?pe(lr,pt,Nt,U,x,Te):pe(pt,lr,Nt,x,U,Te);if(Vr!==void 0){if(Vr)continue;mr=!1;break}if(zt){if(!Ue(U,function($r,rn){if(!qe(zt,rn)&&(pt===$r||ct(pt,$r,te,pe,Te)))return zt.push(rn)})){mr=!1;break}}else if(!(pt===lr||ct(pt,lr,te,pe,Te))){mr=!1;break}}return Te.delete(x),Te.delete(U),mr}function tu(x,U,te,pe,ct,Te,dt){switch(te){case ue:if(x.byteLength!=U.byteLength||x.byteOffset!=U.byteOffset)return!1;x=x.buffer,U=U.buffer;case se:return!(x.byteLength!=U.byteLength||!Te(new hr(x),new hr(U)));case _:case D:case z:return Ao(+x,+U);case S:return x.name==U.name&&x.message==U.message;case T:case h:return x==U+"";case B:var jt=Le;case E:var Qe=pe&o;if(jt||(jt=Be),x.size!=U.size&&!Qe)return!1;var ut=dt.get(x);if(ut)return ut==U;pe|=c,dt.set(x,U);var Nt=Ni(jt(x),jt(U),pe,ct,Te,dt);return dt.delete(x),Nt;case m:if(At)return At.call(x)==At.call(U)}return!1}function Eo(x,U,te,pe,ct,Te){var dt=te&o,jt=Li(x),Qe=jt.length,ut=Li(U),Nt=ut.length;if(Qe!=Nt&&!dt)return!1;for(var mr=Qe;mr--;){var zt=jt[mr];if(!(dt?zt in U:Oe.call(U,zt)))return!1}var pt=Te.get(x);if(pt&&Te.get(U))return pt==U;var lr=!0;Te.set(x,U),Te.set(U,x);for(var Vr=dt;++mr<Qe;){zt=jt[mr];var $r=x[zt],rn=U[zt];if(pe)var Es=dt?pe(rn,$r,zt,U,x,Te):pe($r,rn,zt,x,U,Te);if(!(Es===void 0?$r===rn||ct($r,rn,te,pe,Te):Es)){lr=!1;break}Vr||(Vr=zt=="constructor")}if(lr&&!Vr){var ci=x.constructor,kt=U.constructor;ci!=kt&&"constructor"in x&&"constructor"in U&&!(typeof ci=="function"&&ci instanceof ci&&typeof kt=="function"&&kt instanceof kt)&&(lr=!1)}return Te.delete(x),Te.delete(U),lr}function Li(x){return ws(x,su,So)}function Nn(x,U){var te=x.__data__;return Io(U)?te[typeof U=="string"?"string":"hash"]:te.map}function Pr(x,U){var te=Ie(x,U);return eu(te)?te:void 0}function Do(x){var U=Oe.call(x,fr),te=x[fr];try{x[fr]=void 0;var pe=!0}catch{}var ct=Ye.call(x);return pe&&(U?x[fr]=te:delete x[fr]),ct}var So=gn?function(x){return x==null?[]:(x=Object(x),je(gn(x),function(U){return wr.call(x,U)}))}:at,tn=si;(St&&tn(new St(new ArrayBuffer(1)))!=ue||vt&&tn(new vt)!=B||xt&&tn(xt.resolve())!=M||It&&tn(new It)!=E||Et&&tn(new Et)!=Y)&&(tn=function(x){var U=si(x),te=U==L?x.constructor:void 0,pe=te?_n(te):"";if(pe)switch(pe){case Ut:return ue;case Mt:return B;case Ot:return M;case qt:return E;case Pt:return Y}return U});function xo(x,U){return U=U??u,!!U&&(typeof x=="number"||be.test(x))&&x>-1&&x%1==0&&x<U}function Io(x){var U=typeof x;return U=="string"||U=="number"||U=="symbol"||U=="boolean"?x!=="__proto__":x===null}function Oo(x){return!!Ge&&Ge in x}function Po(x){var U=x&&x.constructor,te=typeof U=="function"&&U.prototype||Se;return x===te}function ru(x){return Ye.call(x)}function _n(x){if(x!=null){try{return ze.call(x)}catch{}try{return x+""}catch{}}return""}function Ao(x,U){return x===U||x!==x&&U!==U}var Co=ms(function(){return arguments}())?ms:function(x){return ai(x)&&Oe.call(x,"callee")&&!wr.call(x,"callee")},Fi=Array.isArray;function nu(x){return x!=null&&To(x.length)&&!$i(x)}var bs=Rn||ot;function iu(x,U){return oi(x,U)}function $i(x){if(!Ro(x))return!1;var U=si(x);return U==P||U==I||U==p||U==A}function To(x){return typeof x=="number"&&x>-1&&x%1==0&&x<=u}function Ro(x){var U=typeof x;return x!=null&&(U=="object"||U=="function")}function ai(x){return x!=null&&typeof x=="object"}var No=xe?_t(xe):mo;function su(x){return nu(x)?vo(x):bo(x)}function at(){return[]}function ot(){return!1}r.exports=iu})(bc,bc.exports);var rb=bc.exports;function nb(r,e){return e=e||{},new Promise(function(t,s){var o=new XMLHttpRequest,c=[],u=[],l={},y=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:y,headers:{keys:function(){return c},entries:function(){return u},get:function(_){return l[_.toLowerCase()]},has:function(_){return _.toLowerCase()in l}}}};for(var p in o.open(e.method||"get",r,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(_,D,S){c.push(D=D.toLowerCase()),u.push([D,S]),l[D]=l[D]?l[D]+","+S:S}),t(y())},o.onerror=s,o.withCredentials=e.credentials=="include",e.headers)o.setRequestHeader(p,e.headers[p]);o.send(e.body||null)})}var ib=Object.freeze({__proto__:null,default:nb}),Al=Kn(ib),sb=self.fetch||(self.fetch=Al.default||Al),ob=Object.defineProperty,Cl=Object.getOwnPropertySymbols,ab=Object.prototype.hasOwnProperty,cb=Object.prototype.propertyIsEnumerable,Tl=(r,e,t)=>e in r?ob(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,cr=(r,e)=>{for(var t in e||(e={}))ab.call(e,t)&&Tl(r,t,e[t]);if(Cl)for(var t of Cl(e))cb.call(e,t)&&Tl(r,t,e[t]);return r};function ub(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<r.length;o++){var c=r.charAt(o),u=c.charCodeAt(0);if(t[u]!==255)throw new TypeError(c+" is ambiguous");t[u]=o}var l=r.length,y=r.charAt(0),p=Math.log(l)/Math.log(256),_=Math.log(256)/Math.log(l);function D(I){if(I instanceof Uint8Array||(ArrayBuffer.isView(I)?I=new Uint8Array(I.buffer,I.byteOffset,I.byteLength):Array.isArray(I)&&(I=Uint8Array.from(I))),!(I instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(I.length===0)return"";for(var B=0,z=0,ne=0,L=I.length;ne!==L&&I[ne]===0;)ne++,B++;for(var M=(L-ne)*_+1>>>0,A=new Uint8Array(M);ne!==L;){for(var T=I[ne],E=0,h=M-1;(T!==0||E<z)&&h!==-1;h--,E++)T+=256*A[h]>>>0,A[h]=T%l>>>0,T=T/l>>>0;if(T!==0)throw new Error("Non-zero carry");z=E,ne++}for(var m=M-z;m!==M&&A[m]===0;)m++;for(var V=y.repeat(B);m<M;++m)V+=r.charAt(A[m]);return V}function S(I){if(typeof I!="string")throw new TypeError("Expected String");if(I.length===0)return new Uint8Array;var B=0;if(I[B]!==" "){for(var z=0,ne=0;I[B]===y;)z++,B++;for(var L=(I.length-B)*p+1>>>0,M=new Uint8Array(L);I[B];){var A=t[I.charCodeAt(B)];if(A===255)return;for(var T=0,E=L-1;(A!==0||T<ne)&&E!==-1;E--,T++)A+=l*M[E]>>>0,M[E]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");ne=T,B++}if(I[B]!==" "){for(var h=L-ne;h!==L&&M[h]===0;)h++;for(var m=new Uint8Array(z+(L-h)),V=z;h!==L;)m[V++]=M[h++];return m}}}function P(I){var B=S(I);if(B)return B;throw new Error(`Non-${e} character`)}return{encode:D,decodeUnsafe:S,decode:P}}var hb=ub,fb=hb;const Rl=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},lb=r=>new TextEncoder().encode(r),db=r=>new TextDecoder().decode(r);class pb{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class gb{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Nl(this,e)}}class yb{constructor(e){this.decoders=e}or(e){return Nl(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Nl=(r,e)=>new yb(cr(cr({},r.decoders||{[r.prefix]:r}),e.decoders||{[e.prefix]:e}));class _b{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new pb(e,t,s),this.decoder=new gb(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const co=({name:r,prefix:e,encode:t,decode:s})=>new _b(r,e,t,s),gs=({prefix:r,name:e,alphabet:t})=>{const{encode:s,decode:o}=fb(t,e);return co({prefix:r,name:e,encode:s,decode:c=>Rl(o(c))})},vb=(r,e,t,s)=>{const o={};for(let _=0;_<e.length;++_)o[e[_]]=_;let c=r.length;for(;r[c-1]==="=";)--c;const u=new Uint8Array(c*t/8|0);let l=0,y=0,p=0;for(let _=0;_<c;++_){const D=o[r[_]];if(D===void 0)throw new SyntaxError(`Non-${s} character`);y=y<<t|D,l+=t,l>=8&&(l-=8,u[p++]=255&y>>l)}if(l>=t||255&y<<8-l)throw new SyntaxError("Unexpected end of data");return u},wb=(r,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",u=0,l=0;for(let y=0;y<r.length;++y)for(l=l<<8|r[y],u+=8;u>t;)u-=t,c+=e[o&l>>u];if(u&&(c+=e[o&l<<t-u]),s)for(;c.length*t&7;)c+="=";return c},Xt=({name:r,prefix:e,bitsPerChar:t,alphabet:s})=>co({prefix:e,name:r,encode(o){return wb(o,s,t)},decode(o){return vb(o,s,t,r)}}),mb=co({prefix:"\0",name:"identity",encode:r=>db(r),decode:r=>lb(r)});var bb=Object.freeze({__proto__:null,identity:mb});const Eb=Xt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Db=Object.freeze({__proto__:null,base2:Eb});const Sb=Xt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var xb=Object.freeze({__proto__:null,base8:Sb});const Ib=gs({prefix:"9",name:"base10",alphabet:"0123456789"});var Ob=Object.freeze({__proto__:null,base10:Ib});const Pb=Xt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ab=Xt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Cb=Object.freeze({__proto__:null,base16:Pb,base16upper:Ab});const Tb=Xt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Rb=Xt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Nb=Xt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Lb=Xt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Fb=Xt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),$b=Xt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ub=Xt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Mb=Xt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),qb=Xt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Bb=Object.freeze({__proto__:null,base32:Tb,base32upper:Rb,base32pad:Nb,base32padupper:Lb,base32hex:Fb,base32hexupper:$b,base32hexpad:Ub,base32hexpadupper:Mb,base32z:qb});const Hb=gs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),jb=gs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var zb=Object.freeze({__proto__:null,base36:Hb,base36upper:jb});const Kb=gs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Wb=gs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Gb=Object.freeze({__proto__:null,base58btc:Kb,base58flickr:Wb});const Vb=Xt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),kb=Xt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Yb=Xt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Jb=Xt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Xb=Object.freeze({__proto__:null,base64:Vb,base64pad:kb,base64url:Yb,base64urlpad:Jb});const Ll=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Qb=Ll.reduce((r,e,t)=>(r[t]=e,r),[]),Zb=Ll.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function eE(r){return r.reduce((e,t)=>(e+=Qb[t],e),"")}function tE(r){const e=[];for(const t of r){const s=Zb[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const rE=co({prefix:"\u{1F680}",name:"base256emoji",encode:eE,decode:tE});var nE=Object.freeze({__proto__:null,base256emoji:rE}),iE=$l,Fl=128,sE=127,oE=~sE,aE=Math.pow(2,31);function $l(r,e,t){e=e||[],t=t||0;for(var s=t;r>=aE;)e[t++]=r&255|Fl,r/=128;for(;r&oE;)e[t++]=r&255|Fl,r>>>=7;return e[t]=r|0,$l.bytes=t-s+1,e}var cE=Ec,uE=128,Ul=127;function Ec(r,s){var t=0,s=s||0,o=0,c=s,u,l=r.length;do{if(c>=l)throw Ec.bytes=0,new RangeError("Could not decode varint");u=r[c++],t+=o<28?(u&Ul)<<o:(u&Ul)*Math.pow(2,o),o+=7}while(u>=uE);return Ec.bytes=c-s,t}var hE=Math.pow(2,7),fE=Math.pow(2,14),lE=Math.pow(2,21),dE=Math.pow(2,28),pE=Math.pow(2,35),gE=Math.pow(2,42),yE=Math.pow(2,49),_E=Math.pow(2,56),vE=Math.pow(2,63),wE=function(r){return r<hE?1:r<fE?2:r<lE?3:r<dE?4:r<pE?5:r<gE?6:r<yE?7:r<_E?8:r<vE?9:10},mE={encode:iE,decode:cE,encodingLength:wE},Ml=mE;const ql=(r,e,t=0)=>(Ml.encode(r,e,t),e),Bl=r=>Ml.encodingLength(r),Dc=(r,e)=>{const t=e.byteLength,s=Bl(r),o=s+Bl(t),c=new Uint8Array(o+t);return ql(r,c,0),ql(t,c,s),c.set(e,o),new bE(r,t,e,c)};class bE{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const Hl=({name:r,code:e,encode:t})=>new EE(r,e,t);class EE{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Dc(this.code,t):t.then(s=>Dc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const jl=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),DE=Hl({name:"sha2-256",code:18,encode:jl("SHA-256")}),SE=Hl({name:"sha2-512",code:19,encode:jl("SHA-512")});var xE=Object.freeze({__proto__:null,sha256:DE,sha512:SE});const zl=0,IE="identity",Kl=Rl;var OE=Object.freeze({__proto__:null,identity:{code:zl,name:IE,encode:Kl,digest:r=>Dc(zl,Kl(r))}});new TextEncoder,new TextDecoder;const Wl=cr(cr(cr(cr(cr(cr(cr(cr(cr(cr({},bb),Db),xb),Ob),Cb),Bb),zb),Gb),Xb),nE);cr(cr({},xE),OE);function Gl(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function PE(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Gl(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function Vl(r,e,t,s){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:s}}}const kl=Vl("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Sc=Vl("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=PE(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),AE=cr({utf8:kl,"utf-8":kl,hex:Wl.base16,latin1:Sc,ascii:Sc,binary:Sc},Wl);function CE(r,e="utf8"){const t=AE[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Gl(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}const Yl="wc",TE=2,xc="core",An=`${Yl}@2:${xc}:`,RE={name:xc,logger:"error"},NE={database:":memory:"},LE="crypto",Jl="client_ed25519_seed",FE=_e.ONE_DAY,$E="keychain",UE="0.3",ME="messages",qE="0.3",BE=_e.SIX_HOURS,HE="publisher",Xl="irn",jE="error",Ql="wss://relay.walletconnect.com",Zl="wss://relay.walletconnect.org",zE="relayer",tr={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},KE="_subscription",fn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},WE=_e.ONE_SECOND,GE="2.11.2",VE=1e4,kE="0.3",YE="WALLETCONNECT_CLIENT_ID",Wr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},JE="subscription",XE="0.3",QE=_e.FIVE_SECONDS*1e3,ZE="pairing",e3="0.3",ys={wc_pairingDelete:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:0},res:{ttl:_e.ONE_DAY,prompt:!1,tag:0}}},_s={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Zr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},t3="history",r3="0.3",n3="expirer",Lr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},i3="0.3",Ic="verify-api",Pi="https://verify.walletconnect.com",Oc="https://verify.walletconnect.org",s3=[Pi,Oc],o3="echo",a3="https://echo.walletconnect.com";class c3{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=$E,this.version=UE,this.initialized=!1,this.storagePrefix=An,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=ce("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=ke.generateChildLogger(t,this.name)}get context(){return ke.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,el(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?tl(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class u3{constructor(e,t,s){this.core=e,this.logger=t,this.name=LE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=Of(o);return If(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=Q1();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),u=Of(c),l=ac();return await i1(l,o,FE,u)},this.generateSharedKey=(o,c,u)=>{this.isInitialized();const l=this.getPrivateKey(o),y=Z1(l,c);return this.setSymKey(y,u)},this.setSymKey=async(o,c)=>{this.isInitialized();const u=c||ew(o);return await this.keychain.set(u,o),u},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,u)=>{this.isInitialized();const l=Yf(u),y=Gn(c);if(Jf(l)){const S=l.senderPublicKey,P=l.receiverPublicKey;o=await this.generateSharedKey(S,P)}const p=this.getSymKey(o),{type:_,senderPublicKey:D}=l;return rw({type:_,symKey:p,message:y,senderPublicKey:D})},this.decode=async(o,c,u)=>{this.isInitialized();const l=sw(c,u);if(Jf(l)){const y=l.receiverPublicKey,p=l.senderPublicKey;o=await this.generateSharedKey(y,p)}try{const y=this.getSymKey(o),p=nw({symKey:y,encoded:c});return Xi(p)}catch(y){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(y)}},this.getPayloadType=o=>{const c=to(o);return cs(c.type)},this.getPayloadSenderPublicKey=o=>{const c=to(o);return c.senderPublicKey?sr(c.senderPublicKey,or):void 0},this.core=e,this.logger=ke.generateChildLogger(t,this.name),this.keychain=s||new c3(this.core,this.logger)}get context(){return ke.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Jl)}catch{e=ac(),await this.keychain.set(Jl,e)}return CE(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class h3 extends qy{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=ME,this.version=qE,this.initialized=!1,this.storagePrefix=An,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=Ei(o);let u=this.messages.get(s);return typeof u>"u"&&(u={}),typeof u[c]<"u"||(u[c]=o,this.messages.set(s,u),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),u=Ei(o);return typeof c[u]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=ke.generateChildLogger(e,this.name),this.core=t}get context(){return ke.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,el(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?tl(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class f3 extends By{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new Zt.exports.EventEmitter,this.name=HE,this.queue=new Map,this.publishTimeout=_e.toMiliseconds(_e.TEN_SECONDS*2),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{var u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const l=c?.ttl||BE,y=hc(c),p=c?.prompt||!1,_=c?.tag||0,D=c?.id||El().toString(),S={topic:s,message:o,opts:{ttl:l,relay:y,prompt:p,tag:_,id:D}},P=setTimeout(()=>this.queue.set(D,S),this.publishTimeout);try{await await hs(this.rpcPublish(s,o,l,y,p,_,D),this.publishTimeout,`Failed to publish payload, please try again. id:${D} tag:${_}`),this.removeRequestFromQueue(D),this.relayer.events.emit(tr.publish,S)}catch(I){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(u=c?.internal)!=null&&u.throwOnFailedPublish)throw this.removeRequestFromQueue(D),I;return}finally{clearTimeout(P)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(l){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(l),l}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=ke.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return ke.getLoggerContext(this.logger)}rpcPublish(e,t,s,o,c,u,l){var y,p,_,D;const S={method:ro(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:c,tag:u},id:l};return ar((y=S.params)==null?void 0:y.prompt)&&((p=S.params)==null||delete p.prompt),ar((_=S.params)==null?void 0:_.tag)&&((D=S.params)==null||delete D.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:S}),this.relayer.request(S)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(vi.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(tr.connection_stalled);return}this.checkQueue()}),this.relayer.on(tr.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class l3{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var d3=Object.defineProperty,p3=Object.defineProperties,g3=Object.getOwnPropertyDescriptors,ed=Object.getOwnPropertySymbols,y3=Object.prototype.hasOwnProperty,_3=Object.prototype.propertyIsEnumerable,td=(r,e,t)=>e in r?d3(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,vs=(r,e)=>{for(var t in e||(e={}))y3.call(e,t)&&td(r,t,e[t]);if(ed)for(var t of ed(e))_3.call(e,t)&&td(r,t,e[t]);return r},Pc=(r,e)=>p3(r,g3(e));class v3 extends zy{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new l3,this.events=new Zt.exports.EventEmitter,this.name=JE,this.version=XE,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=An,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=hc(o),u={topic:s,relay:c};this.pending.set(s,u);const l=await this.rpcSubscribe(s,c);return this.onSubscribe(l,u),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),l}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof o?.id<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>{if(this.topics.includes(s))return!0;const o=`${this.pendingSubscriptionWatchLabel}_${s}`;return await new Promise((c,u)=>{const l=new _e.Watch;l.start(o);const y=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(y),l.stop(o),c(!0)),l.elapsed(o)>=QE&&(clearInterval(y),l.stop(o),u(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=ke.generateChildLogger(t,this.name),this.clientId=""}get context(){return ke.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=hc(s);await this.rpcUnsubscribe(e,t,o);const c=bt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:ro(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await hs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(tr.connection_stalled)}return Ei(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:ro(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await hs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(tr.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:ro(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,Pc(vs({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,vs({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,vs({},t)),this.topicMap.set(t.topic,e),this.events.emit(Wr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(Wr.deleted,Pc(vs({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Wr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Wr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);ti(t)&&this.onBatchSubscribe(t.map((s,o)=>Pc(vs({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(vi.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(tr.connect,async()=>{await this.onConnect()}),this.relayer.on(tr.disconnect,()=>{this.onDisconnect()}),this.events.on(Wr.created,async e=>{const t=Wr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(Wr.deleted,async e=>{const t=Wr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var w3=Object.defineProperty,rd=Object.getOwnPropertySymbols,m3=Object.prototype.hasOwnProperty,b3=Object.prototype.propertyIsEnumerable,nd=(r,e,t)=>e in r?w3(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,E3=(r,e)=>{for(var t in e||(e={}))m3.call(e,t)&&nd(r,t,e[t]);if(rd)for(var t of rd(e))b3.call(e,t)&&nd(r,t,e[t]);return r};class D3 extends Hy{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Zt.exports.EventEmitter,this.name=zE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.request=async t=>{this.logger.debug("Publishing Request Payload");const s=t.id;try{await this.toEstablishConnection();const o=this.provider.request(t);return this.requestsInFlight.set(s,{promise:o,request:t}),await o}catch(o){throw this.logger.debug("Failed to Publish Request"),this.logger.error(o),o}finally{this.requestsInFlight.delete(s)}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(tr.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(tr.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(fn.payload,this.onPayloadHandler),this.provider.on(fn.connect,this.onConnectHandler),this.provider.on(fn.disconnect,this.onDisconnectHandler),this.provider.on(fn.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?ke.generateChildLogger(e.logger,this.name):ke.pino(ke.getDefaultLoggerOptions({level:e.logger||jE})),this.messages=new h3(this.logger,e.core),this.subscriber=new v3(this,this.logger),this.publisher=new f3(this,this.logger),this.relayUrl=e?.relayUrl||Ql,this.projectId=e.projectId,this.bundleId=fw(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Zl}...`),await this.restartTransport(Zl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},VE)}get context(){return ke.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";if(o)return o;let c;const u=l=>{l.topic===e&&(this.subscriber.off(Wr.created,u),c())};return await Promise.all([new Promise(l=>{c=l,this.subscriber.on(Wr.created,u)}),new Promise(async l=>{o=await this.subscriber.subscribe(e,t),l()})]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.requestsInFlight.size>0&&(this.logger.debug("Waiting for all in-flight requests to finish before closing transport..."),this.requestsInFlight.forEach(async e=>{await e.promise})),this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await hs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(Wr.resubscribed,()=>{t()})}),new Promise(async(t,s)=>{try{await hs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}t()})])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.provider.events.emit(fn.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await dl())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new hn(new tb(_w({sdkVersion:GE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const o=this.messages.has(t,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),mc(e)){if(!e.method.endsWith(KE))return;const t=e.params,{topic:s,message:o,publishedAt:c}=t.data,u={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(E3({type:"event",event:t.id},u)),this.events.emit(t.id,u),await this.acknowledgePayload(e),await this.onMessageEvent(u)}else ao(e)&&this.events.emit(tr.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(tr.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=so(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(fn.payload,this.onPayloadHandler),this.provider.off(fn.connect,this.onConnectHandler),this.provider.off(fn.disconnect,this.onDisconnectHandler),this.provider.off(fn.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(tr.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let e=await dl();fm(async t=>{this.initialized&&e!==t&&(e=t,t?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(tr.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},_e.toMiliseconds(WE)))}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var S3=Object.defineProperty,id=Object.getOwnPropertySymbols,x3=Object.prototype.hasOwnProperty,I3=Object.prototype.propertyIsEnumerable,sd=(r,e,t)=>e in r?S3(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,od=(r,e)=>{for(var t in e||(e={}))x3.call(e,t)&&sd(r,t,e[t]);if(id)for(var t of id(e))I3.call(e,t)&&sd(r,t,e[t]);return r};class uo extends jy{constructor(e,t,s,o=An,c=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=kE,this.cached=[],this.initialized=!1,this.storagePrefix=An,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(u=>{this.getKey&&u!==null&&!ar(u)?this.map.set(this.getKey(u),u):jw(u)?this.map.set(u.id,u):zw(u)&&this.map.set(u.topic,u)}),this.cached=[],this.initialized=!0)},this.set=async(u,l)=>{this.isInitialized(),this.map.has(u)?await this.update(u,l):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:u,value:l}),this.map.set(u,l),await this.persist())},this.get=u=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:u}),this.getData(u)),this.getAll=u=>(this.isInitialized(),u?this.values.filter(l=>Object.keys(u).every(y=>rb(l[y],u[y]))):this.values),this.update=async(u,l)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:u,update:l});const y=od(od({},this.getData(u)),l);this.map.set(u,y),await this.persist()},this.delete=async(u,l)=>{this.isInitialized(),this.map.has(u)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:u,reason:l}),this.map.delete(u),await this.persist())},this.logger=ke.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return ke.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class O3{constructor(e,t){this.core=e,this.logger=t,this.name=ZE,this.version=e3,this.events=new Zt.exports,this.initialized=!1,this.storagePrefix=An,this.ignoredPayloadTypes=[Zn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=ac(),o=await this.core.crypto.setSymKey(s),c=Or(_e.FIVE_MINUTES),u={protocol:Xl},l={topic:o,expiry:c,relay:u,active:!1},y=Nw({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:u,expiryTimestamp:c});return await this.pairings.set(o,l),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:y}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:u,expiryTimestamp:l}=ol(s.uri);let y;if(this.pairings.keys.includes(o)&&(y=this.pairings.get(o),y.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const p=l||Or(_e.FIVE_MINUTES),_={topic:o,relay:u,expiry:p,active:!1};return await this.pairings.set(o,_),this.core.expirer.set(o,p),s.activatePairing&&await this.activate({topic:o}),this.events.emit(_s.create,_),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:u})),_},this.activate=async({topic:s})=>{this.isInitialized();const o=Or(_e.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:u,resolve:l,reject:y}=xi();this.events.once(Tt("pairing_ping",c),({error:p})=>{p?y(p):l()}),await u()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",bt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const u=Oi(o,c),l=await this.core.crypto.encode(s,u),y=ys[o].req;return this.core.history.set(s,u),this.core.relayer.publish(s,l,y),u.id},this.sendResult=async(s,o,c)=>{const u=so(s,c),l=await this.core.crypto.encode(o,u),y=await this.core.history.get(o,s),p=ys[y.request.method].res;await this.core.relayer.publish(o,l,p),await this.core.history.resolve(u)},this.sendError=async(s,o,c)=>{const u=oo(s,c),l=await this.core.crypto.encode(o,u),y=await this.core.history.get(o,s),p=ys[y.request.method]?ys[y.request.method].res:ys.unregistered_method.res;await this.core.relayer.publish(o,l,p),await this.core.history.resolve(u)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,bt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>Pn(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,u=(await this.core.history.get(o,c.id)).request.method;switch(u){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(u)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit(_s.ping,{id:c,topic:s})}catch(u){await this.sendError(c,s,u),this.logger.error(u)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{un(o)?this.events.emit(Tt("pairing_ping",c),{}):Kr(o)&&this.events.emit(Tt("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(_s.delete,{id:c,topic:s})}catch(u){await this.sendError(c,s,u),this.logger.error(u)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:u}=o;try{if(this.registeredMethods.includes(u))return;const l=bt("WC_METHOD_UNSUPPORTED",u);await this.sendError(c,s,l),this.logger.error(l)}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(bt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!vr(s)){const{message:u}=ce("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(u)}if(!Hw(s.uri)){const{message:u}=ce("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(u)}const c=ol(s.uri);if(!((o=c?.relay)!=null&&o.protocol)){const{message:u}=ce("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(u)}if(!(c!=null&&c.symKey)){const{message:u}=ce("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(u)}if(c!=null&&c.expiryTimestamp&&_e.toMiliseconds(c?.expiryTimestamp)<Date.now()){const{message:u}=ce("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(u)}},this.isValidPing=async s=>{if(!vr(s)){const{message:c}=ce("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!vr(s)){const{message:c}=ce("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Vt(s,!1)){const{message:o}=ce("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=ce("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Pn(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=ce("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=ke.generateChildLogger(t,this.name),this.pairings=new uo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return ke.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(tr.message,async e=>{const{topic:t,message:s}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);try{mc(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ao(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Lr.expired,async e=>{const{topic:t}=nl(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(_s.expire,{topic:t}))})}}class P3 extends My{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new Zt.exports.EventEmitter,this.name=t3,this.version=r3,this.cached=[],this.initialized=!1,this.storagePrefix=An,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const u={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:Or(_e.THIRTY_DAYS)};this.records.set(u.id,u),this.events.emit(Zr.created,u)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Kr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Zr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(Zr.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=ke.generateChildLogger(t,this.name)}get context(){return ke.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:Oi(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Zr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Zr.created,e=>{const t=Zr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(Zr.updated,e=>{const t=Zr.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(Zr.deleted,e=>{const t=Zr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(vi.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{_e.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class A3 extends Ky{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new Zt.exports.EventEmitter,this.name=n3,this.version=i3,this.cached=[],this.initialized=!1,this.storagePrefix=An,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),u={target:c,expiry:o};this.expirations.set(c,u),this.checkExpiry(c,u),this.events.emit(Lr.created,{target:c,expiration:u})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Lr.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=ke.generateChildLogger(t,this.name)}get context(){return ke.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return vw(e);if(typeof e=="number")return ww(e);const{message:t}=ce("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Lr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;_e.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Lr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(vi.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Lr.created,e=>{const t=Lr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Lr.expired,e=>{const t=Lr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Lr.deleted,e=>{const t=Lr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class C3 extends Wy{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=Ic,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||Di()||!Si())return;const o=this.getVerifyUrl(s?.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Oc;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s?.verifyUrl);let c;try{c=await this.fetchAttestation(s.attestationId,o)}catch(u){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(u),c=await this.fetchAttestation(s.attestationId,Oc)}return c},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const c=this.startAbortTimer(_e.ONE_SECOND*2),u=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(c),u.status===200?await u.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(c=>{if(document.getElementById(Ic))return c();window.addEventListener("message",o);const u=document.createElement("iframe");u.id=Ic,u.src=`${this.verifyUrl}/${this.projectId}`,u.style.display="none",document.body.append(u),this.iframe=u,s=c}),new Promise((c,u)=>setTimeout(()=>{window.removeEventListener("message",o),u("verify iframe load timeout")},_e.toMiliseconds(_e.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||Pi;return s3.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${Pi}`),o=Pi),o},this.logger=ke.generateChildLogger(t,this.name),this.verifyUrl=Pi,this.abortController=new AbortController,this.isDevEnv=cc()&&process.env.IS_VITEST}get context(){return ke.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),_e.toMiliseconds(e))}}class T3 extends Gy{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=o3,this.registerDeviceToken=async s=>{const{clientId:o,token:c,notificationType:u,enableEncrypted:l=!1}=s,y=`${a3}/${this.projectId}/clients`;await sb(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:u,token:c,always_raw:l})})},this.logger=ke.generateChildLogger(t,this.context)}}var R3=Object.defineProperty,ad=Object.getOwnPropertySymbols,N3=Object.prototype.hasOwnProperty,L3=Object.prototype.propertyIsEnumerable,cd=(r,e,t)=>e in r?R3(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ud=(r,e)=>{for(var t in e||(e={}))N3.call(e,t)&&cd(r,t,e[t]);if(ad)for(var t of ad(e))L3.call(e,t)&&cd(r,t,e[t]);return r};class Ac extends Uy{constructor(e){super(e),this.protocol=Yl,this.version=TE,this.name=xc,this.events=new Zt.exports.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Ql,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const t=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:ke.pino(ke.getDefaultLoggerOptions({level:e?.logger||RE.logger}));this.logger=ke.generateChildLogger(t,this.name),this.heartbeat=new vi.HeartBeat,this.crypto=new u3(this,this.logger,e?.keychain),this.history=new P3(this,this.logger),this.expirer=new A3(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new d0(ud(ud({},NE),e?.storageOptions)),this.relayer=new D3({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new O3(this,this.logger),this.verify=new C3(this.projectId||"",this.logger),this.echoClient=new T3(this.projectId||"",this.logger)}static async init(e){const t=new Ac(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(YE,s),t}get context(){return ke.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const F3=Ac,hd="wc",fd=2,ld="client",Cc=`${hd}@${fd}:${ld}:`,Tc={name:ld,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},dd="WALLETCONNECT_DEEPLINK_CHOICE",$3="proposal",pd="Proposal expired",U3="session",ho=_e.SEVEN_DAYS,M3="engine",ln={wc_sessionPropose:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1104},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1106},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1112},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1115}}},Rc={min:_e.FIVE_MINUTES,max:_e.SEVEN_DAYS},dn={idle:"IDLE",active:"ACTIVE"},q3="request",B3=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var H3=Object.defineProperty,j3=Object.defineProperties,z3=Object.getOwnPropertyDescriptors,gd=Object.getOwnPropertySymbols,K3=Object.prototype.hasOwnProperty,W3=Object.prototype.propertyIsEnumerable,yd=(r,e,t)=>e in r?H3(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ur=(r,e)=>{for(var t in e||(e={}))K3.call(e,t)&&yd(r,t,e[t]);if(gd)for(var t of gd(e))W3.call(e,t)&&yd(r,t,e[t]);return r},Ai=(r,e)=>j3(r,z3(e));class G3 extends ky{constructor(e){super(e),this.name=M3,this.events=new Zt.exports,this.initialized=!1,this.ignoredPayloadTypes=[Zn],this.requestQueue={state:dn.idle,queue:[]},this.sessionRequestQueue={state:dn.idle,queue:[]},this.requestQueueDelay=_e.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(ln)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},_e.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const s=Ai(ur({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:u,sessionProperties:l,relays:y}=s;let p=o,_,D=!1;if(p&&(D=this.client.core.pairing.pairings.get(p).active),!p||!D){const{topic:A,uri:T}=await this.client.core.pairing.create();p=A,_=T}const S=await this.client.core.crypto.generateKeyPair(),P=ln.wc_sessionPropose.req.ttl||_e.FIVE_MINUTES,I=Or(P),B=ur({requiredNamespaces:c,optionalNamespaces:u,relays:y??[{protocol:Xl}],proposer:{publicKey:S,metadata:this.client.metadata},expiryTimestamp:I},l&&{sessionProperties:l}),{reject:z,resolve:ne,done:L}=xi(P,pd);if(this.events.once(Tt("session_connect"),async({error:A,session:T})=>{if(A)z(A);else if(T){T.self.publicKey=S;const E=Ai(ur({},T),{requiredNamespaces:B.requiredNamespaces,optionalNamespaces:B.optionalNamespaces});await this.client.session.set(T.topic,E),await this.setExpiry(T.topic,T.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:T.peer.metadata}),ne(E)}}),!p){const{message:A}=ce("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(A)}const M=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:B,throwOnFailedPublish:!0});return await this.setProposal(M,ur({id:M},B)),{uri:_,approval:L}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:u}=t,l=this.client.proposal.get(s);let{pairingTopic:y,proposer:p,requiredNamespaces:_,optionalNamespaces:D}=l;y=y||"";const S=await this.client.core.crypto.generateKeyPair(),P=p.publicKey,I=await this.client.core.crypto.generateSharedKey(S,P);y&&s&&(await this.client.core.pairing.updateMetadata({topic:y,metadata:p.metadata}),await this.sendResult({id:s,topic:y,result:{relay:{protocol:o??"irn"},responderPublicKey:S}}),await this.client.proposal.delete(s,bt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:y}));const B=ur({relay:{protocol:o??"irn"},namespaces:c,pairingTopic:y,controller:{publicKey:S,metadata:this.client.metadata},expiry:Or(ho)},u&&{sessionProperties:u});await this.client.core.relayer.subscribe(I);const z=Ai(ur({},B),{topic:I,requiredNamespaces:_,optionalNamespaces:D,pairingTopic:y,acknowledged:!1,self:B.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:S});await this.client.session.set(I,z);try{await this.sendRequest({topic:I,method:"wc_sessionSettle",params:B,throwOnFailedPublish:!0})}catch(ne){throw this.client.logger.error(ne),this.client.session.delete(I,bt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(I),ne}return await this.setExpiry(I,Or(ho)),{topic:I,acknowledged:()=>new Promise(ne=>setTimeout(()=>ne(this.client.session.get(I)),500))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,bt("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,c=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:u,resolve:l,reject:y}=xi();return this.events.once(Tt("session_update",c),({error:p})=>{p?y(p):l()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:u}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:c,resolve:u,reject:l}=xi();return this.events.once(Tt("session_extend",o),({error:y})=>{y?l(y):u()}),await this.setExpiry(s,Or(ho)),{acknowledged:c}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:c,expiry:u=ln.wc_sessionRequest.req.ttl}=t,l=wc(),{done:y,resolve:p,reject:_}=xi(u,"Request expired. Please try again.");return this.events.once(Tt("session_request",l),({error:D,result:S})=>{D?_(D):p(S)}),await Promise.all([new Promise(async D=>{await this.sendRequest({clientRpcId:l,topic:c,method:"wc_sessionRequest",params:{request:Ai(ur({},o),{expiryTimestamp:Or(u)}),chainId:s},expiry:u,throwOnFailedPublish:!0}).catch(S=>_(S)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:l}),D()}),new Promise(async D=>{const S=await bw(this.client.core.storage,dd);mw({id:l,topic:c,wcDeepLink:S}),D()}),y()]).then(D=>D[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:c}=o;un(o)?await this.sendResult({id:c,topic:s,result:o.result,throwOnFailedPublish:!0}):Kr(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:c,resolve:u,reject:l}=xi();this.events.once(Tt("session_ping",o),({error:y})=>{y?l(y):u()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:c}=t;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;if(this.client.session.keys.includes(s))await this.sendRequest({topic:s,method:"wc_sessionDelete",params:bt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:s,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(s))await this.client.core.pairing.disconnect({topic:s});else{const{message:o}=ce("MISMATCHED_TOPIC",`Session or pairing topic not found: ${s}`);throw new Error(o)}},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>qw(s,t))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var u,l;return((u=c.peerMetadata)==null?void 0:u.url)&&((l=c.peerMetadata)==null?void 0:l.url)===t.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async t=>{const{topic:s,expirerHasDeleted:o=!1,emitEvent:c=!0,id:u=0}=t,{self:l}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,bt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(l.publicKey)&&await this.client.core.crypto.deleteKeyPair(l.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),o||this.client.core.expirer.del(s),this.client.core.storage.removeItem(dd).catch(y=>this.client.logger.warn(y)),this.getPendingSessionRequests().forEach(y=>{y.topic===s&&this.deletePendingSessionRequest(y.id,bt("USER_DISCONNECTED"))}),c&&this.client.events.emit("session_delete",{id:u,topic:s})},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,bt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),o&&(this.sessionRequestQueue.state=dn.idle,this.client.events.emit("session_request_expire",{id:t}))},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,Or(ln.wc_sessionPropose.req.ttl))},this.setPendingSessionRequest=async t=>{const{id:s,topic:o,params:c,verifyContext:u}=t,l=c.request.expiryTimestamp||Or(ln.wc_sessionRequest.req.ttl);await this.client.pendingRequest.set(s,{id:s,topic:o,params:c,verifyContext:u}),l&&this.client.core.expirer.set(s,l)},this.sendRequest=async t=>{const{topic:s,method:o,params:c,expiry:u,relayRpcId:l,clientRpcId:y,throwOnFailedPublish:p}=t,_=Oi(o,c,y);if(Si()&&B3.includes(o)){const P=Ei(JSON.stringify(_));this.client.core.verify.register({attestationId:P})}const D=await this.client.core.crypto.encode(s,_),S=ln[o].req;return u&&(S.ttl=u),l&&(S.id=l),this.client.core.history.set(s,_),p?(S.internal=Ai(ur({},S.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,D,S)):this.client.core.relayer.publish(s,D,S).catch(P=>this.client.logger.error(P)),_.id},this.sendResult=async t=>{const{id:s,topic:o,result:c,throwOnFailedPublish:u}=t,l=so(s,c),y=await this.client.core.crypto.encode(o,l),p=await this.client.core.history.get(o,s),_=ln[p.request.method].res;u?(_.internal=Ai(ur({},_.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,y,_)):this.client.core.relayer.publish(o,y,_).catch(D=>this.client.logger.error(D)),await this.client.core.history.resolve(l)},this.sendError=async(t,s,o)=>{const c=oo(t,o),u=await this.client.core.crypto.encode(s,c),l=await this.client.core.history.get(s,t),y=ln[l.request.method].res;this.client.core.relayer.publish(s,u,y),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{let c=!1;Pn(o.expiry)&&(c=!0),this.client.core.crypto.keychain.has(o.topic)||(c=!0),c&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Pn(o.expiryTimestamp)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession({topic:o})),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===dn.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=dn.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=dn.idle},this.processRequest=t=>{const{topic:s,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:o}=ce("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(ur({},s.params));const u=o.expiryTimestamp||Or(ln.wc_sessionPropose.req.ttl),l=ur({id:c,pairingTopic:t,expiryTimestamp:u},o);await this.setProposal(c,l);const y=Ei(JSON.stringify(s)),p=await this.getVerifyContext(y,l.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:l,verifyContext:p})}catch(u){await this.sendError(c,t,u),this.client.logger.error(u)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(un(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const u=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:u});const l=u.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:l});const y=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:y});const p=await this.client.core.crypto.generateSharedKey(l,y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const _=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:_}),await this.client.core.pairing.activate({topic:t})}else Kr(s)&&(await this.client.proposal.delete(o,bt("USER_DISCONNECTED")),this.events.emit(Tt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:u,controller:l,expiry:y,namespaces:p,sessionProperties:_,pairingTopic:D}=s.params,S=ur({topic:t,relay:u,expiry:y,namespaces:p,acknowledged:!0,pairingTopic:D,requiredNamespaces:{},optionalNamespaces:{},controller:l.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:l.publicKey,metadata:l.metadata}},_&&{sessionProperties:_});await this.sendResult({id:s.id,topic:t,result:!0}),this.events.emit(Tt("session_connect"),{session:S}),this.cleanupDuplicatePairings(S)}catch(u){await this.sendError(o,t,u),this.client.logger.error(u)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;un(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Tt("session_approve",o),{})):Kr(s)&&(await this.client.session.delete(t,bt("USER_DISCONNECTED")),this.events.emit(Tt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:c}=s;try{const u=`${t}_session_update`,l=io.get(u);if(l&&this.isRequestOutOfSync(l,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(ur({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:o}),io.set(u,c)}catch(u){await this.sendError(c,t,u),this.client.logger.error(u)}},this.isRequestOutOfSync=(t,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;un(s)?this.events.emit(Tt("session_update",o),{}):Kr(s)&&this.events.emit(Tt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Or(ho)),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;un(s)?this.events.emit(Tt("session_extend",o),{}):Kr(s)&&this.events.emit(Tt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{un(s)?this.events.emit(Tt("session_ping",o),{}):Kr(s)&&this.events.emit(Tt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(tr.publish,async()=>{c(await this.deleteSession({topic:t,id:o}))})}),this.sendResult({id:o,topic:t,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:bt("USER_DISCONNECTED")})])}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(ur({topic:t},c));const u=Ei(JSON.stringify(Oi("wc_sessionRequest",c,o))),l=this.client.session.get(t),y=await this.getVerifyContext(u,l.peer.metadata),p={id:o,topic:t,params:c,verifyContext:y};await this.setPendingSessionRequest(p),this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue()}catch(u){await this.sendError(o,t,u),this.client.logger.error(u)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;un(s)?this.events.emit(Tt("session_request",o),{result:s.result}):Kr(s)&&this.events.emit(Tt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:c}=s;try{const u=`${t}_session_event_${c.event.name}`,l=io.get(u);if(l&&this.isRequestOutOfSync(l,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(ur({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c}),io.set(u,o)}catch(u){await this.sendError(o,t,u),this.client.logger.error(u)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=dn.idle,this.processSessionRequestQueue()},_e.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:t,error:s})=>{const o=this.client.core.history.pending;o.length>0&&o.filter(c=>c.topic===t&&c.request.method==="wc_sessionRequest").forEach(c=>{this.events.emit(Tt("session_request",c.request.id),{error:s})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===dn.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=dn.active,this.client.events.emit("session_request",t)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=t=>{if(t.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===t.topic);s&&this.onSessionProposeRequest(t.topic,Oi("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async t=>{if(!vr(t)){const{message:y}=ce("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(y)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:u,relays:l}=t;if(ar(s)||await this.isValidPairingTopic(s),!Xw(l,!0)){const{message:y}=ce("MISSING_OR_INVALID",`connect() relays: ${l}`);throw new Error(y)}!ar(o)&&ls(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!ar(c)&&ls(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),ar(u)||this.validateSessionProps(u,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=Jw(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!vr(t))throw new Error(ce("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:u}=t;await this.isValidProposalId(s);const l=this.client.proposal.get(s),y=dc(o,"approve()");if(y)throw new Error(y.message);const p=fl(l.requiredNamespaces,o,"approve()");if(p)throw new Error(p.message);if(!Vt(c,!0)){const{message:_}=ce("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(_)}ar(u)||this.validateSessionProps(u,"sessionProperties")},this.isValidReject=async t=>{if(!vr(t)){const{message:c}=ce("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!Zw(o)){const{message:c}=ce("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!vr(t)){const{message:p}=ce("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(p)}const{relay:s,controller:o,namespaces:c,expiry:u}=t;if(!ul(s)){const{message:p}=ce("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const l=Kw(o,"onSessionSettleRequest()");if(l)throw new Error(l.message);const y=dc(c,"onSessionSettleRequest()");if(y)throw new Error(y.message);if(Pn(u)){const{message:p}=ce("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async t=>{if(!vr(t)){const{message:y}=ce("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(y)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const c=this.client.session.get(s),u=dc(o,"update()");if(u)throw new Error(u.message);const l=fl(c.requiredNamespaces,o,"update()");if(l)throw new Error(l.message)},this.isValidExtend=async t=>{if(!vr(t)){const{message:o}=ce("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!vr(t)){const{message:y}=ce("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(y)}const{topic:s,request:o,chainId:c,expiry:u}=t;await this.isValidSessionTopic(s);const{namespaces:l}=this.client.session.get(s);if(!hl(l,c)){const{message:y}=ce("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(y)}if(!em(o)){const{message:y}=ce("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(y)}if(!nm(l,c,o.method)){const{message:y}=ce("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(y)}if(u&&!am(u,Rc)){const{message:y}=ce("MISSING_OR_INVALID",`request() expiry: ${u}. Expiry must be a number (in seconds) between ${Rc.min} and ${Rc.max}`);throw new Error(y)}},this.isValidRespond=async t=>{var s;if(!vr(t)){const{message:u}=ce("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(u)}const{topic:o,response:c}=t;try{await this.isValidSessionTopic(o)}catch(u){throw(s=t?.response)!=null&&s.id&&this.cleanupAfterResponse(t),u}if(!tm(c)){const{message:u}=ce("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(u)}},this.isValidPing=async t=>{if(!vr(t)){const{message:o}=ce("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!vr(t)){const{message:l}=ce("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(l)}const{topic:s,event:o,chainId:c}=t;await this.isValidSessionTopic(s);const{namespaces:u}=this.client.session.get(s);if(!hl(u,c)){const{message:l}=ce("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(l)}if(!rm(o)){const{message:l}=ce("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(l)}if(!im(u,c,o.name)){const{message:l}=ce("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(l)}},this.isValidDisconnect=async t=>{if(!vr(t)){const{message:o}=ce("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||Pi,validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!Vt(o,!1)){const{message:c}=ce("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(tr.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);try{mc(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ao(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Lr.expired,async e=>{const{topic:t,id:s}=nl(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ce("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(_s.create,e=>this.onPairingCreated(e))}isValidPairingTopic(e){if(!Vt(e,!1)){const{message:t}=ce("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ce("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Pn(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ce("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Vt(e,!1)){const{message:t}=ce("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=ce("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Pn(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=ce("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=ce("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Vt(e,!1)){const{message:t}=ce("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=ce("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!Qw(e)){const{message:t}=ce("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ce("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Pn(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=ce("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class V3 extends uo{constructor(e,t){super(e,t,$3,Cc),this.core=e,this.logger=t}}class k3 extends uo{constructor(e,t){super(e,t,U3,Cc),this.core=e,this.logger=t}}class Y3 extends uo{constructor(e,t){super(e,t,q3,Cc,s=>s.id),this.core=e,this.logger=t}}class Nc extends Vy{constructor(e){super(e),this.protocol=hd,this.version=fd,this.name=Tc.name,this.events=new Zt.exports.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=e?.name||Tc.name,this.metadata=e?.metadata||dw();const t=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:ke.pino(ke.getDefaultLoggerOptions({level:e?.logger||Tc.logger}));this.core=e?.core||new F3(e),this.logger=ke.generateChildLogger(t,this.name),this.session=new k3(this.core,this.logger),this.proposal=new V3(this.core,this.logger),this.pendingRequest=new Y3(this.core,this.logger),this.engine=new G3(this)}static async init(e){const t=new Nc(e);return await t.initialize(),t}get context(){return ke.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const _d="error",J3="wss://relay.walletconnect.com",X3="wc",Q3="universal_provider",vd=`${X3}@2:${Q3}:`,Z3="https://rpc.walletconnect.com/v1/",pn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Lc={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(r,e){(function(){var t,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",l="Invalid `variable` option passed into `_.template`",y="__lodash_hash_undefined__",p=500,_="__lodash_placeholder__",D=1,S=2,P=4,I=1,B=2,z=1,ne=2,L=4,M=8,A=16,T=32,E=64,h=128,m=256,V=512,Y=30,se="...",ue=800,de=16,b=1,C=2,ee=3,X=1/0,W=9007199254740991,G=17976931348623157e292,J=0/0,re=4294967295,me=re-1,oe=re>>>1,be=[["ary",h],["bind",z],["bindKey",ne],["curry",M],["curryRight",A],["flip",V],["partial",T],["partialRight",E],["rearg",m]],fe="[object Arguments]",ve="[object Array]",j="[object AsyncFunction]",H="[object Boolean]",F="[object Date]",d="[object DOMException]",R="[object Error]",ae="[object Function]",le="[object GeneratorFunction]",xe="[object Map]",je="[object Number]",We="[object Null]",Ue="[object Object]",yt="[object Promise]",_t="[object Proxy]",qe="[object RegExp]",Ie="[object Set]",Le="[object String]",Fe="[object Symbol]",Be="[object Undefined]",Pe="[object WeakMap]",$e="[object WeakSet]",Se="[object ArrayBuffer]",Ae="[object DataView]",ze="[object Float32Array]",Oe="[object Float64Array]",Ge="[object Int8Array]",Ye="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Xe="[object Uint8ClampedArray]",hr="[object Uint16Array]",wr="[object Uint32Array]",en=/\b__p \+= '';/g,fr=/\b(__p \+=) '' \+/g,gn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Rn=/&(?:amp|lt|gt|quot|#39);/g,ni=/[&<>"']/g,St=RegExp(Rn.source),vt=RegExp(ni.source),xt=/<%-([\s\S]+?)%>/g,It=/<%([\s\S]+?)%>/g,Et=/<%=([\s\S]+?)%>/g,wt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ut=/^\w*$/,Mt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ot=/[\\^$.*+?()[\]{}|]/g,qt=RegExp(Ot.source),Pt=/^\s+/,Rt=/\s/,At=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,lt=/\{\n\/\* \[wrapped with (.+)\] \*/,Bt=/,? & /,Ht=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,qc=/[()=,{}\[\]\/\s]/,Bc=/\\(\\)?/g,Hc=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Fr=/\w*$/,jc=/^[-+]0x[0-9a-f]+$/i,zc=/^0b[01]+$/i,Kc=/^\[object .+?Constructor\]$/,Wc=/^0o[0-7]+$/i,Gc=/^(?:0|[1-9]\d*)$/,yn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ci=/($^)/,Vc=/['\n\r\u2028\u2029\\]/g,Ti="\\ud800-\\udfff",kc="\\u0300-\\u036f",Yc="\\ufe20-\\ufe2f",Ri="\\u20d0-\\u20ff",go=kc+Yc+Ri,yo="\\u2700-\\u27bf",Gr="a-z\\xdf-\\xf6\\xf8-\\xff",Jc="\\xac\\xb1\\xd7\\xf7",Xc="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Qc="\\u2000-\\u206f",Zc=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",_o="A-Z\\xc0-\\xd6\\xd8-\\xde",vo="\\ufe0e\\ufe0f",ii=Jc+Xc+Qc+Zc,ws="['\u2019]",si="["+Ti+"]",ms="["+ii+"]",oi="["+go+"]",wo="\\d+",eu="["+yo+"]",mo="["+Gr+"]",bo="[^"+Ti+ii+wo+yo+Gr+_o+"]",Ni="\\ud83c[\\udffb-\\udfff]",tu="(?:"+oi+"|"+Ni+")",Eo="[^"+Ti+"]",Li="(?:\\ud83c[\\udde6-\\uddff]){2}",Nn="[\\ud800-\\udbff][\\udc00-\\udfff]",Pr="["+_o+"]",Do="\\u200d",So="(?:"+mo+"|"+bo+")",tn="(?:"+Pr+"|"+bo+")",xo="(?:"+ws+"(?:d|ll|m|re|s|t|ve))?",Io="(?:"+ws+"(?:D|LL|M|RE|S|T|VE))?",Oo=tu+"?",Po="["+vo+"]?",ru="(?:"+Do+"(?:"+[Eo,Li,Nn].join("|")+")"+Po+Oo+")*",_n="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ao="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Co=Po+Oo+ru,Fi="(?:"+[eu,Li,Nn].join("|")+")"+Co,nu="(?:"+[Eo+oi+"?",oi,Li,Nn,si].join("|")+")",bs=RegExp(ws,"g"),iu=RegExp(oi,"g"),$i=RegExp(Ni+"(?="+Ni+")|"+nu+Co,"g"),To=RegExp([Pr+"?"+mo+"+"+xo+"(?="+[ms,Pr,"$"].join("|")+")",tn+"+"+Io+"(?="+[ms,Pr+So,"$"].join("|")+")",Pr+"?"+So+"+"+xo,Pr+"+"+Io,Ao,_n,wo,Fi].join("|"),"g"),Ro=RegExp("["+Do+Ti+go+vo+"]"),ai=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,No=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],su=-1,at={};at[ze]=at[Oe]=at[Ge]=at[Ye]=at[et]=at[tt]=at[Xe]=at[hr]=at[wr]=!0,at[fe]=at[ve]=at[Se]=at[H]=at[Ae]=at[F]=at[R]=at[ae]=at[xe]=at[je]=at[Ue]=at[qe]=at[Ie]=at[Le]=at[Pe]=!1;var ot={};ot[fe]=ot[ve]=ot[Se]=ot[Ae]=ot[H]=ot[F]=ot[ze]=ot[Oe]=ot[Ge]=ot[Ye]=ot[et]=ot[xe]=ot[je]=ot[Ue]=ot[qe]=ot[Ie]=ot[Le]=ot[Fe]=ot[tt]=ot[Xe]=ot[hr]=ot[wr]=!0,ot[R]=ot[ae]=ot[Pe]=!1;var x={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},U={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},te={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ct=parseFloat,Te=parseInt,dt=typeof $t=="object"&&$t&&$t.Object===Object&&$t,jt=typeof self=="object"&&self&&self.Object===Object&&self,Qe=dt||jt||Function("return this")(),ut=e&&!e.nodeType&&e,Nt=ut&&!0&&r&&!r.nodeType&&r,mr=Nt&&Nt.exports===ut,zt=mr&&dt.process,pt=function(){try{var $=Nt&&Nt.require&&Nt.require("util").types;return $||zt&&zt.binding&&zt.binding("util")}catch{}}(),lr=pt&&pt.isArrayBuffer,Vr=pt&&pt.isDate,$r=pt&&pt.isMap,rn=pt&&pt.isRegExp,Es=pt&&pt.isSet,ci=pt&&pt.isTypedArray;function kt($,k,K){switch(K.length){case 0:return $.call(k);case 1:return $.call(k,K[0]);case 2:return $.call(k,K[0],K[1]);case 3:return $.call(k,K[0],K[1],K[2])}return $.apply(k,K)}function D2($,k,K,ge){for(var Ce=-1,rt=$==null?0:$.length;++Ce<rt;){var Kt=$[Ce];k(ge,Kt,K(Kt),$)}return ge}function Ur($,k){for(var K=-1,ge=$==null?0:$.length;++K<ge&&k($[K],K,$)!==!1;);return $}function S2($,k){for(var K=$==null?0:$.length;K--&&k($[K],K,$)!==!1;);return $}function Cd($,k){for(var K=-1,ge=$==null?0:$.length;++K<ge;)if(!k($[K],K,$))return!1;return!0}function Ln($,k){for(var K=-1,ge=$==null?0:$.length,Ce=0,rt=[];++K<ge;){var Kt=$[K];k(Kt,K,$)&&(rt[Ce++]=Kt)}return rt}function Lo($,k){var K=$==null?0:$.length;return!!K&&Ui($,k,0)>-1}function ou($,k,K){for(var ge=-1,Ce=$==null?0:$.length;++ge<Ce;)if(K(k,$[ge]))return!0;return!1}function mt($,k){for(var K=-1,ge=$==null?0:$.length,Ce=Array(ge);++K<ge;)Ce[K]=k($[K],K,$);return Ce}function Fn($,k){for(var K=-1,ge=k.length,Ce=$.length;++K<ge;)$[Ce+K]=k[K];return $}function au($,k,K,ge){var Ce=-1,rt=$==null?0:$.length;for(ge&&rt&&(K=$[++Ce]);++Ce<rt;)K=k(K,$[Ce],Ce,$);return K}function x2($,k,K,ge){var Ce=$==null?0:$.length;for(ge&&Ce&&(K=$[--Ce]);Ce--;)K=k(K,$[Ce],Ce,$);return K}function cu($,k){for(var K=-1,ge=$==null?0:$.length;++K<ge;)if(k($[K],K,$))return!0;return!1}var I2=uu("length");function O2($){return $.split("")}function P2($){return $.match(Ht)||[]}function Td($,k,K){var ge;return K($,function(Ce,rt,Kt){if(k(Ce,rt,Kt))return ge=rt,!1}),ge}function Fo($,k,K,ge){for(var Ce=$.length,rt=K+(ge?1:-1);ge?rt--:++rt<Ce;)if(k($[rt],rt,$))return rt;return-1}function Ui($,k,K){return k===k?B2($,k,K):Fo($,Rd,K)}function A2($,k,K,ge){for(var Ce=K-1,rt=$.length;++Ce<rt;)if(ge($[Ce],k))return Ce;return-1}function Rd($){return $!==$}function Nd($,k){var K=$==null?0:$.length;return K?fu($,k)/K:J}function uu($){return function(k){return k==null?t:k[$]}}function hu($){return function(k){return $==null?t:$[k]}}function Ld($,k,K,ge,Ce){return Ce($,function(rt,Kt,ht){K=ge?(ge=!1,rt):k(K,rt,Kt,ht)}),K}function C2($,k){var K=$.length;for($.sort(k);K--;)$[K]=$[K].value;return $}function fu($,k){for(var K,ge=-1,Ce=$.length;++ge<Ce;){var rt=k($[ge]);rt!==t&&(K=K===t?rt:K+rt)}return K}function lu($,k){for(var K=-1,ge=Array($);++K<$;)ge[K]=k(K);return ge}function T2($,k){return mt(k,function(K){return[K,$[K]]})}function Fd($){return $&&$.slice(0,qd($)+1).replace(Pt,"")}function Ar($){return function(k){return $(k)}}function du($,k){return mt(k,function(K){return $[K]})}function Ds($,k){return $.has(k)}function $d($,k){for(var K=-1,ge=$.length;++K<ge&&Ui(k,$[K],0)>-1;);return K}function Ud($,k){for(var K=$.length;K--&&Ui(k,$[K],0)>-1;);return K}function R2($,k){for(var K=$.length,ge=0;K--;)$[K]===k&&++ge;return ge}var N2=hu(x),L2=hu(U);function F2($){return"\\"+pe[$]}function $2($,k){return $==null?t:$[k]}function Mi($){return Ro.test($)}function U2($){return ai.test($)}function M2($){for(var k,K=[];!(k=$.next()).done;)K.push(k.value);return K}function pu($){var k=-1,K=Array($.size);return $.forEach(function(ge,Ce){K[++k]=[Ce,ge]}),K}function Md($,k){return function(K){return $(k(K))}}function $n($,k){for(var K=-1,ge=$.length,Ce=0,rt=[];++K<ge;){var Kt=$[K];(Kt===k||Kt===_)&&($[K]=_,rt[Ce++]=K)}return rt}function $o($){var k=-1,K=Array($.size);return $.forEach(function(ge){K[++k]=ge}),K}function q2($){var k=-1,K=Array($.size);return $.forEach(function(ge){K[++k]=[ge,ge]}),K}function B2($,k,K){for(var ge=K-1,Ce=$.length;++ge<Ce;)if($[ge]===k)return ge;return-1}function H2($,k,K){for(var ge=K+1;ge--;)if($[ge]===k)return ge;return ge}function qi($){return Mi($)?z2($):I2($)}function kr($){return Mi($)?K2($):O2($)}function qd($){for(var k=$.length;k--&&Rt.test($.charAt(k)););return k}var j2=hu(te);function z2($){for(var k=$i.lastIndex=0;$i.test($);)++k;return k}function K2($){return $.match($i)||[]}function W2($){return $.match(To)||[]}var G2=function $(k){k=k==null?Qe:Bi.defaults(Qe.Object(),k,Bi.pick(Qe,No));var K=k.Array,ge=k.Date,Ce=k.Error,rt=k.Function,Kt=k.Math,ht=k.Object,gu=k.RegExp,V2=k.String,Mr=k.TypeError,Uo=K.prototype,k2=rt.prototype,Hi=ht.prototype,Mo=k["__core-js_shared__"],qo=k2.toString,it=Hi.hasOwnProperty,Y2=0,Bd=function(){var n=/[^.]+$/.exec(Mo&&Mo.keys&&Mo.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),Bo=Hi.toString,J2=qo.call(ht),X2=Qe._,Q2=gu("^"+qo.call(it).replace(Ot,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ho=mr?k.Buffer:t,Un=k.Symbol,jo=k.Uint8Array,Hd=Ho?Ho.allocUnsafe:t,zo=Md(ht.getPrototypeOf,ht),jd=ht.create,zd=Hi.propertyIsEnumerable,Ko=Uo.splice,Kd=Un?Un.isConcatSpreadable:t,Ss=Un?Un.iterator:t,ui=Un?Un.toStringTag:t,Wo=function(){try{var n=pi(ht,"defineProperty");return n({},"",{}),n}catch{}}(),Z2=k.clearTimeout!==Qe.clearTimeout&&k.clearTimeout,eD=ge&&ge.now!==Qe.Date.now&&ge.now,tD=k.setTimeout!==Qe.setTimeout&&k.setTimeout,Go=Kt.ceil,Vo=Kt.floor,yu=ht.getOwnPropertySymbols,rD=Ho?Ho.isBuffer:t,Wd=k.isFinite,nD=Uo.join,iD=Md(ht.keys,ht),Wt=Kt.max,rr=Kt.min,sD=ge.now,oD=k.parseInt,Gd=Kt.random,aD=Uo.reverse,_u=pi(k,"DataView"),xs=pi(k,"Map"),vu=pi(k,"Promise"),ji=pi(k,"Set"),Is=pi(k,"WeakMap"),Os=pi(ht,"create"),ko=Is&&new Is,zi={},cD=gi(_u),uD=gi(xs),hD=gi(vu),fD=gi(ji),lD=gi(Is),Yo=Un?Un.prototype:t,Ps=Yo?Yo.valueOf:t,Vd=Yo?Yo.toString:t;function v(n){if(Ct(n)&&!Re(n)&&!(n instanceof Je)){if(n instanceof qr)return n;if(it.call(n,"__wrapped__"))return kp(n)}return new qr(n)}var Ki=function(){function n(){}return function(i){if(!Dt(i))return{};if(jd)return jd(i);n.prototype=i;var a=new n;return n.prototype=t,a}}();function Jo(){}function qr(n,i){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=t}v.templateSettings={escape:xt,evaluate:It,interpolate:Et,variable:"",imports:{_:v}},v.prototype=Jo.prototype,v.prototype.constructor=v,qr.prototype=Ki(Jo.prototype),qr.prototype.constructor=qr;function Je(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function dD(){var n=new Je(this.__wrapped__);return n.__actions__=br(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=br(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=br(this.__views__),n}function pD(){if(this.__filtered__){var n=new Je(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}function gD(){var n=this.__wrapped__.value(),i=this.__dir__,a=Re(n),f=i<0,g=a?n.length:0,w=O6(0,g,this.__views__),O=w.start,N=w.end,q=N-O,Q=f?N:O-1,Z=this.__iteratees__,ie=Z.length,he=0,ye=rr(q,this.__takeCount__);if(!a||!f&&g==q&&ye==q)return _p(n,this.__actions__);var Ee=[];e:for(;q--&&he<ye;){Q+=i;for(var He=-1,De=n[Q];++He<ie;){var Ve=Z[He],Ze=Ve.iteratee,Rr=Ve.type,gr=Ze(De);if(Rr==C)De=gr;else if(!gr){if(Rr==b)continue e;break e}}Ee[he++]=De}return Ee}Je.prototype=Ki(Jo.prototype),Je.prototype.constructor=Je;function hi(n){var i=-1,a=n==null?0:n.length;for(this.clear();++i<a;){var f=n[i];this.set(f[0],f[1])}}function yD(){this.__data__=Os?Os(null):{},this.size=0}function _D(n){var i=this.has(n)&&delete this.__data__[n];return this.size-=i?1:0,i}function vD(n){var i=this.__data__;if(Os){var a=i[n];return a===y?t:a}return it.call(i,n)?i[n]:t}function wD(n){var i=this.__data__;return Os?i[n]!==t:it.call(i,n)}function mD(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=Os&&i===t?y:i,this}hi.prototype.clear=yD,hi.prototype.delete=_D,hi.prototype.get=vD,hi.prototype.has=wD,hi.prototype.set=mD;function vn(n){var i=-1,a=n==null?0:n.length;for(this.clear();++i<a;){var f=n[i];this.set(f[0],f[1])}}function bD(){this.__data__=[],this.size=0}function ED(n){var i=this.__data__,a=Xo(i,n);if(a<0)return!1;var f=i.length-1;return a==f?i.pop():Ko.call(i,a,1),--this.size,!0}function DD(n){var i=this.__data__,a=Xo(i,n);return a<0?t:i[a][1]}function SD(n){return Xo(this.__data__,n)>-1}function xD(n,i){var a=this.__data__,f=Xo(a,n);return f<0?(++this.size,a.push([n,i])):a[f][1]=i,this}vn.prototype.clear=bD,vn.prototype.delete=ED,vn.prototype.get=DD,vn.prototype.has=SD,vn.prototype.set=xD;function wn(n){var i=-1,a=n==null?0:n.length;for(this.clear();++i<a;){var f=n[i];this.set(f[0],f[1])}}function ID(){this.size=0,this.__data__={hash:new hi,map:new(xs||vn),string:new hi}}function OD(n){var i=ua(this,n).delete(n);return this.size-=i?1:0,i}function PD(n){return ua(this,n).get(n)}function AD(n){return ua(this,n).has(n)}function CD(n,i){var a=ua(this,n),f=a.size;return a.set(n,i),this.size+=a.size==f?0:1,this}wn.prototype.clear=ID,wn.prototype.delete=OD,wn.prototype.get=PD,wn.prototype.has=AD,wn.prototype.set=CD;function fi(n){var i=-1,a=n==null?0:n.length;for(this.__data__=new wn;++i<a;)this.add(n[i])}function TD(n){return this.__data__.set(n,y),this}function RD(n){return this.__data__.has(n)}fi.prototype.add=fi.prototype.push=TD,fi.prototype.has=RD;function Yr(n){var i=this.__data__=new vn(n);this.size=i.size}function ND(){this.__data__=new vn,this.size=0}function LD(n){var i=this.__data__,a=i.delete(n);return this.size=i.size,a}function FD(n){return this.__data__.get(n)}function $D(n){return this.__data__.has(n)}function UD(n,i){var a=this.__data__;if(a instanceof vn){var f=a.__data__;if(!xs||f.length<o-1)return f.push([n,i]),this.size=++a.size,this;a=this.__data__=new wn(f)}return a.set(n,i),this.size=a.size,this}Yr.prototype.clear=ND,Yr.prototype.delete=LD,Yr.prototype.get=FD,Yr.prototype.has=$D,Yr.prototype.set=UD;function kd(n,i){var a=Re(n),f=!a&&yi(n),g=!a&&!f&&jn(n),w=!a&&!f&&!g&&ki(n),O=a||f||g||w,N=O?lu(n.length,V2):[],q=N.length;for(var Q in n)(i||it.call(n,Q))&&!(O&&(Q=="length"||g&&(Q=="offset"||Q=="parent")||w&&(Q=="buffer"||Q=="byteLength"||Q=="byteOffset")||Dn(Q,q)))&&N.push(Q);return N}function Yd(n){var i=n.length;return i?n[Au(0,i-1)]:t}function MD(n,i){return ha(br(n),li(i,0,n.length))}function qD(n){return ha(br(n))}function wu(n,i,a){(a!==t&&!Jr(n[i],a)||a===t&&!(i in n))&&mn(n,i,a)}function As(n,i,a){var f=n[i];(!(it.call(n,i)&&Jr(f,a))||a===t&&!(i in n))&&mn(n,i,a)}function Xo(n,i){for(var a=n.length;a--;)if(Jr(n[a][0],i))return a;return-1}function BD(n,i,a,f){return Mn(n,function(g,w,O){i(f,g,a(g),O)}),f}function Jd(n,i){return n&&sn(i,Yt(i),n)}function HD(n,i){return n&&sn(i,Dr(i),n)}function mn(n,i,a){i=="__proto__"&&Wo?Wo(n,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):n[i]=a}function mu(n,i){for(var a=-1,f=i.length,g=K(f),w=n==null;++a<f;)g[a]=w?t:eh(n,i[a]);return g}function li(n,i,a){return n===n&&(a!==t&&(n=n<=a?n:a),i!==t&&(n=n>=i?n:i)),n}function Br(n,i,a,f,g,w){var O,N=i&D,q=i&S,Q=i&P;if(a&&(O=g?a(n,f,g,w):a(n)),O!==t)return O;if(!Dt(n))return n;var Z=Re(n);if(Z){if(O=A6(n),!N)return br(n,O)}else{var ie=nr(n),he=ie==ae||ie==le;if(jn(n))return mp(n,N);if(ie==Ue||ie==fe||he&&!g){if(O=q||he?{}:qp(n),!N)return q?v6(n,HD(O,n)):_6(n,Jd(O,n))}else{if(!ot[ie])return g?n:{};O=C6(n,ie,N)}}w||(w=new Yr);var ye=w.get(n);if(ye)return ye;w.set(n,O),pg(n)?n.forEach(function(De){O.add(Br(De,i,a,De,n,w))}):lg(n)&&n.forEach(function(De,Ve){O.set(Ve,Br(De,i,a,Ve,n,w))});var Ee=Q?q?Bu:qu:q?Dr:Yt,He=Z?t:Ee(n);return Ur(He||n,function(De,Ve){He&&(Ve=De,De=n[Ve]),As(O,Ve,Br(De,i,a,Ve,n,w))}),O}function jD(n){var i=Yt(n);return function(a){return Xd(a,n,i)}}function Xd(n,i,a){var f=a.length;if(n==null)return!f;for(n=ht(n);f--;){var g=a[f],w=i[g],O=n[g];if(O===t&&!(g in n)||!w(O))return!1}return!0}function Qd(n,i,a){if(typeof n!="function")throw new Mr(u);return $s(function(){n.apply(t,a)},i)}function Cs(n,i,a,f){var g=-1,w=Lo,O=!0,N=n.length,q=[],Q=i.length;if(!N)return q;a&&(i=mt(i,Ar(a))),f?(w=ou,O=!1):i.length>=o&&(w=Ds,O=!1,i=new fi(i));e:for(;++g<N;){var Z=n[g],ie=a==null?Z:a(Z);if(Z=f||Z!==0?Z:0,O&&ie===ie){for(var he=Q;he--;)if(i[he]===ie)continue e;q.push(Z)}else w(i,ie,f)||q.push(Z)}return q}var Mn=xp(nn),Zd=xp(Eu,!0);function zD(n,i){var a=!0;return Mn(n,function(f,g,w){return a=!!i(f,g,w),a}),a}function Qo(n,i,a){for(var f=-1,g=n.length;++f<g;){var w=n[f],O=i(w);if(O!=null&&(N===t?O===O&&!Tr(O):a(O,N)))var N=O,q=w}return q}function KD(n,i,a,f){var g=n.length;for(a=Me(a),a<0&&(a=-a>g?0:g+a),f=f===t||f>g?g:Me(f),f<0&&(f+=g),f=a>f?0:yg(f);a<f;)n[a++]=i;return n}function ep(n,i){var a=[];return Mn(n,function(f,g,w){i(f,g,w)&&a.push(f)}),a}function Qt(n,i,a,f,g){var w=-1,O=n.length;for(a||(a=R6),g||(g=[]);++w<O;){var N=n[w];i>0&&a(N)?i>1?Qt(N,i-1,a,f,g):Fn(g,N):f||(g[g.length]=N)}return g}var bu=Ip(),tp=Ip(!0);function nn(n,i){return n&&bu(n,i,Yt)}function Eu(n,i){return n&&tp(n,i,Yt)}function Zo(n,i){return Ln(i,function(a){return Sn(n[a])})}function di(n,i){i=Bn(i,n);for(var a=0,f=i.length;n!=null&&a<f;)n=n[on(i[a++])];return a&&a==f?n:t}function rp(n,i,a){var f=i(n);return Re(n)?f:Fn(f,a(n))}function dr(n){return n==null?n===t?Be:We:ui&&ui in ht(n)?I6(n):q6(n)}function Du(n,i){return n>i}function WD(n,i){return n!=null&&it.call(n,i)}function GD(n,i){return n!=null&&i in ht(n)}function VD(n,i,a){return n>=rr(i,a)&&n<Wt(i,a)}function Su(n,i,a){for(var f=a?ou:Lo,g=n[0].length,w=n.length,O=w,N=K(w),q=1/0,Q=[];O--;){var Z=n[O];O&&i&&(Z=mt(Z,Ar(i))),q=rr(Z.length,q),N[O]=!a&&(i||g>=120&&Z.length>=120)?new fi(O&&Z):t}Z=n[0];var ie=-1,he=N[0];e:for(;++ie<g&&Q.length<q;){var ye=Z[ie],Ee=i?i(ye):ye;if(ye=a||ye!==0?ye:0,!(he?Ds(he,Ee):f(Q,Ee,a))){for(O=w;--O;){var He=N[O];if(!(He?Ds(He,Ee):f(n[O],Ee,a)))continue e}he&&he.push(Ee),Q.push(ye)}}return Q}function kD(n,i,a,f){return nn(n,function(g,w,O){i(f,a(g),w,O)}),f}function Ts(n,i,a){i=Bn(i,n),n=zp(n,i);var f=n==null?n:n[on(jr(i))];return f==null?t:kt(f,n,a)}function np(n){return Ct(n)&&dr(n)==fe}function YD(n){return Ct(n)&&dr(n)==Se}function JD(n){return Ct(n)&&dr(n)==F}function Rs(n,i,a,f,g){return n===i?!0:n==null||i==null||!Ct(n)&&!Ct(i)?n!==n&&i!==i:XD(n,i,a,f,Rs,g)}function XD(n,i,a,f,g,w){var O=Re(n),N=Re(i),q=O?ve:nr(n),Q=N?ve:nr(i);q=q==fe?Ue:q,Q=Q==fe?Ue:Q;var Z=q==Ue,ie=Q==Ue,he=q==Q;if(he&&jn(n)){if(!jn(i))return!1;O=!0,Z=!1}if(he&&!Z)return w||(w=new Yr),O||ki(n)?$p(n,i,a,f,g,w):S6(n,i,q,a,f,g,w);if(!(a&I)){var ye=Z&&it.call(n,"__wrapped__"),Ee=ie&&it.call(i,"__wrapped__");if(ye||Ee){var He=ye?n.value():n,De=Ee?i.value():i;return w||(w=new Yr),g(He,De,a,f,w)}}return he?(w||(w=new Yr),x6(n,i,a,f,g,w)):!1}function QD(n){return Ct(n)&&nr(n)==xe}function xu(n,i,a,f){var g=a.length,w=g,O=!f;if(n==null)return!w;for(n=ht(n);g--;){var N=a[g];if(O&&N[2]?N[1]!==n[N[0]]:!(N[0]in n))return!1}for(;++g<w;){N=a[g];var q=N[0],Q=n[q],Z=N[1];if(O&&N[2]){if(Q===t&&!(q in n))return!1}else{var ie=new Yr;if(f)var he=f(Q,Z,q,n,i,ie);if(!(he===t?Rs(Z,Q,I|B,f,ie):he))return!1}}return!0}function ip(n){if(!Dt(n)||L6(n))return!1;var i=Sn(n)?Q2:Kc;return i.test(gi(n))}function ZD(n){return Ct(n)&&dr(n)==qe}function e6(n){return Ct(n)&&nr(n)==Ie}function t6(n){return Ct(n)&&ya(n.length)&&!!at[dr(n)]}function sp(n){return typeof n=="function"?n:n==null?Sr:typeof n=="object"?Re(n)?cp(n[0],n[1]):ap(n):Og(n)}function Iu(n){if(!Fs(n))return iD(n);var i=[];for(var a in ht(n))it.call(n,a)&&a!="constructor"&&i.push(a);return i}function r6(n){if(!Dt(n))return M6(n);var i=Fs(n),a=[];for(var f in n)f=="constructor"&&(i||!it.call(n,f))||a.push(f);return a}function Ou(n,i){return n<i}function op(n,i){var a=-1,f=Er(n)?K(n.length):[];return Mn(n,function(g,w,O){f[++a]=i(g,w,O)}),f}function ap(n){var i=ju(n);return i.length==1&&i[0][2]?Hp(i[0][0],i[0][1]):function(a){return a===n||xu(a,n,i)}}function cp(n,i){return Ku(n)&&Bp(i)?Hp(on(n),i):function(a){var f=eh(a,n);return f===t&&f===i?th(a,n):Rs(i,f,I|B)}}function ea(n,i,a,f,g){n!==i&&bu(i,function(w,O){if(g||(g=new Yr),Dt(w))n6(n,i,O,a,ea,f,g);else{var N=f?f(Gu(n,O),w,O+"",n,i,g):t;N===t&&(N=w),wu(n,O,N)}},Dr)}function n6(n,i,a,f,g,w,O){var N=Gu(n,a),q=Gu(i,a),Q=O.get(q);if(Q){wu(n,a,Q);return}var Z=w?w(N,q,a+"",n,i,O):t,ie=Z===t;if(ie){var he=Re(q),ye=!he&&jn(q),Ee=!he&&!ye&&ki(q);Z=q,he||ye||Ee?Re(N)?Z=N:Lt(N)?Z=br(N):ye?(ie=!1,Z=mp(q,!0)):Ee?(ie=!1,Z=bp(q,!0)):Z=[]:Us(q)||yi(q)?(Z=N,yi(N)?Z=_g(N):(!Dt(N)||Sn(N))&&(Z=qp(q))):ie=!1}ie&&(O.set(q,Z),g(Z,q,f,w,O),O.delete(q)),wu(n,a,Z)}function up(n,i){var a=n.length;if(a)return i+=i<0?a:0,Dn(i,a)?n[i]:t}function hp(n,i,a){i.length?i=mt(i,function(w){return Re(w)?function(O){return di(O,w.length===1?w[0]:w)}:w}):i=[Sr];var f=-1;i=mt(i,Ar(we()));var g=op(n,function(w,O,N){var q=mt(i,function(Q){return Q(w)});return{criteria:q,index:++f,value:w}});return C2(g,function(w,O){return y6(w,O,a)})}function i6(n,i){return fp(n,i,function(a,f){return th(n,f)})}function fp(n,i,a){for(var f=-1,g=i.length,w={};++f<g;){var O=i[f],N=di(n,O);a(N,O)&&Ns(w,Bn(O,n),N)}return w}function s6(n){return function(i){return di(i,n)}}function Pu(n,i,a,f){var g=f?A2:Ui,w=-1,O=i.length,N=n;for(n===i&&(i=br(i)),a&&(N=mt(n,Ar(a)));++w<O;)for(var q=0,Q=i[w],Z=a?a(Q):Q;(q=g(N,Z,q,f))>-1;)N!==n&&Ko.call(N,q,1),Ko.call(n,q,1);return n}function lp(n,i){for(var a=n?i.length:0,f=a-1;a--;){var g=i[a];if(a==f||g!==w){var w=g;Dn(g)?Ko.call(n,g,1):Ru(n,g)}}return n}function Au(n,i){return n+Vo(Gd()*(i-n+1))}function o6(n,i,a,f){for(var g=-1,w=Wt(Go((i-n)/(a||1)),0),O=K(w);w--;)O[f?w:++g]=n,n+=a;return O}function Cu(n,i){var a="";if(!n||i<1||i>W)return a;do i%2&&(a+=n),i=Vo(i/2),i&&(n+=n);while(i);return a}function Ke(n,i){return Vu(jp(n,i,Sr),n+"")}function a6(n){return Yd(Yi(n))}function c6(n,i){var a=Yi(n);return ha(a,li(i,0,a.length))}function Ns(n,i,a,f){if(!Dt(n))return n;i=Bn(i,n);for(var g=-1,w=i.length,O=w-1,N=n;N!=null&&++g<w;){var q=on(i[g]),Q=a;if(q==="__proto__"||q==="constructor"||q==="prototype")return n;if(g!=O){var Z=N[q];Q=f?f(Z,q,N):t,Q===t&&(Q=Dt(Z)?Z:Dn(i[g+1])?[]:{})}As(N,q,Q),N=N[q]}return n}var dp=ko?function(n,i){return ko.set(n,i),n}:Sr,u6=Wo?function(n,i){return Wo(n,"toString",{configurable:!0,enumerable:!1,value:nh(i),writable:!0})}:Sr;function h6(n){return ha(Yi(n))}function Hr(n,i,a){var f=-1,g=n.length;i<0&&(i=-i>g?0:g+i),a=a>g?g:a,a<0&&(a+=g),g=i>a?0:a-i>>>0,i>>>=0;for(var w=K(g);++f<g;)w[f]=n[f+i];return w}function f6(n,i){var a;return Mn(n,function(f,g,w){return a=i(f,g,w),!a}),!!a}function ta(n,i,a){var f=0,g=n==null?f:n.length;if(typeof i=="number"&&i===i&&g<=oe){for(;f<g;){var w=f+g>>>1,O=n[w];O!==null&&!Tr(O)&&(a?O<=i:O<i)?f=w+1:g=w}return g}return Tu(n,i,Sr,a)}function Tu(n,i,a,f){var g=0,w=n==null?0:n.length;if(w===0)return 0;i=a(i);for(var O=i!==i,N=i===null,q=Tr(i),Q=i===t;g<w;){var Z=Vo((g+w)/2),ie=a(n[Z]),he=ie!==t,ye=ie===null,Ee=ie===ie,He=Tr(ie);if(O)var De=f||Ee;else Q?De=Ee&&(f||he):N?De=Ee&&he&&(f||!ye):q?De=Ee&&he&&!ye&&(f||!He):ye||He?De=!1:De=f?ie<=i:ie<i;De?g=Z+1:w=Z}return rr(w,me)}function pp(n,i){for(var a=-1,f=n.length,g=0,w=[];++a<f;){var O=n[a],N=i?i(O):O;if(!a||!Jr(N,q)){var q=N;w[g++]=O===0?0:O}}return w}function gp(n){return typeof n=="number"?n:Tr(n)?J:+n}function Cr(n){if(typeof n=="string")return n;if(Re(n))return mt(n,Cr)+"";if(Tr(n))return Vd?Vd.call(n):"";var i=n+"";return i=="0"&&1/n==-X?"-0":i}function qn(n,i,a){var f=-1,g=Lo,w=n.length,O=!0,N=[],q=N;if(a)O=!1,g=ou;else if(w>=o){var Q=i?null:E6(n);if(Q)return $o(Q);O=!1,g=Ds,q=new fi}else q=i?[]:N;e:for(;++f<w;){var Z=n[f],ie=i?i(Z):Z;if(Z=a||Z!==0?Z:0,O&&ie===ie){for(var he=q.length;he--;)if(q[he]===ie)continue e;i&&q.push(ie),N.push(Z)}else g(q,ie,a)||(q!==N&&q.push(ie),N.push(Z))}return N}function Ru(n,i){return i=Bn(i,n),n=zp(n,i),n==null||delete n[on(jr(i))]}function yp(n,i,a,f){return Ns(n,i,a(di(n,i)),f)}function ra(n,i,a,f){for(var g=n.length,w=f?g:-1;(f?w--:++w<g)&&i(n[w],w,n););return a?Hr(n,f?0:w,f?w+1:g):Hr(n,f?w+1:0,f?g:w)}function _p(n,i){var a=n;return a instanceof Je&&(a=a.value()),au(i,function(f,g){return g.func.apply(g.thisArg,Fn([f],g.args))},a)}function Nu(n,i,a){var f=n.length;if(f<2)return f?qn(n[0]):[];for(var g=-1,w=K(f);++g<f;)for(var O=n[g],N=-1;++N<f;)N!=g&&(w[g]=Cs(w[g]||O,n[N],i,a));return qn(Qt(w,1),i,a)}function vp(n,i,a){for(var f=-1,g=n.length,w=i.length,O={};++f<g;){var N=f<w?i[f]:t;a(O,n[f],N)}return O}function Lu(n){return Lt(n)?n:[]}function Fu(n){return typeof n=="function"?n:Sr}function Bn(n,i){return Re(n)?n:Ku(n,i)?[n]:Vp(nt(n))}var l6=Ke;function Hn(n,i,a){var f=n.length;return a=a===t?f:a,!i&&a>=f?n:Hr(n,i,a)}var wp=Z2||function(n){return Qe.clearTimeout(n)};function mp(n,i){if(i)return n.slice();var a=n.length,f=Hd?Hd(a):new n.constructor(a);return n.copy(f),f}function $u(n){var i=new n.constructor(n.byteLength);return new jo(i).set(new jo(n)),i}function d6(n,i){var a=i?$u(n.buffer):n.buffer;return new n.constructor(a,n.byteOffset,n.byteLength)}function p6(n){var i=new n.constructor(n.source,Fr.exec(n));return i.lastIndex=n.lastIndex,i}function g6(n){return Ps?ht(Ps.call(n)):{}}function bp(n,i){var a=i?$u(n.buffer):n.buffer;return new n.constructor(a,n.byteOffset,n.length)}function Ep(n,i){if(n!==i){var a=n!==t,f=n===null,g=n===n,w=Tr(n),O=i!==t,N=i===null,q=i===i,Q=Tr(i);if(!N&&!Q&&!w&&n>i||w&&O&&q&&!N&&!Q||f&&O&&q||!a&&q||!g)return 1;if(!f&&!w&&!Q&&n<i||Q&&a&&g&&!f&&!w||N&&a&&g||!O&&g||!q)return-1}return 0}function y6(n,i,a){for(var f=-1,g=n.criteria,w=i.criteria,O=g.length,N=a.length;++f<O;){var q=Ep(g[f],w[f]);if(q){if(f>=N)return q;var Q=a[f];return q*(Q=="desc"?-1:1)}}return n.index-i.index}function Dp(n,i,a,f){for(var g=-1,w=n.length,O=a.length,N=-1,q=i.length,Q=Wt(w-O,0),Z=K(q+Q),ie=!f;++N<q;)Z[N]=i[N];for(;++g<O;)(ie||g<w)&&(Z[a[g]]=n[g]);for(;Q--;)Z[N++]=n[g++];return Z}function Sp(n,i,a,f){for(var g=-1,w=n.length,O=-1,N=a.length,q=-1,Q=i.length,Z=Wt(w-N,0),ie=K(Z+Q),he=!f;++g<Z;)ie[g]=n[g];for(var ye=g;++q<Q;)ie[ye+q]=i[q];for(;++O<N;)(he||g<w)&&(ie[ye+a[O]]=n[g++]);return ie}function br(n,i){var a=-1,f=n.length;for(i||(i=K(f));++a<f;)i[a]=n[a];return i}function sn(n,i,a,f){var g=!a;a||(a={});for(var w=-1,O=i.length;++w<O;){var N=i[w],q=f?f(a[N],n[N],N,a,n):t;q===t&&(q=n[N]),g?mn(a,N,q):As(a,N,q)}return a}function _6(n,i){return sn(n,zu(n),i)}function v6(n,i){return sn(n,Up(n),i)}function na(n,i){return function(a,f){var g=Re(a)?D2:BD,w=i?i():{};return g(a,n,we(f,2),w)}}function Wi(n){return Ke(function(i,a){var f=-1,g=a.length,w=g>1?a[g-1]:t,O=g>2?a[2]:t;for(w=n.length>3&&typeof w=="function"?(g--,w):t,O&&pr(a[0],a[1],O)&&(w=g<3?t:w,g=1),i=ht(i);++f<g;){var N=a[f];N&&n(i,N,f,w)}return i})}function xp(n,i){return function(a,f){if(a==null)return a;if(!Er(a))return n(a,f);for(var g=a.length,w=i?g:-1,O=ht(a);(i?w--:++w<g)&&f(O[w],w,O)!==!1;);return a}}function Ip(n){return function(i,a,f){for(var g=-1,w=ht(i),O=f(i),N=O.length;N--;){var q=O[n?N:++g];if(a(w[q],q,w)===!1)break}return i}}function w6(n,i,a){var f=i&z,g=Ls(n);function w(){var O=this&&this!==Qe&&this instanceof w?g:n;return O.apply(f?a:this,arguments)}return w}function Op(n){return function(i){i=nt(i);var a=Mi(i)?kr(i):t,f=a?a[0]:i.charAt(0),g=a?Hn(a,1).join(""):i.slice(1);return f[n]()+g}}function Gi(n){return function(i){return au(xg(Sg(i).replace(bs,"")),n,"")}}function Ls(n){return function(){var i=arguments;switch(i.length){case 0:return new n;case 1:return new n(i[0]);case 2:return new n(i[0],i[1]);case 3:return new n(i[0],i[1],i[2]);case 4:return new n(i[0],i[1],i[2],i[3]);case 5:return new n(i[0],i[1],i[2],i[3],i[4]);case 6:return new n(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new n(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var a=Ki(n.prototype),f=n.apply(a,i);return Dt(f)?f:a}}function m6(n,i,a){var f=Ls(n);function g(){for(var w=arguments.length,O=K(w),N=w,q=Vi(g);N--;)O[N]=arguments[N];var Q=w<3&&O[0]!==q&&O[w-1]!==q?[]:$n(O,q);if(w-=Q.length,w<a)return Rp(n,i,ia,g.placeholder,t,O,Q,t,t,a-w);var Z=this&&this!==Qe&&this instanceof g?f:n;return kt(Z,this,O)}return g}function Pp(n){return function(i,a,f){var g=ht(i);if(!Er(i)){var w=we(a,3);i=Yt(i),a=function(N){return w(g[N],N,g)}}var O=n(i,a,f);return O>-1?g[w?i[O]:O]:t}}function Ap(n){return En(function(i){var a=i.length,f=a,g=qr.prototype.thru;for(n&&i.reverse();f--;){var w=i[f];if(typeof w!="function")throw new Mr(u);if(g&&!O&&ca(w)=="wrapper")var O=new qr([],!0)}for(f=O?f:a;++f<a;){w=i[f];var N=ca(w),q=N=="wrapper"?Hu(w):t;q&&Wu(q[0])&&q[1]==(h|M|T|m)&&!q[4].length&&q[9]==1?O=O[ca(q[0])].apply(O,q[3]):O=w.length==1&&Wu(w)?O[N]():O.thru(w)}return function(){var Q=arguments,Z=Q[0];if(O&&Q.length==1&&Re(Z))return O.plant(Z).value();for(var ie=0,he=a?i[ie].apply(this,Q):Z;++ie<a;)he=i[ie].call(this,he);return he}})}function ia(n,i,a,f,g,w,O,N,q,Q){var Z=i&h,ie=i&z,he=i&ne,ye=i&(M|A),Ee=i&V,He=he?t:Ls(n);function De(){for(var Ve=arguments.length,Ze=K(Ve),Rr=Ve;Rr--;)Ze[Rr]=arguments[Rr];if(ye)var gr=Vi(De),Nr=R2(Ze,gr);if(f&&(Ze=Dp(Ze,f,g,ye)),w&&(Ze=Sp(Ze,w,O,ye)),Ve-=Nr,ye&&Ve<Q){var Ft=$n(Ze,gr);return Rp(n,i,ia,De.placeholder,a,Ze,Ft,N,q,Q-Ve)}var Xr=ie?a:this,In=he?Xr[n]:n;return Ve=Ze.length,N?Ze=B6(Ze,N):Ee&&Ve>1&&Ze.reverse(),Z&&q<Ve&&(Ze.length=q),this&&this!==Qe&&this instanceof De&&(In=He||Ls(In)),In.apply(Xr,Ze)}return De}function Cp(n,i){return function(a,f){return kD(a,n,i(f),{})}}function sa(n,i){return function(a,f){var g;if(a===t&&f===t)return i;if(a!==t&&(g=a),f!==t){if(g===t)return f;typeof a=="string"||typeof f=="string"?(a=Cr(a),f=Cr(f)):(a=gp(a),f=gp(f)),g=n(a,f)}return g}}function Uu(n){return En(function(i){return i=mt(i,Ar(we())),Ke(function(a){var f=this;return n(i,function(g){return kt(g,f,a)})})})}function oa(n,i){i=i===t?" ":Cr(i);var a=i.length;if(a<2)return a?Cu(i,n):i;var f=Cu(i,Go(n/qi(i)));return Mi(i)?Hn(kr(f),0,n).join(""):f.slice(0,n)}function b6(n,i,a,f){var g=i&z,w=Ls(n);function O(){for(var N=-1,q=arguments.length,Q=-1,Z=f.length,ie=K(Z+q),he=this&&this!==Qe&&this instanceof O?w:n;++Q<Z;)ie[Q]=f[Q];for(;q--;)ie[Q++]=arguments[++N];return kt(he,g?a:this,ie)}return O}function Tp(n){return function(i,a,f){return f&&typeof f!="number"&&pr(i,a,f)&&(a=f=t),i=xn(i),a===t?(a=i,i=0):a=xn(a),f=f===t?i<a?1:-1:xn(f),o6(i,a,f,n)}}function aa(n){return function(i,a){return typeof i=="string"&&typeof a=="string"||(i=zr(i),a=zr(a)),n(i,a)}}function Rp(n,i,a,f,g,w,O,N,q,Q){var Z=i&M,ie=Z?O:t,he=Z?t:O,ye=Z?w:t,Ee=Z?t:w;i|=Z?T:E,i&=~(Z?E:T),i&L||(i&=~(z|ne));var He=[n,i,g,ye,ie,Ee,he,N,q,Q],De=a.apply(t,He);return Wu(n)&&Kp(De,He),De.placeholder=f,Wp(De,n,i)}function Mu(n){var i=Kt[n];return function(a,f){if(a=zr(a),f=f==null?0:rr(Me(f),292),f&&Wd(a)){var g=(nt(a)+"e").split("e"),w=i(g[0]+"e"+(+g[1]+f));return g=(nt(w)+"e").split("e"),+(g[0]+"e"+(+g[1]-f))}return i(a)}}var E6=ji&&1/$o(new ji([,-0]))[1]==X?function(n){return new ji(n)}:oh;function Np(n){return function(i){var a=nr(i);return a==xe?pu(i):a==Ie?q2(i):T2(i,n(i))}}function bn(n,i,a,f,g,w,O,N){var q=i&ne;if(!q&&typeof n!="function")throw new Mr(u);var Q=f?f.length:0;if(Q||(i&=~(T|E),f=g=t),O=O===t?O:Wt(Me(O),0),N=N===t?N:Me(N),Q-=g?g.length:0,i&E){var Z=f,ie=g;f=g=t}var he=q?t:Hu(n),ye=[n,i,a,f,g,Z,ie,w,O,N];if(he&&U6(ye,he),n=ye[0],i=ye[1],a=ye[2],f=ye[3],g=ye[4],N=ye[9]=ye[9]===t?q?0:n.length:Wt(ye[9]-Q,0),!N&&i&(M|A)&&(i&=~(M|A)),!i||i==z)var Ee=w6(n,i,a);else i==M||i==A?Ee=m6(n,i,N):(i==T||i==(z|T))&&!g.length?Ee=b6(n,i,a,f):Ee=ia.apply(t,ye);var He=he?dp:Kp;return Wp(He(Ee,ye),n,i)}function Lp(n,i,a,f){return n===t||Jr(n,Hi[a])&&!it.call(f,a)?i:n}function Fp(n,i,a,f,g,w){return Dt(n)&&Dt(i)&&(w.set(i,n),ea(n,i,t,Fp,w),w.delete(i)),n}function D6(n){return Us(n)?t:n}function $p(n,i,a,f,g,w){var O=a&I,N=n.length,q=i.length;if(N!=q&&!(O&&q>N))return!1;var Q=w.get(n),Z=w.get(i);if(Q&&Z)return Q==i&&Z==n;var ie=-1,he=!0,ye=a&B?new fi:t;for(w.set(n,i),w.set(i,n);++ie<N;){var Ee=n[ie],He=i[ie];if(f)var De=O?f(He,Ee,ie,i,n,w):f(Ee,He,ie,n,i,w);if(De!==t){if(De)continue;he=!1;break}if(ye){if(!cu(i,function(Ve,Ze){if(!Ds(ye,Ze)&&(Ee===Ve||g(Ee,Ve,a,f,w)))return ye.push(Ze)})){he=!1;break}}else if(!(Ee===He||g(Ee,He,a,f,w))){he=!1;break}}return w.delete(n),w.delete(i),he}function S6(n,i,a,f,g,w,O){switch(a){case Ae:if(n.byteLength!=i.byteLength||n.byteOffset!=i.byteOffset)return!1;n=n.buffer,i=i.buffer;case Se:return!(n.byteLength!=i.byteLength||!w(new jo(n),new jo(i)));case H:case F:case je:return Jr(+n,+i);case R:return n.name==i.name&&n.message==i.message;case qe:case Le:return n==i+"";case xe:var N=pu;case Ie:var q=f&I;if(N||(N=$o),n.size!=i.size&&!q)return!1;var Q=O.get(n);if(Q)return Q==i;f|=B,O.set(n,i);var Z=$p(N(n),N(i),f,g,w,O);return O.delete(n),Z;case Fe:if(Ps)return Ps.call(n)==Ps.call(i)}return!1}function x6(n,i,a,f,g,w){var O=a&I,N=qu(n),q=N.length,Q=qu(i),Z=Q.length;if(q!=Z&&!O)return!1;for(var ie=q;ie--;){var he=N[ie];if(!(O?he in i:it.call(i,he)))return!1}var ye=w.get(n),Ee=w.get(i);if(ye&&Ee)return ye==i&&Ee==n;var He=!0;w.set(n,i),w.set(i,n);for(var De=O;++ie<q;){he=N[ie];var Ve=n[he],Ze=i[he];if(f)var Rr=O?f(Ze,Ve,he,i,n,w):f(Ve,Ze,he,n,i,w);if(!(Rr===t?Ve===Ze||g(Ve,Ze,a,f,w):Rr)){He=!1;break}De||(De=he=="constructor")}if(He&&!De){var gr=n.constructor,Nr=i.constructor;gr!=Nr&&"constructor"in n&&"constructor"in i&&!(typeof gr=="function"&&gr instanceof gr&&typeof Nr=="function"&&Nr instanceof Nr)&&(He=!1)}return w.delete(n),w.delete(i),He}function En(n){return Vu(jp(n,t,Xp),n+"")}function qu(n){return rp(n,Yt,zu)}function Bu(n){return rp(n,Dr,Up)}var Hu=ko?function(n){return ko.get(n)}:oh;function ca(n){for(var i=n.name+"",a=zi[i],f=it.call(zi,i)?a.length:0;f--;){var g=a[f],w=g.func;if(w==null||w==n)return g.name}return i}function Vi(n){var i=it.call(v,"placeholder")?v:n;return i.placeholder}function we(){var n=v.iteratee||ih;return n=n===ih?sp:n,arguments.length?n(arguments[0],arguments[1]):n}function ua(n,i){var a=n.__data__;return N6(i)?a[typeof i=="string"?"string":"hash"]:a.map}function ju(n){for(var i=Yt(n),a=i.length;a--;){var f=i[a],g=n[f];i[a]=[f,g,Bp(g)]}return i}function pi(n,i){var a=$2(n,i);return ip(a)?a:t}function I6(n){var i=it.call(n,ui),a=n[ui];try{n[ui]=t;var f=!0}catch{}var g=Bo.call(n);return f&&(i?n[ui]=a:delete n[ui]),g}var zu=yu?function(n){return n==null?[]:(n=ht(n),Ln(yu(n),function(i){return zd.call(n,i)}))}:ah,Up=yu?function(n){for(var i=[];n;)Fn(i,zu(n)),n=zo(n);return i}:ah,nr=dr;(_u&&nr(new _u(new ArrayBuffer(1)))!=Ae||xs&&nr(new xs)!=xe||vu&&nr(vu.resolve())!=yt||ji&&nr(new ji)!=Ie||Is&&nr(new Is)!=Pe)&&(nr=function(n){var i=dr(n),a=i==Ue?n.constructor:t,f=a?gi(a):"";if(f)switch(f){case cD:return Ae;case uD:return xe;case hD:return yt;case fD:return Ie;case lD:return Pe}return i});function O6(n,i,a){for(var f=-1,g=a.length;++f<g;){var w=a[f],O=w.size;switch(w.type){case"drop":n+=O;break;case"dropRight":i-=O;break;case"take":i=rr(i,n+O);break;case"takeRight":n=Wt(n,i-O);break}}return{start:n,end:i}}function P6(n){var i=n.match(lt);return i?i[1].split(Bt):[]}function Mp(n,i,a){i=Bn(i,n);for(var f=-1,g=i.length,w=!1;++f<g;){var O=on(i[f]);if(!(w=n!=null&&a(n,O)))break;n=n[O]}return w||++f!=g?w:(g=n==null?0:n.length,!!g&&ya(g)&&Dn(O,g)&&(Re(n)||yi(n)))}function A6(n){var i=n.length,a=new n.constructor(i);return i&&typeof n[0]=="string"&&it.call(n,"index")&&(a.index=n.index,a.input=n.input),a}function qp(n){return typeof n.constructor=="function"&&!Fs(n)?Ki(zo(n)):{}}function C6(n,i,a){var f=n.constructor;switch(i){case Se:return $u(n);case H:case F:return new f(+n);case Ae:return d6(n,a);case ze:case Oe:case Ge:case Ye:case et:case tt:case Xe:case hr:case wr:return bp(n,a);case xe:return new f;case je:case Le:return new f(n);case qe:return p6(n);case Ie:return new f;case Fe:return g6(n)}}function T6(n,i){var a=i.length;if(!a)return n;var f=a-1;return i[f]=(a>1?"& ":"")+i[f],i=i.join(a>2?", ":" "),n.replace(At,`{
/* [wrapped with `+i+`] */
`)}function R6(n){return Re(n)||yi(n)||!!(Kd&&n&&n[Kd])}function Dn(n,i){var a=typeof n;return i=i??W,!!i&&(a=="number"||a!="symbol"&&Gc.test(n))&&n>-1&&n%1==0&&n<i}function pr(n,i,a){if(!Dt(a))return!1;var f=typeof i;return(f=="number"?Er(a)&&Dn(i,a.length):f=="string"&&i in a)?Jr(a[i],n):!1}function Ku(n,i){if(Re(n))return!1;var a=typeof n;return a=="number"||a=="symbol"||a=="boolean"||n==null||Tr(n)?!0:Ut.test(n)||!wt.test(n)||i!=null&&n in ht(i)}function N6(n){var i=typeof n;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?n!=="__proto__":n===null}function Wu(n){var i=ca(n),a=v[i];if(typeof a!="function"||!(i in Je.prototype))return!1;if(n===a)return!0;var f=Hu(a);return!!f&&n===f[0]}function L6(n){return!!Bd&&Bd in n}var F6=Mo?Sn:ch;function Fs(n){var i=n&&n.constructor,a=typeof i=="function"&&i.prototype||Hi;return n===a}function Bp(n){return n===n&&!Dt(n)}function Hp(n,i){return function(a){return a==null?!1:a[n]===i&&(i!==t||n in ht(a))}}function $6(n){var i=pa(n,function(f){return a.size===p&&a.clear(),f}),a=i.cache;return i}function U6(n,i){var a=n[1],f=i[1],g=a|f,w=g<(z|ne|h),O=f==h&&a==M||f==h&&a==m&&n[7].length<=i[8]||f==(h|m)&&i[7].length<=i[8]&&a==M;if(!(w||O))return n;f&z&&(n[2]=i[2],g|=a&z?0:L);var N=i[3];if(N){var q=n[3];n[3]=q?Dp(q,N,i[4]):N,n[4]=q?$n(n[3],_):i[4]}return N=i[5],N&&(q=n[5],n[5]=q?Sp(q,N,i[6]):N,n[6]=q?$n(n[5],_):i[6]),N=i[7],N&&(n[7]=N),f&h&&(n[8]=n[8]==null?i[8]:rr(n[8],i[8])),n[9]==null&&(n[9]=i[9]),n[0]=i[0],n[1]=g,n}function M6(n){var i=[];if(n!=null)for(var a in ht(n))i.push(a);return i}function q6(n){return Bo.call(n)}function jp(n,i,a){return i=Wt(i===t?n.length-1:i,0),function(){for(var f=arguments,g=-1,w=Wt(f.length-i,0),O=K(w);++g<w;)O[g]=f[i+g];g=-1;for(var N=K(i+1);++g<i;)N[g]=f[g];return N[i]=a(O),kt(n,this,N)}}function zp(n,i){return i.length<2?n:di(n,Hr(i,0,-1))}function B6(n,i){for(var a=n.length,f=rr(i.length,a),g=br(n);f--;){var w=i[f];n[f]=Dn(w,a)?g[w]:t}return n}function Gu(n,i){if(!(i==="constructor"&&typeof n[i]=="function")&&i!="__proto__")return n[i]}var Kp=Gp(dp),$s=tD||function(n,i){return Qe.setTimeout(n,i)},Vu=Gp(u6);function Wp(n,i,a){var f=i+"";return Vu(n,T6(f,H6(P6(f),a)))}function Gp(n){var i=0,a=0;return function(){var f=sD(),g=de-(f-a);if(a=f,g>0){if(++i>=ue)return arguments[0]}else i=0;return n.apply(t,arguments)}}function ha(n,i){var a=-1,f=n.length,g=f-1;for(i=i===t?f:i;++a<i;){var w=Au(a,g),O=n[w];n[w]=n[a],n[a]=O}return n.length=i,n}var Vp=$6(function(n){var i=[];return n.charCodeAt(0)===46&&i.push(""),n.replace(Mt,function(a,f,g,w){i.push(g?w.replace(Bc,"$1"):f||a)}),i});function on(n){if(typeof n=="string"||Tr(n))return n;var i=n+"";return i=="0"&&1/n==-X?"-0":i}function gi(n){if(n!=null){try{return qo.call(n)}catch{}try{return n+""}catch{}}return""}function H6(n,i){return Ur(be,function(a){var f="_."+a[0];i&a[1]&&!Lo(n,f)&&n.push(f)}),n.sort()}function kp(n){if(n instanceof Je)return n.clone();var i=new qr(n.__wrapped__,n.__chain__);return i.__actions__=br(n.__actions__),i.__index__=n.__index__,i.__values__=n.__values__,i}function j6(n,i,a){(a?pr(n,i,a):i===t)?i=1:i=Wt(Me(i),0);var f=n==null?0:n.length;if(!f||i<1)return[];for(var g=0,w=0,O=K(Go(f/i));g<f;)O[w++]=Hr(n,g,g+=i);return O}function z6(n){for(var i=-1,a=n==null?0:n.length,f=0,g=[];++i<a;){var w=n[i];w&&(g[f++]=w)}return g}function K6(){var n=arguments.length;if(!n)return[];for(var i=K(n-1),a=arguments[0],f=n;f--;)i[f-1]=arguments[f];return Fn(Re(a)?br(a):[a],Qt(i,1))}var W6=Ke(function(n,i){return Lt(n)?Cs(n,Qt(i,1,Lt,!0)):[]}),G6=Ke(function(n,i){var a=jr(i);return Lt(a)&&(a=t),Lt(n)?Cs(n,Qt(i,1,Lt,!0),we(a,2)):[]}),V6=Ke(function(n,i){var a=jr(i);return Lt(a)&&(a=t),Lt(n)?Cs(n,Qt(i,1,Lt,!0),t,a):[]});function k6(n,i,a){var f=n==null?0:n.length;return f?(i=a||i===t?1:Me(i),Hr(n,i<0?0:i,f)):[]}function Y6(n,i,a){var f=n==null?0:n.length;return f?(i=a||i===t?1:Me(i),i=f-i,Hr(n,0,i<0?0:i)):[]}function J6(n,i){return n&&n.length?ra(n,we(i,3),!0,!0):[]}function X6(n,i){return n&&n.length?ra(n,we(i,3),!0):[]}function Q6(n,i,a,f){var g=n==null?0:n.length;return g?(a&&typeof a!="number"&&pr(n,i,a)&&(a=0,f=g),KD(n,i,a,f)):[]}function Yp(n,i,a){var f=n==null?0:n.length;if(!f)return-1;var g=a==null?0:Me(a);return g<0&&(g=Wt(f+g,0)),Fo(n,we(i,3),g)}function Jp(n,i,a){var f=n==null?0:n.length;if(!f)return-1;var g=f-1;return a!==t&&(g=Me(a),g=a<0?Wt(f+g,0):rr(g,f-1)),Fo(n,we(i,3),g,!0)}function Xp(n){var i=n==null?0:n.length;return i?Qt(n,1):[]}function Z6(n){var i=n==null?0:n.length;return i?Qt(n,X):[]}function eS(n,i){var a=n==null?0:n.length;return a?(i=i===t?1:Me(i),Qt(n,i)):[]}function tS(n){for(var i=-1,a=n==null?0:n.length,f={};++i<a;){var g=n[i];f[g[0]]=g[1]}return f}function Qp(n){return n&&n.length?n[0]:t}function rS(n,i,a){var f=n==null?0:n.length;if(!f)return-1;var g=a==null?0:Me(a);return g<0&&(g=Wt(f+g,0)),Ui(n,i,g)}function nS(n){var i=n==null?0:n.length;return i?Hr(n,0,-1):[]}var iS=Ke(function(n){var i=mt(n,Lu);return i.length&&i[0]===n[0]?Su(i):[]}),sS=Ke(function(n){var i=jr(n),a=mt(n,Lu);return i===jr(a)?i=t:a.pop(),a.length&&a[0]===n[0]?Su(a,we(i,2)):[]}),oS=Ke(function(n){var i=jr(n),a=mt(n,Lu);return i=typeof i=="function"?i:t,i&&a.pop(),a.length&&a[0]===n[0]?Su(a,t,i):[]});function aS(n,i){return n==null?"":nD.call(n,i)}function jr(n){var i=n==null?0:n.length;return i?n[i-1]:t}function cS(n,i,a){var f=n==null?0:n.length;if(!f)return-1;var g=f;return a!==t&&(g=Me(a),g=g<0?Wt(f+g,0):rr(g,f-1)),i===i?H2(n,i,g):Fo(n,Rd,g,!0)}function uS(n,i){return n&&n.length?up(n,Me(i)):t}var hS=Ke(Zp);function Zp(n,i){return n&&n.length&&i&&i.length?Pu(n,i):n}function fS(n,i,a){return n&&n.length&&i&&i.length?Pu(n,i,we(a,2)):n}function lS(n,i,a){return n&&n.length&&i&&i.length?Pu(n,i,t,a):n}var dS=En(function(n,i){var a=n==null?0:n.length,f=mu(n,i);return lp(n,mt(i,function(g){return Dn(g,a)?+g:g}).sort(Ep)),f});function pS(n,i){var a=[];if(!(n&&n.length))return a;var f=-1,g=[],w=n.length;for(i=we(i,3);++f<w;){var O=n[f];i(O,f,n)&&(a.push(O),g.push(f))}return lp(n,g),a}function ku(n){return n==null?n:aD.call(n)}function gS(n,i,a){var f=n==null?0:n.length;return f?(a&&typeof a!="number"&&pr(n,i,a)?(i=0,a=f):(i=i==null?0:Me(i),a=a===t?f:Me(a)),Hr(n,i,a)):[]}function yS(n,i){return ta(n,i)}function _S(n,i,a){return Tu(n,i,we(a,2))}function vS(n,i){var a=n==null?0:n.length;if(a){var f=ta(n,i);if(f<a&&Jr(n[f],i))return f}return-1}function wS(n,i){return ta(n,i,!0)}function mS(n,i,a){return Tu(n,i,we(a,2),!0)}function bS(n,i){var a=n==null?0:n.length;if(a){var f=ta(n,i,!0)-1;if(Jr(n[f],i))return f}return-1}function ES(n){return n&&n.length?pp(n):[]}function DS(n,i){return n&&n.length?pp(n,we(i,2)):[]}function SS(n){var i=n==null?0:n.length;return i?Hr(n,1,i):[]}function xS(n,i,a){return n&&n.length?(i=a||i===t?1:Me(i),Hr(n,0,i<0?0:i)):[]}function IS(n,i,a){var f=n==null?0:n.length;return f?(i=a||i===t?1:Me(i),i=f-i,Hr(n,i<0?0:i,f)):[]}function OS(n,i){return n&&n.length?ra(n,we(i,3),!1,!0):[]}function PS(n,i){return n&&n.length?ra(n,we(i,3)):[]}var AS=Ke(function(n){return qn(Qt(n,1,Lt,!0))}),CS=Ke(function(n){var i=jr(n);return Lt(i)&&(i=t),qn(Qt(n,1,Lt,!0),we(i,2))}),TS=Ke(function(n){var i=jr(n);return i=typeof i=="function"?i:t,qn(Qt(n,1,Lt,!0),t,i)});function RS(n){return n&&n.length?qn(n):[]}function NS(n,i){return n&&n.length?qn(n,we(i,2)):[]}function LS(n,i){return i=typeof i=="function"?i:t,n&&n.length?qn(n,t,i):[]}function Yu(n){if(!(n&&n.length))return[];var i=0;return n=Ln(n,function(a){if(Lt(a))return i=Wt(a.length,i),!0}),lu(i,function(a){return mt(n,uu(a))})}function eg(n,i){if(!(n&&n.length))return[];var a=Yu(n);return i==null?a:mt(a,function(f){return kt(i,t,f)})}var FS=Ke(function(n,i){return Lt(n)?Cs(n,i):[]}),$S=Ke(function(n){return Nu(Ln(n,Lt))}),US=Ke(function(n){var i=jr(n);return Lt(i)&&(i=t),Nu(Ln(n,Lt),we(i,2))}),MS=Ke(function(n){var i=jr(n);return i=typeof i=="function"?i:t,Nu(Ln(n,Lt),t,i)}),qS=Ke(Yu);function BS(n,i){return vp(n||[],i||[],As)}function HS(n,i){return vp(n||[],i||[],Ns)}var jS=Ke(function(n){var i=n.length,a=i>1?n[i-1]:t;return a=typeof a=="function"?(n.pop(),a):t,eg(n,a)});function tg(n){var i=v(n);return i.__chain__=!0,i}function zS(n,i){return i(n),n}function fa(n,i){return i(n)}var KS=En(function(n){var i=n.length,a=i?n[0]:0,f=this.__wrapped__,g=function(w){return mu(w,n)};return i>1||this.__actions__.length||!(f instanceof Je)||!Dn(a)?this.thru(g):(f=f.slice(a,+a+(i?1:0)),f.__actions__.push({func:fa,args:[g],thisArg:t}),new qr(f,this.__chain__).thru(function(w){return i&&!w.length&&w.push(t),w}))});function WS(){return tg(this)}function GS(){return new qr(this.value(),this.__chain__)}function VS(){this.__values__===t&&(this.__values__=gg(this.value()));var n=this.__index__>=this.__values__.length,i=n?t:this.__values__[this.__index__++];return{done:n,value:i}}function kS(){return this}function YS(n){for(var i,a=this;a instanceof Jo;){var f=kp(a);f.__index__=0,f.__values__=t,i?g.__wrapped__=f:i=f;var g=f;a=a.__wrapped__}return g.__wrapped__=n,i}function JS(){var n=this.__wrapped__;if(n instanceof Je){var i=n;return this.__actions__.length&&(i=new Je(this)),i=i.reverse(),i.__actions__.push({func:fa,args:[ku],thisArg:t}),new qr(i,this.__chain__)}return this.thru(ku)}function XS(){return _p(this.__wrapped__,this.__actions__)}var QS=na(function(n,i,a){it.call(n,a)?++n[a]:mn(n,a,1)});function ZS(n,i,a){var f=Re(n)?Cd:zD;return a&&pr(n,i,a)&&(i=t),f(n,we(i,3))}function ex(n,i){var a=Re(n)?Ln:ep;return a(n,we(i,3))}var tx=Pp(Yp),rx=Pp(Jp);function nx(n,i){return Qt(la(n,i),1)}function ix(n,i){return Qt(la(n,i),X)}function sx(n,i,a){return a=a===t?1:Me(a),Qt(la(n,i),a)}function rg(n,i){var a=Re(n)?Ur:Mn;return a(n,we(i,3))}function ng(n,i){var a=Re(n)?S2:Zd;return a(n,we(i,3))}var ox=na(function(n,i,a){it.call(n,a)?n[a].push(i):mn(n,a,[i])});function ax(n,i,a,f){n=Er(n)?n:Yi(n),a=a&&!f?Me(a):0;var g=n.length;return a<0&&(a=Wt(g+a,0)),_a(n)?a<=g&&n.indexOf(i,a)>-1:!!g&&Ui(n,i,a)>-1}var cx=Ke(function(n,i,a){var f=-1,g=typeof i=="function",w=Er(n)?K(n.length):[];return Mn(n,function(O){w[++f]=g?kt(i,O,a):Ts(O,i,a)}),w}),ux=na(function(n,i,a){mn(n,a,i)});function la(n,i){var a=Re(n)?mt:op;return a(n,we(i,3))}function hx(n,i,a,f){return n==null?[]:(Re(i)||(i=i==null?[]:[i]),a=f?t:a,Re(a)||(a=a==null?[]:[a]),hp(n,i,a))}var fx=na(function(n,i,a){n[a?0:1].push(i)},function(){return[[],[]]});function lx(n,i,a){var f=Re(n)?au:Ld,g=arguments.length<3;return f(n,we(i,4),a,g,Mn)}function dx(n,i,a){var f=Re(n)?x2:Ld,g=arguments.length<3;return f(n,we(i,4),a,g,Zd)}function px(n,i){var a=Re(n)?Ln:ep;return a(n,ga(we(i,3)))}function gx(n){var i=Re(n)?Yd:a6;return i(n)}function yx(n,i,a){(a?pr(n,i,a):i===t)?i=1:i=Me(i);var f=Re(n)?MD:c6;return f(n,i)}function _x(n){var i=Re(n)?qD:h6;return i(n)}function vx(n){if(n==null)return 0;if(Er(n))return _a(n)?qi(n):n.length;var i=nr(n);return i==xe||i==Ie?n.size:Iu(n).length}function wx(n,i,a){var f=Re(n)?cu:f6;return a&&pr(n,i,a)&&(i=t),f(n,we(i,3))}var mx=Ke(function(n,i){if(n==null)return[];var a=i.length;return a>1&&pr(n,i[0],i[1])?i=[]:a>2&&pr(i[0],i[1],i[2])&&(i=[i[0]]),hp(n,Qt(i,1),[])}),da=eD||function(){return Qe.Date.now()};function bx(n,i){if(typeof i!="function")throw new Mr(u);return n=Me(n),function(){if(--n<1)return i.apply(this,arguments)}}function ig(n,i,a){return i=a?t:i,i=n&&i==null?n.length:i,bn(n,h,t,t,t,t,i)}function sg(n,i){var a;if(typeof i!="function")throw new Mr(u);return n=Me(n),function(){return--n>0&&(a=i.apply(this,arguments)),n<=1&&(i=t),a}}var Ju=Ke(function(n,i,a){var f=z;if(a.length){var g=$n(a,Vi(Ju));f|=T}return bn(n,f,i,a,g)}),og=Ke(function(n,i,a){var f=z|ne;if(a.length){var g=$n(a,Vi(og));f|=T}return bn(i,f,n,a,g)});function ag(n,i,a){i=a?t:i;var f=bn(n,M,t,t,t,t,t,i);return f.placeholder=ag.placeholder,f}function cg(n,i,a){i=a?t:i;var f=bn(n,A,t,t,t,t,t,i);return f.placeholder=cg.placeholder,f}function ug(n,i,a){var f,g,w,O,N,q,Q=0,Z=!1,ie=!1,he=!0;if(typeof n!="function")throw new Mr(u);i=zr(i)||0,Dt(a)&&(Z=!!a.leading,ie="maxWait"in a,w=ie?Wt(zr(a.maxWait)||0,i):w,he="trailing"in a?!!a.trailing:he);function ye(Ft){var Xr=f,In=g;return f=g=t,Q=Ft,O=n.apply(In,Xr),O}function Ee(Ft){return Q=Ft,N=$s(Ve,i),Z?ye(Ft):O}function He(Ft){var Xr=Ft-q,In=Ft-Q,Pg=i-Xr;return ie?rr(Pg,w-In):Pg}function De(Ft){var Xr=Ft-q,In=Ft-Q;return q===t||Xr>=i||Xr<0||ie&&In>=w}function Ve(){var Ft=da();if(De(Ft))return Ze(Ft);N=$s(Ve,He(Ft))}function Ze(Ft){return N=t,he&&f?ye(Ft):(f=g=t,O)}function Rr(){N!==t&&wp(N),Q=0,f=q=g=N=t}function gr(){return N===t?O:Ze(da())}function Nr(){var Ft=da(),Xr=De(Ft);if(f=arguments,g=this,q=Ft,Xr){if(N===t)return Ee(q);if(ie)return wp(N),N=$s(Ve,i),ye(q)}return N===t&&(N=$s(Ve,i)),O}return Nr.cancel=Rr,Nr.flush=gr,Nr}var Ex=Ke(function(n,i){return Qd(n,1,i)}),Dx=Ke(function(n,i,a){return Qd(n,zr(i)||0,a)});function Sx(n){return bn(n,V)}function pa(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new Mr(u);var a=function(){var f=arguments,g=i?i.apply(this,f):f[0],w=a.cache;if(w.has(g))return w.get(g);var O=n.apply(this,f);return a.cache=w.set(g,O)||w,O};return a.cache=new(pa.Cache||wn),a}pa.Cache=wn;function ga(n){if(typeof n!="function")throw new Mr(u);return function(){var i=arguments;switch(i.length){case 0:return!n.call(this);case 1:return!n.call(this,i[0]);case 2:return!n.call(this,i[0],i[1]);case 3:return!n.call(this,i[0],i[1],i[2])}return!n.apply(this,i)}}function xx(n){return sg(2,n)}var Ix=l6(function(n,i){i=i.length==1&&Re(i[0])?mt(i[0],Ar(we())):mt(Qt(i,1),Ar(we()));var a=i.length;return Ke(function(f){for(var g=-1,w=rr(f.length,a);++g<w;)f[g]=i[g].call(this,f[g]);return kt(n,this,f)})}),Xu=Ke(function(n,i){var a=$n(i,Vi(Xu));return bn(n,T,t,i,a)}),hg=Ke(function(n,i){var a=$n(i,Vi(hg));return bn(n,E,t,i,a)}),Ox=En(function(n,i){return bn(n,m,t,t,t,i)});function Px(n,i){if(typeof n!="function")throw new Mr(u);return i=i===t?i:Me(i),Ke(n,i)}function Ax(n,i){if(typeof n!="function")throw new Mr(u);return i=i==null?0:Wt(Me(i),0),Ke(function(a){var f=a[i],g=Hn(a,0,i);return f&&Fn(g,f),kt(n,this,g)})}function Cx(n,i,a){var f=!0,g=!0;if(typeof n!="function")throw new Mr(u);return Dt(a)&&(f="leading"in a?!!a.leading:f,g="trailing"in a?!!a.trailing:g),ug(n,i,{leading:f,maxWait:i,trailing:g})}function Tx(n){return ig(n,1)}function Rx(n,i){return Xu(Fu(i),n)}function Nx(){if(!arguments.length)return[];var n=arguments[0];return Re(n)?n:[n]}function Lx(n){return Br(n,P)}function Fx(n,i){return i=typeof i=="function"?i:t,Br(n,P,i)}function $x(n){return Br(n,D|P)}function Ux(n,i){return i=typeof i=="function"?i:t,Br(n,D|P,i)}function Mx(n,i){return i==null||Xd(n,i,Yt(i))}function Jr(n,i){return n===i||n!==n&&i!==i}var qx=aa(Du),Bx=aa(function(n,i){return n>=i}),yi=np(function(){return arguments}())?np:function(n){return Ct(n)&&it.call(n,"callee")&&!zd.call(n,"callee")},Re=K.isArray,Hx=lr?Ar(lr):YD;function Er(n){return n!=null&&ya(n.length)&&!Sn(n)}function Lt(n){return Ct(n)&&Er(n)}function jx(n){return n===!0||n===!1||Ct(n)&&dr(n)==H}var jn=rD||ch,zx=Vr?Ar(Vr):JD;function Kx(n){return Ct(n)&&n.nodeType===1&&!Us(n)}function Wx(n){if(n==null)return!0;if(Er(n)&&(Re(n)||typeof n=="string"||typeof n.splice=="function"||jn(n)||ki(n)||yi(n)))return!n.length;var i=nr(n);if(i==xe||i==Ie)return!n.size;if(Fs(n))return!Iu(n).length;for(var a in n)if(it.call(n,a))return!1;return!0}function Gx(n,i){return Rs(n,i)}function Vx(n,i,a){a=typeof a=="function"?a:t;var f=a?a(n,i):t;return f===t?Rs(n,i,t,a):!!f}function Qu(n){if(!Ct(n))return!1;var i=dr(n);return i==R||i==d||typeof n.message=="string"&&typeof n.name=="string"&&!Us(n)}function kx(n){return typeof n=="number"&&Wd(n)}function Sn(n){if(!Dt(n))return!1;var i=dr(n);return i==ae||i==le||i==j||i==_t}function fg(n){return typeof n=="number"&&n==Me(n)}function ya(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=W}function Dt(n){var i=typeof n;return n!=null&&(i=="object"||i=="function")}function Ct(n){return n!=null&&typeof n=="object"}var lg=$r?Ar($r):QD;function Yx(n,i){return n===i||xu(n,i,ju(i))}function Jx(n,i,a){return a=typeof a=="function"?a:t,xu(n,i,ju(i),a)}function Xx(n){return dg(n)&&n!=+n}function Qx(n){if(F6(n))throw new Ce(c);return ip(n)}function Zx(n){return n===null}function eI(n){return n==null}function dg(n){return typeof n=="number"||Ct(n)&&dr(n)==je}function Us(n){if(!Ct(n)||dr(n)!=Ue)return!1;var i=zo(n);if(i===null)return!0;var a=it.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&qo.call(a)==J2}var Zu=rn?Ar(rn):ZD;function tI(n){return fg(n)&&n>=-W&&n<=W}var pg=Es?Ar(Es):e6;function _a(n){return typeof n=="string"||!Re(n)&&Ct(n)&&dr(n)==Le}function Tr(n){return typeof n=="symbol"||Ct(n)&&dr(n)==Fe}var ki=ci?Ar(ci):t6;function rI(n){return n===t}function nI(n){return Ct(n)&&nr(n)==Pe}function iI(n){return Ct(n)&&dr(n)==$e}var sI=aa(Ou),oI=aa(function(n,i){return n<=i});function gg(n){if(!n)return[];if(Er(n))return _a(n)?kr(n):br(n);if(Ss&&n[Ss])return M2(n[Ss]());var i=nr(n),a=i==xe?pu:i==Ie?$o:Yi;return a(n)}function xn(n){if(!n)return n===0?n:0;if(n=zr(n),n===X||n===-X){var i=n<0?-1:1;return i*G}return n===n?n:0}function Me(n){var i=xn(n),a=i%1;return i===i?a?i-a:i:0}function yg(n){return n?li(Me(n),0,re):0}function zr(n){if(typeof n=="number")return n;if(Tr(n))return J;if(Dt(n)){var i=typeof n.valueOf=="function"?n.valueOf():n;n=Dt(i)?i+"":i}if(typeof n!="string")return n===0?n:+n;n=Fd(n);var a=zc.test(n);return a||Wc.test(n)?Te(n.slice(2),a?2:8):jc.test(n)?J:+n}function _g(n){return sn(n,Dr(n))}function aI(n){return n?li(Me(n),-W,W):n===0?n:0}function nt(n){return n==null?"":Cr(n)}var cI=Wi(function(n,i){if(Fs(i)||Er(i)){sn(i,Yt(i),n);return}for(var a in i)it.call(i,a)&&As(n,a,i[a])}),vg=Wi(function(n,i){sn(i,Dr(i),n)}),va=Wi(function(n,i,a,f){sn(i,Dr(i),n,f)}),uI=Wi(function(n,i,a,f){sn(i,Yt(i),n,f)}),hI=En(mu);function fI(n,i){var a=Ki(n);return i==null?a:Jd(a,i)}var lI=Ke(function(n,i){n=ht(n);var a=-1,f=i.length,g=f>2?i[2]:t;for(g&&pr(i[0],i[1],g)&&(f=1);++a<f;)for(var w=i[a],O=Dr(w),N=-1,q=O.length;++N<q;){var Q=O[N],Z=n[Q];(Z===t||Jr(Z,Hi[Q])&&!it.call(n,Q))&&(n[Q]=w[Q])}return n}),dI=Ke(function(n){return n.push(t,Fp),kt(wg,t,n)});function pI(n,i){return Td(n,we(i,3),nn)}function gI(n,i){return Td(n,we(i,3),Eu)}function yI(n,i){return n==null?n:bu(n,we(i,3),Dr)}function _I(n,i){return n==null?n:tp(n,we(i,3),Dr)}function vI(n,i){return n&&nn(n,we(i,3))}function wI(n,i){return n&&Eu(n,we(i,3))}function mI(n){return n==null?[]:Zo(n,Yt(n))}function bI(n){return n==null?[]:Zo(n,Dr(n))}function eh(n,i,a){var f=n==null?t:di(n,i);return f===t?a:f}function EI(n,i){return n!=null&&Mp(n,i,WD)}function th(n,i){return n!=null&&Mp(n,i,GD)}var DI=Cp(function(n,i,a){i!=null&&typeof i.toString!="function"&&(i=Bo.call(i)),n[i]=a},nh(Sr)),SI=Cp(function(n,i,a){i!=null&&typeof i.toString!="function"&&(i=Bo.call(i)),it.call(n,i)?n[i].push(a):n[i]=[a]},we),xI=Ke(Ts);function Yt(n){return Er(n)?kd(n):Iu(n)}function Dr(n){return Er(n)?kd(n,!0):r6(n)}function II(n,i){var a={};return i=we(i,3),nn(n,function(f,g,w){mn(a,i(f,g,w),f)}),a}function OI(n,i){var a={};return i=we(i,3),nn(n,function(f,g,w){mn(a,g,i(f,g,w))}),a}var PI=Wi(function(n,i,a){ea(n,i,a)}),wg=Wi(function(n,i,a,f){ea(n,i,a,f)}),AI=En(function(n,i){var a={};if(n==null)return a;var f=!1;i=mt(i,function(w){return w=Bn(w,n),f||(f=w.length>1),w}),sn(n,Bu(n),a),f&&(a=Br(a,D|S|P,D6));for(var g=i.length;g--;)Ru(a,i[g]);return a});function CI(n,i){return mg(n,ga(we(i)))}var TI=En(function(n,i){return n==null?{}:i6(n,i)});function mg(n,i){if(n==null)return{};var a=mt(Bu(n),function(f){return[f]});return i=we(i),fp(n,a,function(f,g){return i(f,g[0])})}function RI(n,i,a){i=Bn(i,n);var f=-1,g=i.length;for(g||(g=1,n=t);++f<g;){var w=n==null?t:n[on(i[f])];w===t&&(f=g,w=a),n=Sn(w)?w.call(n):w}return n}function NI(n,i,a){return n==null?n:Ns(n,i,a)}function LI(n,i,a,f){return f=typeof f=="function"?f:t,n==null?n:Ns(n,i,a,f)}var bg=Np(Yt),Eg=Np(Dr);function FI(n,i,a){var f=Re(n),g=f||jn(n)||ki(n);if(i=we(i,4),a==null){var w=n&&n.constructor;g?a=f?new w:[]:Dt(n)?a=Sn(w)?Ki(zo(n)):{}:a={}}return(g?Ur:nn)(n,function(O,N,q){return i(a,O,N,q)}),a}function $I(n,i){return n==null?!0:Ru(n,i)}function UI(n,i,a){return n==null?n:yp(n,i,Fu(a))}function MI(n,i,a,f){return f=typeof f=="function"?f:t,n==null?n:yp(n,i,Fu(a),f)}function Yi(n){return n==null?[]:du(n,Yt(n))}function qI(n){return n==null?[]:du(n,Dr(n))}function BI(n,i,a){return a===t&&(a=i,i=t),a!==t&&(a=zr(a),a=a===a?a:0),i!==t&&(i=zr(i),i=i===i?i:0),li(zr(n),i,a)}function HI(n,i,a){return i=xn(i),a===t?(a=i,i=0):a=xn(a),n=zr(n),VD(n,i,a)}function jI(n,i,a){if(a&&typeof a!="boolean"&&pr(n,i,a)&&(i=a=t),a===t&&(typeof i=="boolean"?(a=i,i=t):typeof n=="boolean"&&(a=n,n=t)),n===t&&i===t?(n=0,i=1):(n=xn(n),i===t?(i=n,n=0):i=xn(i)),n>i){var f=n;n=i,i=f}if(a||n%1||i%1){var g=Gd();return rr(n+g*(i-n+ct("1e-"+((g+"").length-1))),i)}return Au(n,i)}var zI=Gi(function(n,i,a){return i=i.toLowerCase(),n+(a?Dg(i):i)});function Dg(n){return rh(nt(n).toLowerCase())}function Sg(n){return n=nt(n),n&&n.replace(yn,N2).replace(iu,"")}function KI(n,i,a){n=nt(n),i=Cr(i);var f=n.length;a=a===t?f:li(Me(a),0,f);var g=a;return a-=i.length,a>=0&&n.slice(a,g)==i}function WI(n){return n=nt(n),n&&vt.test(n)?n.replace(ni,L2):n}function GI(n){return n=nt(n),n&&qt.test(n)?n.replace(Ot,"\\$&"):n}var VI=Gi(function(n,i,a){return n+(a?"-":"")+i.toLowerCase()}),kI=Gi(function(n,i,a){return n+(a?" ":"")+i.toLowerCase()}),YI=Op("toLowerCase");function JI(n,i,a){n=nt(n),i=Me(i);var f=i?qi(n):0;if(!i||f>=i)return n;var g=(i-f)/2;return oa(Vo(g),a)+n+oa(Go(g),a)}function XI(n,i,a){n=nt(n),i=Me(i);var f=i?qi(n):0;return i&&f<i?n+oa(i-f,a):n}function QI(n,i,a){n=nt(n),i=Me(i);var f=i?qi(n):0;return i&&f<i?oa(i-f,a)+n:n}function ZI(n,i,a){return a||i==null?i=0:i&&(i=+i),oD(nt(n).replace(Pt,""),i||0)}function e5(n,i,a){return(a?pr(n,i,a):i===t)?i=1:i=Me(i),Cu(nt(n),i)}function t5(){var n=arguments,i=nt(n[0]);return n.length<3?i:i.replace(n[1],n[2])}var r5=Gi(function(n,i,a){return n+(a?"_":"")+i.toLowerCase()});function n5(n,i,a){return a&&typeof a!="number"&&pr(n,i,a)&&(i=a=t),a=a===t?re:a>>>0,a?(n=nt(n),n&&(typeof i=="string"||i!=null&&!Zu(i))&&(i=Cr(i),!i&&Mi(n))?Hn(kr(n),0,a):n.split(i,a)):[]}var i5=Gi(function(n,i,a){return n+(a?" ":"")+rh(i)});function s5(n,i,a){return n=nt(n),a=a==null?0:li(Me(a),0,n.length),i=Cr(i),n.slice(a,a+i.length)==i}function o5(n,i,a){var f=v.templateSettings;a&&pr(n,i,a)&&(i=t),n=nt(n),i=va({},i,f,Lp);var g=va({},i.imports,f.imports,Lp),w=Yt(g),O=du(g,w),N,q,Q=0,Z=i.interpolate||Ci,ie="__p += '",he=gu((i.escape||Ci).source+"|"+Z.source+"|"+(Z===Et?Hc:Ci).source+"|"+(i.evaluate||Ci).source+"|$","g"),ye="//# sourceURL="+(it.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++su+"]")+`
`;n.replace(he,function(De,Ve,Ze,Rr,gr,Nr){return Ze||(Ze=Rr),ie+=n.slice(Q,Nr).replace(Vc,F2),Ve&&(N=!0,ie+=`' +
__e(`+Ve+`) +
'`),gr&&(q=!0,ie+=`';
`+gr+`;
__p += '`),Ze&&(ie+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),Q=Nr+De.length,De}),ie+=`';
`;var Ee=it.call(i,"variable")&&i.variable;if(!Ee)ie=`with (obj) {
`+ie+`
}
`;else if(qc.test(Ee))throw new Ce(l);ie=(q?ie.replace(en,""):ie).replace(fr,"$1").replace(gn,"$1;"),ie="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(N?", __e = _.escape":"")+(q?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ie+`return __p
}`;var He=Ig(function(){return rt(w,ye+"return "+ie).apply(t,O)});if(He.source=ie,Qu(He))throw He;return He}function a5(n){return nt(n).toLowerCase()}function c5(n){return nt(n).toUpperCase()}function u5(n,i,a){if(n=nt(n),n&&(a||i===t))return Fd(n);if(!n||!(i=Cr(i)))return n;var f=kr(n),g=kr(i),w=$d(f,g),O=Ud(f,g)+1;return Hn(f,w,O).join("")}function h5(n,i,a){if(n=nt(n),n&&(a||i===t))return n.slice(0,qd(n)+1);if(!n||!(i=Cr(i)))return n;var f=kr(n),g=Ud(f,kr(i))+1;return Hn(f,0,g).join("")}function f5(n,i,a){if(n=nt(n),n&&(a||i===t))return n.replace(Pt,"");if(!n||!(i=Cr(i)))return n;var f=kr(n),g=$d(f,kr(i));return Hn(f,g).join("")}function l5(n,i){var a=Y,f=se;if(Dt(i)){var g="separator"in i?i.separator:g;a="length"in i?Me(i.length):a,f="omission"in i?Cr(i.omission):f}n=nt(n);var w=n.length;if(Mi(n)){var O=kr(n);w=O.length}if(a>=w)return n;var N=a-qi(f);if(N<1)return f;var q=O?Hn(O,0,N).join(""):n.slice(0,N);if(g===t)return q+f;if(O&&(N+=q.length-N),Zu(g)){if(n.slice(N).search(g)){var Q,Z=q;for(g.global||(g=gu(g.source,nt(Fr.exec(g))+"g")),g.lastIndex=0;Q=g.exec(Z);)var ie=Q.index;q=q.slice(0,ie===t?N:ie)}}else if(n.indexOf(Cr(g),N)!=N){var he=q.lastIndexOf(g);he>-1&&(q=q.slice(0,he))}return q+f}function d5(n){return n=nt(n),n&&St.test(n)?n.replace(Rn,j2):n}var p5=Gi(function(n,i,a){return n+(a?" ":"")+i.toUpperCase()}),rh=Op("toUpperCase");function xg(n,i,a){return n=nt(n),i=a?t:i,i===t?U2(n)?W2(n):P2(n):n.match(i)||[]}var Ig=Ke(function(n,i){try{return kt(n,t,i)}catch(a){return Qu(a)?a:new Ce(a)}}),g5=En(function(n,i){return Ur(i,function(a){a=on(a),mn(n,a,Ju(n[a],n))}),n});function y5(n){var i=n==null?0:n.length,a=we();return n=i?mt(n,function(f){if(typeof f[1]!="function")throw new Mr(u);return[a(f[0]),f[1]]}):[],Ke(function(f){for(var g=-1;++g<i;){var w=n[g];if(kt(w[0],this,f))return kt(w[1],this,f)}})}function _5(n){return jD(Br(n,D))}function nh(n){return function(){return n}}function v5(n,i){return n==null||n!==n?i:n}var w5=Ap(),m5=Ap(!0);function Sr(n){return n}function ih(n){return sp(typeof n=="function"?n:Br(n,D))}function b5(n){return ap(Br(n,D))}function E5(n,i){return cp(n,Br(i,D))}var D5=Ke(function(n,i){return function(a){return Ts(a,n,i)}}),S5=Ke(function(n,i){return function(a){return Ts(n,a,i)}});function sh(n,i,a){var f=Yt(i),g=Zo(i,f);a==null&&!(Dt(i)&&(g.length||!f.length))&&(a=i,i=n,n=this,g=Zo(i,Yt(i)));var w=!(Dt(a)&&"chain"in a)||!!a.chain,O=Sn(n);return Ur(g,function(N){var q=i[N];n[N]=q,O&&(n.prototype[N]=function(){var Q=this.__chain__;if(w||Q){var Z=n(this.__wrapped__),ie=Z.__actions__=br(this.__actions__);return ie.push({func:q,args:arguments,thisArg:n}),Z.__chain__=Q,Z}return q.apply(n,Fn([this.value()],arguments))})}),n}function x5(){return Qe._===this&&(Qe._=X2),this}function oh(){}function I5(n){return n=Me(n),Ke(function(i){return up(i,n)})}var O5=Uu(mt),P5=Uu(Cd),A5=Uu(cu);function Og(n){return Ku(n)?uu(on(n)):s6(n)}function C5(n){return function(i){return n==null?t:di(n,i)}}var T5=Tp(),R5=Tp(!0);function ah(){return[]}function ch(){return!1}function N5(){return{}}function L5(){return""}function F5(){return!0}function $5(n,i){if(n=Me(n),n<1||n>W)return[];var a=re,f=rr(n,re);i=we(i),n-=re;for(var g=lu(f,i);++a<n;)i(a);return g}function U5(n){return Re(n)?mt(n,on):Tr(n)?[n]:br(Vp(nt(n)))}function M5(n){var i=++Y2;return nt(n)+i}var q5=sa(function(n,i){return n+i},0),B5=Mu("ceil"),H5=sa(function(n,i){return n/i},1),j5=Mu("floor");function z5(n){return n&&n.length?Qo(n,Sr,Du):t}function K5(n,i){return n&&n.length?Qo(n,we(i,2),Du):t}function W5(n){return Nd(n,Sr)}function G5(n,i){return Nd(n,we(i,2))}function V5(n){return n&&n.length?Qo(n,Sr,Ou):t}function k5(n,i){return n&&n.length?Qo(n,we(i,2),Ou):t}var Y5=sa(function(n,i){return n*i},1),J5=Mu("round"),X5=sa(function(n,i){return n-i},0);function Q5(n){return n&&n.length?fu(n,Sr):0}function Z5(n,i){return n&&n.length?fu(n,we(i,2)):0}return v.after=bx,v.ary=ig,v.assign=cI,v.assignIn=vg,v.assignInWith=va,v.assignWith=uI,v.at=hI,v.before=sg,v.bind=Ju,v.bindAll=g5,v.bindKey=og,v.castArray=Nx,v.chain=tg,v.chunk=j6,v.compact=z6,v.concat=K6,v.cond=y5,v.conforms=_5,v.constant=nh,v.countBy=QS,v.create=fI,v.curry=ag,v.curryRight=cg,v.debounce=ug,v.defaults=lI,v.defaultsDeep=dI,v.defer=Ex,v.delay=Dx,v.difference=W6,v.differenceBy=G6,v.differenceWith=V6,v.drop=k6,v.dropRight=Y6,v.dropRightWhile=J6,v.dropWhile=X6,v.fill=Q6,v.filter=ex,v.flatMap=nx,v.flatMapDeep=ix,v.flatMapDepth=sx,v.flatten=Xp,v.flattenDeep=Z6,v.flattenDepth=eS,v.flip=Sx,v.flow=w5,v.flowRight=m5,v.fromPairs=tS,v.functions=mI,v.functionsIn=bI,v.groupBy=ox,v.initial=nS,v.intersection=iS,v.intersectionBy=sS,v.intersectionWith=oS,v.invert=DI,v.invertBy=SI,v.invokeMap=cx,v.iteratee=ih,v.keyBy=ux,v.keys=Yt,v.keysIn=Dr,v.map=la,v.mapKeys=II,v.mapValues=OI,v.matches=b5,v.matchesProperty=E5,v.memoize=pa,v.merge=PI,v.mergeWith=wg,v.method=D5,v.methodOf=S5,v.mixin=sh,v.negate=ga,v.nthArg=I5,v.omit=AI,v.omitBy=CI,v.once=xx,v.orderBy=hx,v.over=O5,v.overArgs=Ix,v.overEvery=P5,v.overSome=A5,v.partial=Xu,v.partialRight=hg,v.partition=fx,v.pick=TI,v.pickBy=mg,v.property=Og,v.propertyOf=C5,v.pull=hS,v.pullAll=Zp,v.pullAllBy=fS,v.pullAllWith=lS,v.pullAt=dS,v.range=T5,v.rangeRight=R5,v.rearg=Ox,v.reject=px,v.remove=pS,v.rest=Px,v.reverse=ku,v.sampleSize=yx,v.set=NI,v.setWith=LI,v.shuffle=_x,v.slice=gS,v.sortBy=mx,v.sortedUniq=ES,v.sortedUniqBy=DS,v.split=n5,v.spread=Ax,v.tail=SS,v.take=xS,v.takeRight=IS,v.takeRightWhile=OS,v.takeWhile=PS,v.tap=zS,v.throttle=Cx,v.thru=fa,v.toArray=gg,v.toPairs=bg,v.toPairsIn=Eg,v.toPath=U5,v.toPlainObject=_g,v.transform=FI,v.unary=Tx,v.union=AS,v.unionBy=CS,v.unionWith=TS,v.uniq=RS,v.uniqBy=NS,v.uniqWith=LS,v.unset=$I,v.unzip=Yu,v.unzipWith=eg,v.update=UI,v.updateWith=MI,v.values=Yi,v.valuesIn=qI,v.without=FS,v.words=xg,v.wrap=Rx,v.xor=$S,v.xorBy=US,v.xorWith=MS,v.zip=qS,v.zipObject=BS,v.zipObjectDeep=HS,v.zipWith=jS,v.entries=bg,v.entriesIn=Eg,v.extend=vg,v.extendWith=va,sh(v,v),v.add=q5,v.attempt=Ig,v.camelCase=zI,v.capitalize=Dg,v.ceil=B5,v.clamp=BI,v.clone=Lx,v.cloneDeep=$x,v.cloneDeepWith=Ux,v.cloneWith=Fx,v.conformsTo=Mx,v.deburr=Sg,v.defaultTo=v5,v.divide=H5,v.endsWith=KI,v.eq=Jr,v.escape=WI,v.escapeRegExp=GI,v.every=ZS,v.find=tx,v.findIndex=Yp,v.findKey=pI,v.findLast=rx,v.findLastIndex=Jp,v.findLastKey=gI,v.floor=j5,v.forEach=rg,v.forEachRight=ng,v.forIn=yI,v.forInRight=_I,v.forOwn=vI,v.forOwnRight=wI,v.get=eh,v.gt=qx,v.gte=Bx,v.has=EI,v.hasIn=th,v.head=Qp,v.identity=Sr,v.includes=ax,v.indexOf=rS,v.inRange=HI,v.invoke=xI,v.isArguments=yi,v.isArray=Re,v.isArrayBuffer=Hx,v.isArrayLike=Er,v.isArrayLikeObject=Lt,v.isBoolean=jx,v.isBuffer=jn,v.isDate=zx,v.isElement=Kx,v.isEmpty=Wx,v.isEqual=Gx,v.isEqualWith=Vx,v.isError=Qu,v.isFinite=kx,v.isFunction=Sn,v.isInteger=fg,v.isLength=ya,v.isMap=lg,v.isMatch=Yx,v.isMatchWith=Jx,v.isNaN=Xx,v.isNative=Qx,v.isNil=eI,v.isNull=Zx,v.isNumber=dg,v.isObject=Dt,v.isObjectLike=Ct,v.isPlainObject=Us,v.isRegExp=Zu,v.isSafeInteger=tI,v.isSet=pg,v.isString=_a,v.isSymbol=Tr,v.isTypedArray=ki,v.isUndefined=rI,v.isWeakMap=nI,v.isWeakSet=iI,v.join=aS,v.kebabCase=VI,v.last=jr,v.lastIndexOf=cS,v.lowerCase=kI,v.lowerFirst=YI,v.lt=sI,v.lte=oI,v.max=z5,v.maxBy=K5,v.mean=W5,v.meanBy=G5,v.min=V5,v.minBy=k5,v.stubArray=ah,v.stubFalse=ch,v.stubObject=N5,v.stubString=L5,v.stubTrue=F5,v.multiply=Y5,v.nth=uS,v.noConflict=x5,v.noop=oh,v.now=da,v.pad=JI,v.padEnd=XI,v.padStart=QI,v.parseInt=ZI,v.random=jI,v.reduce=lx,v.reduceRight=dx,v.repeat=e5,v.replace=t5,v.result=RI,v.round=J5,v.runInContext=$,v.sample=gx,v.size=vx,v.snakeCase=r5,v.some=wx,v.sortedIndex=yS,v.sortedIndexBy=_S,v.sortedIndexOf=vS,v.sortedLastIndex=wS,v.sortedLastIndexBy=mS,v.sortedLastIndexOf=bS,v.startCase=i5,v.startsWith=s5,v.subtract=X5,v.sum=Q5,v.sumBy=Z5,v.template=o5,v.times=$5,v.toFinite=xn,v.toInteger=Me,v.toLength=yg,v.toLower=a5,v.toNumber=zr,v.toSafeInteger=aI,v.toString=nt,v.toUpper=c5,v.trim=u5,v.trimEnd=h5,v.trimStart=f5,v.truncate=l5,v.unescape=d5,v.uniqueId=M5,v.upperCase=p5,v.upperFirst=rh,v.each=rg,v.eachRight=ng,v.first=Qp,sh(v,function(){var n={};return nn(v,function(i,a){it.call(v.prototype,a)||(n[a]=i)}),n}(),{chain:!1}),v.VERSION=s,Ur(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){v[n].placeholder=v}),Ur(["drop","take"],function(n,i){Je.prototype[n]=function(a){a=a===t?1:Wt(Me(a),0);var f=this.__filtered__&&!i?new Je(this):this.clone();return f.__filtered__?f.__takeCount__=rr(a,f.__takeCount__):f.__views__.push({size:rr(a,re),type:n+(f.__dir__<0?"Right":"")}),f},Je.prototype[n+"Right"]=function(a){return this.reverse()[n](a).reverse()}}),Ur(["filter","map","takeWhile"],function(n,i){var a=i+1,f=a==b||a==ee;Je.prototype[n]=function(g){var w=this.clone();return w.__iteratees__.push({iteratee:we(g,3),type:a}),w.__filtered__=w.__filtered__||f,w}}),Ur(["head","last"],function(n,i){var a="take"+(i?"Right":"");Je.prototype[n]=function(){return this[a](1).value()[0]}}),Ur(["initial","tail"],function(n,i){var a="drop"+(i?"":"Right");Je.prototype[n]=function(){return this.__filtered__?new Je(this):this[a](1)}}),Je.prototype.compact=function(){return this.filter(Sr)},Je.prototype.find=function(n){return this.filter(n).head()},Je.prototype.findLast=function(n){return this.reverse().find(n)},Je.prototype.invokeMap=Ke(function(n,i){return typeof n=="function"?new Je(this):this.map(function(a){return Ts(a,n,i)})}),Je.prototype.reject=function(n){return this.filter(ga(we(n)))},Je.prototype.slice=function(n,i){n=Me(n);var a=this;return a.__filtered__&&(n>0||i<0)?new Je(a):(n<0?a=a.takeRight(-n):n&&(a=a.drop(n)),i!==t&&(i=Me(i),a=i<0?a.dropRight(-i):a.take(i-n)),a)},Je.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},Je.prototype.toArray=function(){return this.take(re)},nn(Je.prototype,function(n,i){var a=/^(?:filter|find|map|reject)|While$/.test(i),f=/^(?:head|last)$/.test(i),g=v[f?"take"+(i=="last"?"Right":""):i],w=f||/^find/.test(i);g&&(v.prototype[i]=function(){var O=this.__wrapped__,N=f?[1]:arguments,q=O instanceof Je,Q=N[0],Z=q||Re(O),ie=function(Ve){var Ze=g.apply(v,Fn([Ve],N));return f&&he?Ze[0]:Ze};Z&&a&&typeof Q=="function"&&Q.length!=1&&(q=Z=!1);var he=this.__chain__,ye=!!this.__actions__.length,Ee=w&&!he,He=q&&!ye;if(!w&&Z){O=He?O:new Je(this);var De=n.apply(O,N);return De.__actions__.push({func:fa,args:[ie],thisArg:t}),new qr(De,he)}return Ee&&He?n.apply(this,N):(De=this.thru(ie),Ee?f?De.value()[0]:De.value():De)})}),Ur(["pop","push","shift","sort","splice","unshift"],function(n){var i=Uo[n],a=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",f=/^(?:pop|shift)$/.test(n);v.prototype[n]=function(){var g=arguments;if(f&&!this.__chain__){var w=this.value();return i.apply(Re(w)?w:[],g)}return this[a](function(O){return i.apply(Re(O)?O:[],g)})}}),nn(Je.prototype,function(n,i){var a=v[i];if(a){var f=a.name+"";it.call(zi,f)||(zi[f]=[]),zi[f].push({name:i,func:a})}}),zi[ia(t,ne).name]=[{name:"wrapper",func:t}],Je.prototype.clone=dD,Je.prototype.reverse=pD,Je.prototype.value=gD,v.prototype.at=KS,v.prototype.chain=WS,v.prototype.commit=GS,v.prototype.next=VS,v.prototype.plant=YS,v.prototype.reverse=JS,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=XS,v.prototype.first=v.prototype.head,Ss&&(v.prototype[Ss]=kS),v},Bi=G2();Nt?((Nt.exports=Bi)._=Bi,ut._=Bi):Qe._=Bi}).call($t)})(Lc,Lc.exports);var e2=Object.defineProperty,t2=Object.defineProperties,r2=Object.getOwnPropertyDescriptors,wd=Object.getOwnPropertySymbols,n2=Object.prototype.hasOwnProperty,i2=Object.prototype.propertyIsEnumerable,md=(r,e,t)=>e in r?e2(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,fo=(r,e)=>{for(var t in e||(e={}))n2.call(e,t)&&md(r,t,e[t]);if(wd)for(var t of wd(e))i2.call(e,t)&&md(r,t,e[t]);return r},s2=(r,e)=>t2(r,r2(e));function Cn(r,e,t){var s;const o=J1(r);return((s=e.rpcMap)==null?void 0:s[o.reference])||`${Z3}?chainId=${o.namespace}:${o.reference}&projectId=${t}`}function ri(r){return r.includes(":")?r.split(":")[1]:r}function bd(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function o2(r,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(r));if(!t.length)return[];const s=[];return t.forEach(o=>{const c=e.namespaces[o].accounts;s.push(...c)}),s}function Ed(r={},e={}){const t=Dd(r),s=Dd(e);return Lc.exports.merge(t,s)}function Dd(r){var e,t,s,o;const c={};if(!ls(r))return c;for(const[u,l]of Object.entries(r)){const y=fc(u)?[u]:l.chains,p=l.methods||[],_=l.events||[],D=l.rpcMap||{},S=fs(u);c[S]=s2(fo(fo({},c[S]),l),{chains:uc(y,(e=c[S])==null?void 0:e.chains),methods:uc(p,(t=c[S])==null?void 0:t.methods),events:uc(_,(s=c[S])==null?void 0:s.events),rpcMap:fo(fo({},D),(o=c[S])==null?void 0:o.rpcMap)})}return c}function a2(r){return r.includes(":")?r.split(":")[2]:r}function c2(r){const e={};for(const[t,s]of Object.entries(r)){const o=s.methods||[],c=s.events||[],u=s.accounts||[],l=fc(t)?[t]:s.chains?s.chains:bd(s.accounts);e[t]={chains:l,methods:o,events:c,accounts:u}}return e}function Fc(r){return typeof r=="number"?r:r.includes("0x")?parseInt(r,16):(r=r.includes(":")?r.split(":")[1]:r,isNaN(Number(r))?r:Number(r))}const Sd={},gt=r=>Sd[r],$c=(r,e)=>{Sd[r]=e};var Uc={exports:{}};(function(r,e){var t=typeof self<"u"?self:$t,s=function(){function c(){this.fetch=!1,this.DOMException=t.DOMException}return c.prototype=t,new c}();(function(c){(function(u){var l={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function y(b){return b&&DataView.prototype.isPrototypeOf(b)}if(l.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=ArrayBuffer.isView||function(b){return b&&p.indexOf(Object.prototype.toString.call(b))>-1};function D(b){if(typeof b!="string"&&(b=String(b)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(b))throw new TypeError("Invalid character in header field name");return b.toLowerCase()}function S(b){return typeof b!="string"&&(b=String(b)),b}function P(b){var C={next:function(){var ee=b.shift();return{done:ee===void 0,value:ee}}};return l.iterable&&(C[Symbol.iterator]=function(){return C}),C}function I(b){this.map={},b instanceof I?b.forEach(function(C,ee){this.append(ee,C)},this):Array.isArray(b)?b.forEach(function(C){this.append(C[0],C[1])},this):b&&Object.getOwnPropertyNames(b).forEach(function(C){this.append(C,b[C])},this)}I.prototype.append=function(b,C){b=D(b),C=S(C);var ee=this.map[b];this.map[b]=ee?ee+", "+C:C},I.prototype.delete=function(b){delete this.map[D(b)]},I.prototype.get=function(b){return b=D(b),this.has(b)?this.map[b]:null},I.prototype.has=function(b){return this.map.hasOwnProperty(D(b))},I.prototype.set=function(b,C){this.map[D(b)]=S(C)},I.prototype.forEach=function(b,C){for(var ee in this.map)this.map.hasOwnProperty(ee)&&b.call(C,this.map[ee],ee,this)},I.prototype.keys=function(){var b=[];return this.forEach(function(C,ee){b.push(ee)}),P(b)},I.prototype.values=function(){var b=[];return this.forEach(function(C){b.push(C)}),P(b)},I.prototype.entries=function(){var b=[];return this.forEach(function(C,ee){b.push([ee,C])}),P(b)},l.iterable&&(I.prototype[Symbol.iterator]=I.prototype.entries);function B(b){if(b.bodyUsed)return Promise.reject(new TypeError("Already read"));b.bodyUsed=!0}function z(b){return new Promise(function(C,ee){b.onload=function(){C(b.result)},b.onerror=function(){ee(b.error)}})}function ne(b){var C=new FileReader,ee=z(C);return C.readAsArrayBuffer(b),ee}function L(b){var C=new FileReader,ee=z(C);return C.readAsText(b),ee}function M(b){for(var C=new Uint8Array(b),ee=new Array(C.length),X=0;X<C.length;X++)ee[X]=String.fromCharCode(C[X]);return ee.join("")}function A(b){if(b.slice)return b.slice(0);var C=new Uint8Array(b.byteLength);return C.set(new Uint8Array(b)),C.buffer}function T(){return this.bodyUsed=!1,this._initBody=function(b){this._bodyInit=b,b?typeof b=="string"?this._bodyText=b:l.blob&&Blob.prototype.isPrototypeOf(b)?this._bodyBlob=b:l.formData&&FormData.prototype.isPrototypeOf(b)?this._bodyFormData=b:l.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)?this._bodyText=b.toString():l.arrayBuffer&&l.blob&&y(b)?(this._bodyArrayBuffer=A(b.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(b)||_(b))?this._bodyArrayBuffer=A(b):this._bodyText=b=Object.prototype.toString.call(b):this._bodyText="",this.headers.get("content-type")||(typeof b=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):l.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l.blob&&(this.blob=function(){var b=B(this);if(b)return b;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?B(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ne)}),this.text=function(){var b=B(this);if(b)return b;if(this._bodyBlob)return L(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(M(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},l.formData&&(this.formData=function(){return this.text().then(V)}),this.json=function(){return this.text().then(JSON.parse)},this}var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function h(b){var C=b.toUpperCase();return E.indexOf(C)>-1?C:b}function m(b,C){C=C||{};var ee=C.body;if(b instanceof m){if(b.bodyUsed)throw new TypeError("Already read");this.url=b.url,this.credentials=b.credentials,C.headers||(this.headers=new I(b.headers)),this.method=b.method,this.mode=b.mode,this.signal=b.signal,!ee&&b._bodyInit!=null&&(ee=b._bodyInit,b.bodyUsed=!0)}else this.url=String(b);if(this.credentials=C.credentials||this.credentials||"same-origin",(C.headers||!this.headers)&&(this.headers=new I(C.headers)),this.method=h(C.method||this.method||"GET"),this.mode=C.mode||this.mode||null,this.signal=C.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ee)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ee)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})};function V(b){var C=new FormData;return b.trim().split("&").forEach(function(ee){if(ee){var X=ee.split("="),W=X.shift().replace(/\+/g," "),G=X.join("=").replace(/\+/g," ");C.append(decodeURIComponent(W),decodeURIComponent(G))}}),C}function Y(b){var C=new I,ee=b.replace(/\r?\n[\t ]+/g," ");return ee.split(/\r?\n/).forEach(function(X){var W=X.split(":"),G=W.shift().trim();if(G){var J=W.join(":").trim();C.append(G,J)}}),C}T.call(m.prototype);function se(b,C){C||(C={}),this.type="default",this.status=C.status===void 0?200:C.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in C?C.statusText:"OK",this.headers=new I(C.headers),this.url=C.url||"",this._initBody(b)}T.call(se.prototype),se.prototype.clone=function(){return new se(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new I(this.headers),url:this.url})},se.error=function(){var b=new se(null,{status:0,statusText:""});return b.type="error",b};var ue=[301,302,303,307,308];se.redirect=function(b,C){if(ue.indexOf(C)===-1)throw new RangeError("Invalid status code");return new se(null,{status:C,headers:{location:b}})},u.DOMException=c.DOMException;try{new u.DOMException}catch{u.DOMException=function(C,ee){this.message=C,this.name=ee;var X=Error(C);this.stack=X.stack},u.DOMException.prototype=Object.create(Error.prototype),u.DOMException.prototype.constructor=u.DOMException}function de(b,C){return new Promise(function(ee,X){var W=new m(b,C);if(W.signal&&W.signal.aborted)return X(new u.DOMException("Aborted","AbortError"));var G=new XMLHttpRequest;function J(){G.abort()}G.onload=function(){var re={status:G.status,statusText:G.statusText,headers:Y(G.getAllResponseHeaders()||"")};re.url="responseURL"in G?G.responseURL:re.headers.get("X-Request-URL");var me="response"in G?G.response:G.responseText;ee(new se(me,re))},G.onerror=function(){X(new TypeError("Network request failed"))},G.ontimeout=function(){X(new TypeError("Network request failed"))},G.onabort=function(){X(new u.DOMException("Aborted","AbortError"))},G.open(W.method,W.url,!0),W.credentials==="include"?G.withCredentials=!0:W.credentials==="omit"&&(G.withCredentials=!1),"responseType"in G&&l.blob&&(G.responseType="blob"),W.headers.forEach(function(re,me){G.setRequestHeader(me,re)}),W.signal&&(W.signal.addEventListener("abort",J),G.onreadystatechange=function(){G.readyState===4&&W.signal.removeEventListener("abort",J)}),G.send(typeof W._bodyInit>"u"?null:W._bodyInit)})}return de.polyfill=!0,c.fetch||(c.fetch=de,c.Headers=I,c.Request=m,c.Response=se),u.Headers=I,u.Request=m,u.Response=se,u.fetch=de,Object.defineProperty(u,"__esModule",{value:!0}),u})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;e=o.fetch,e.default=o.fetch,e.fetch=o.fetch,e.Headers=o.Headers,e.Request=o.Request,e.Response=o.Response,r.exports=e})(Uc,Uc.exports);var xd=Ag(Uc.exports);const Id={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"},Od=10;class Tn{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Zt.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!Sl(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const s=Gn(e),c=await(await xd(this.url,Object.assign(Object.assign({},Id),{body:s}))).json();this.onPayload({data:c})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!Sl(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=Gn({id:1,jsonrpc:"2.0",method:"test",params:[]});await xd(e,Object.assign(Object.assign({},Id),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Xi(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=oo(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return _l(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Od&&this.events.setMaxListeners(Od)}}class u2{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=gt("events"),this.client=gt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(pn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=ri(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Cn(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new hn(new Tn(s,gt("disableProviderPing")))}}class h2{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=gt("events"),this.client=gt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(pn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||Cn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new hn(new Tn(s,gt("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=parseInt(ri(t));e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class f2{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=gt("events"),this.client=gt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(pn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=ri(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Cn(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new hn(new Tn(s,gt("disableProviderPing")))}}class l2{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=gt("events"),this.client=gt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(pn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=ri(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Cn(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new hn(new Tn(s,gt("disableProviderPing")))}}class d2{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=gt("events"),this.client=gt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(pn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t),o=ri(t);e[o]=this.createHttpProvider(o,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new hn(new Tn(s,gt("disableProviderPing")))}}class p2{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=gt("events"),this.client=gt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(pn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=ri(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Cn(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new hn(new Tn(s,gt("disableProviderPing")))}}class g2{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=gt("events"),this.client=gt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(pn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=ri(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Cn(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new hn(new Tn(s,gt("disableProviderPing")))}}class y2{constructor(e){this.name="near",this.namespace=e.namespace,this.events=gt("events"),this.client=gt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||Cn(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(pn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Cn(e,this.namespace);return typeof s>"u"?void 0:new hn(new Tn(s,gt("disableProviderPing")))}}var _2=Object.defineProperty,v2=Object.defineProperties,w2=Object.getOwnPropertyDescriptors,Pd=Object.getOwnPropertySymbols,m2=Object.prototype.hasOwnProperty,b2=Object.prototype.propertyIsEnumerable,Ad=(r,e,t)=>e in r?_2(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,lo=(r,e)=>{for(var t in e||(e={}))m2.call(e,t)&&Ad(r,t,e[t]);if(Pd)for(var t of Pd(e))b2.call(e,t)&&Ad(r,t,e[t]);return r},Mc=(r,e)=>v2(r,w2(e));class po{constructor(e){this.events=new Zt.exports,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:ke.pino(ke.getDefaultLoggerOptions({level:e?.logger||_d})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){const t=new po(e);return await t.initialize(),t}async request(e,t,s){const[o,c]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(o).request({request:lo({},e),chainId:`${o}:${c}`,topic:this.session.topic,expiry:s})}sendAsync(e,t,s,o){const c=new Date().getTime();this.request(e,s,o).then(u=>t(null,so(c,u))).catch(u=>t(u,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:bt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c;const u=c2(c.namespaces);this.namespaces=Ed(this.namespaces,u),this.persist("namespaces",this.namespaces)}).catch(c=>{if(c.message!==pd)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(ti(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Nc.init({logger:this.providerOpts.logger||_d,relayUrl:this.providerOpts.relayUrl||J3,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>fs(t)))];$c("client",this.client),$c("events",this.events),$c("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=o2(t,this.session),o=bd(s),c=Ed(this.namespaces,this.optionalNamespaces),u=Mc(lo({},c[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new h2({namespace:u});break;case"solana":this.rpcProviders[t]=new f2({namespace:u});break;case"cosmos":this.rpcProviders[t]=new l2({namespace:u});break;case"polkadot":this.rpcProviders[t]=new u2({namespace:u});break;case"cip34":this.rpcProviders[t]=new d2({namespace:u});break;case"elrond":this.rpcProviders[t]=new p2({namespace:u});break;case"multiversx":this.rpcProviders[t]=new g2({namespace:u});break;case"near":this.rpcProviders[t]=new y2({namespace:u});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const o=s.data;o&&ti(o)&&this.events.emit("accountsChanged",o.map(a2))}else if(s.name==="chainChanged"){const o=t.chainId,c=t.event.data,u=fs(o),l=Fc(o)!==Fc(c)?`${u}:${Fc(c)}`:o;this.onChainChanged(l)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,c=(s=this.client)==null?void 0:s.session.get(e);this.session=Mc(lo({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Mc(lo({},bt("USER_DISCONNECTED")),{data:e.topic}))}),this.on(pn.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(u=>fs(u)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=fs(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){if(!this.namespaces)return;const[s,o]=this.validateChain(e);o&&(t||this.getProvider(s).setDefaultChain(o),this.namespaces[s]?this.namespaces[s].defaultChain=o:this.namespaces[`${s}:${o}`]?this.namespaces[`${s}:${o}`].defaultChain=o:this.namespaces[`${s}:${o}`]={defaultChain:o},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",o))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${vd}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${vd}/${e}`)}}const E2=po;zn.UniversalProvider=E2,zn.default=po,Object.defineProperty(zn,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
