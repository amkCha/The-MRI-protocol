"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.registerTerminateHandler = void 0;
const terminateEvents = ['SIGINT', 'SIGTERM'];
let eventListenerRegistered = false;
const terminateHandlers = new Set();
function registerEventListener() {
    for (const eventName of terminateEvents) {
        globalThis.process?.once(eventName, () => {
            for (const handler of terminateHandlers) {
                handler(eventName);
                terminateHandlers.delete(handler);
            }
        });
    }
}
function registerTerminateHandler(callback) {
    if (!eventListenerRegistered) {
        registerEventListener();
        eventListenerRegistered = true;
    }
    terminateHandlers.add(callback);
    return () => {
        terminateHandlers.delete(callback);
    };
}
exports.registerTerminateHandler = registerTerminateHandler;
