(function(Se,ht){typeof exports=="object"&&typeof module<"u"?ht(exports):typeof define=="function"&&define.amd?define(["exports"],ht):(Se=typeof globalThis<"u"?globalThis:Se||self,ht(Se["@walletconnect/sign-client"]={}))})(this,function(Se){"use strict";var ht=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gt(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}var ft={exports:{}},or=typeof Reflect=="object"?Reflect:null,kn=or&&typeof or.apply=="function"?or.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},Wr;or&&typeof or.ownKeys=="function"?Wr=or.ownKeys:Object.getOwnPropertySymbols?Wr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Wr=function(e){return Object.getOwnPropertyNames(e)};function lc(t){console&&console.warn&&console.warn(t)}var Wn=Number.isNaN||function(e){return e!==e};function Oe(){Oe.init.call(this)}ft.exports=Oe,ft.exports.once=pc,Oe.EventEmitter=Oe,Oe.prototype._events=void 0,Oe.prototype._eventsCount=0,Oe.prototype._maxListeners=void 0;var Yn=10;function Yr(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return Yn},set:function(t){if(typeof t!="number"||t<0||Wn(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Yn=t}}),Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Oe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Wn(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Xn(t){return t._maxListeners===void 0?Oe.defaultMaxListeners:t._maxListeners}Oe.prototype.getMaxListeners=function(){return Xn(this)},Oe.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var a;if(r.length>0&&(a=r[0]),a instanceof Error)throw a;var c=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw c.context=a,c}var h=s[e];if(h===void 0)return!1;if(typeof h=="function")kn(h,this,r);else for(var l=h.length,f=ts(h,l),i=0;i<l;++i)kn(f[i],this,r);return!0};function Jn(t,e,r,i){var n,s,a;if(Yr(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),a=s[e]),a===void 0)a=s[e]=r,++t._eventsCount;else if(typeof a=="function"?a=s[e]=i?[r,a]:[a,r]:i?a.unshift(r):a.push(r),n=Xn(t),n>0&&a.length>n&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=a.length,lc(c)}return t}Oe.prototype.addListener=function(e,r){return Jn(this,e,r,!1)},Oe.prototype.on=Oe.prototype.addListener,Oe.prototype.prependListener=function(e,r){return Jn(this,e,r,!0)};function hc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Qn(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=hc.bind(i);return n.listener=r,i.wrapFn=n,n}Oe.prototype.once=function(e,r){return Yr(r),this.on(e,Qn(this,e,r)),this},Oe.prototype.prependOnceListener=function(e,r){return Yr(r),this.prependListener(e,Qn(this,e,r)),this},Oe.prototype.removeListener=function(e,r){var i,n,s,a,c;if(Yr(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,a=i.length-1;a>=0;a--)if(i[a]===r||i[a].listener===r){c=i[a].listener,s=a;break}if(s<0)return this;s===0?i.shift():fc(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,c||r)}return this},Oe.prototype.off=Oe.prototype.removeListener,Oe.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),a;for(n=0;n<s.length;++n)a=s[n],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function Zn(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?dc(n):ts(n,n.length)}Oe.prototype.listeners=function(e){return Zn(this,e,!0)},Oe.prototype.rawListeners=function(e){return Zn(this,e,!1)},Oe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):es.call(t,e)},Oe.prototype.listenerCount=es;function es(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?Wr(this._events):[]};function ts(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function fc(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function dc(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function pc(t,e){return new Promise(function(r,i){function n(a){t.removeListener(e,s),i(a)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}rs(t,e,s,{once:!0}),e!=="error"&&gc(t,n,{once:!0})})}function gc(t,e,r){typeof t.on=="function"&&rs(t,"error",e,r)}function rs(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}const yc=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,_c=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,bc=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function wc(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){mc(t);return}return e}function mc(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function Xr(t,e={}){if(typeof t!="string")return t;const r=t.trim();if(t[0]==='"'&&t.at(-1)==='"'&&!t.includes("\\"))return r.slice(1,-1);if(r.length<=9){const i=r.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;if(i==="undefined")return;if(i==="null")return null;if(i==="nan")return Number.NaN;if(i==="infinity")return Number.POSITIVE_INFINITY;if(i==="-infinity")return Number.NEGATIVE_INFINITY}if(!bc.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(yc.test(t)||_c.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,wc)}return JSON.parse(t)}catch(i){if(e.strict)throw i;return t}}function vc(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function He(t,...e){try{return vc(t(...e))}catch(r){return Promise.reject(r)}}function Ec(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function Sc(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function Jr(t){if(Ec(t))return String(t);if(Sc(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return Jr(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function is(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Ri="base64:";function Dc(t){if(typeof t=="string")return t;is();const e=Buffer.from(t).toString("base64");return Ri+e}function Ic(t){return typeof t!="string"||!t.startsWith(Ri)?t:(is(),Buffer.from(t.slice(Ri.length),"base64"))}function dt(t){return t?t.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Oc(...t){return dt(t.join(":"))}function Qr(t){return t=dt(t),t?t+":":""}function b1(t){return t}const xc="memory",Tc=()=>{const t=new Map;return{name:xc,options:{},hasItem(e){return t.has(e)},getItem(e){return t.get(e)||null},getItemRaw(e){return t.get(e)||null},setItem(e,r){t.set(e,r)},setItemRaw(e,r){t.set(e,r)},removeItem(e){t.delete(e)},getKeys(){return Array.from(t.keys())},clear(){t.clear()},dispose(){t.clear()}}};function Nc(t={}){const e={mounts:{"":t.driver||Tc()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=l=>{for(const f of e.mountpoints)if(l.startsWith(f))return{base:f,relativeKey:l.slice(f.length),driver:e.mounts[f]};return{base:"",relativeKey:l,driver:e.mounts[""]}},i=(l,f)=>e.mountpoints.filter(y=>y.startsWith(l)||f&&l.startsWith(y)).map(y=>({relativeBase:l.length>y.length?l.slice(y.length):void 0,mountpoint:y,driver:e.mounts[y]})),n=(l,f)=>{if(e.watching){f=dt(f);for(const y of e.watchListeners)y(l,f)}},s=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await ns(e.mounts[l],n,l)}},a=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},c=(l,f,y)=>{const g=new Map,w=m=>{let P=g.get(m.base);return P||(P={driver:m.driver,base:m.base,items:[]},g.set(m.base,P)),P};for(const m of l){const P=typeof m=="string",A=dt(P?m:m.key),j=P?void 0:m.value,S=P||!m.options?f:{...f,...m.options},x=r(A);w(x).items.push({key:A,value:j,relativeKey:x.relativeKey,options:S})}return Promise.all([...g.values()].map(m=>y(m))).then(m=>m.flat())},h={hasItem(l,f={}){l=dt(l);const{relativeKey:y,driver:g}=r(l);return He(g.hasItem,y,f)},getItem(l,f={}){l=dt(l);const{relativeKey:y,driver:g}=r(l);return He(g.getItem,y,f).then(w=>Xr(w))},getItems(l,f){return c(l,f,y=>y.driver.getItems?He(y.driver.getItems,y.items.map(g=>({key:g.relativeKey,options:g.options})),f).then(g=>g.map(w=>({key:Oc(y.base,w.key),value:Xr(w.value)}))):Promise.all(y.items.map(g=>He(y.driver.getItem,g.relativeKey,g.options).then(w=>({key:g.key,value:Xr(w)})))))},getItemRaw(l,f={}){l=dt(l);const{relativeKey:y,driver:g}=r(l);return g.getItemRaw?He(g.getItemRaw,y,f):He(g.getItem,y,f).then(w=>Ic(w))},async setItem(l,f,y={}){if(f===void 0)return h.removeItem(l);l=dt(l);const{relativeKey:g,driver:w}=r(l);w.setItem&&(await He(w.setItem,g,Jr(f),y),w.watch||n("update",l))},async setItems(l,f){await c(l,f,async y=>{y.driver.setItems&&await He(y.driver.setItems,y.items.map(g=>({key:g.relativeKey,value:Jr(g.value),options:g.options})),f),y.driver.setItem&&await Promise.all(y.items.map(g=>He(y.driver.setItem,g.relativeKey,Jr(g.value),g.options)))})},async setItemRaw(l,f,y={}){if(f===void 0)return h.removeItem(l,y);l=dt(l);const{relativeKey:g,driver:w}=r(l);if(w.setItemRaw)await He(w.setItemRaw,g,f,y);else if(w.setItem)await He(w.setItem,g,Dc(f),y);else return;w.watch||n("update",l)},async removeItem(l,f={}){typeof f=="boolean"&&(f={removeMeta:f}),l=dt(l);const{relativeKey:y,driver:g}=r(l);g.removeItem&&(await He(g.removeItem,y,f),(f.removeMeta||f.removeMata)&&await He(g.removeItem,y+"$",f),g.watch||n("remove",l))},async getMeta(l,f={}){typeof f=="boolean"&&(f={nativeOnly:f}),l=dt(l);const{relativeKey:y,driver:g}=r(l),w=Object.create(null);if(g.getMeta&&Object.assign(w,await He(g.getMeta,y,f)),!f.nativeOnly){const m=await He(g.getItem,y+"$",f).then(P=>Xr(P));m&&typeof m=="object"&&(typeof m.atime=="string"&&(m.atime=new Date(m.atime)),typeof m.mtime=="string"&&(m.mtime=new Date(m.mtime)),Object.assign(w,m))}return w},setMeta(l,f,y={}){return this.setItem(l+"$",f,y)},removeMeta(l,f={}){return this.removeItem(l+"$",f)},async getKeys(l,f={}){l=Qr(l);const y=i(l,!0);let g=[];const w=[];for(const m of y){const A=(await He(m.driver.getKeys,m.relativeBase,f)).map(j=>m.mountpoint+dt(j)).filter(j=>!g.some(S=>j.startsWith(S)));w.push(...A),g=[m.mountpoint,...g.filter(j=>!j.startsWith(m.mountpoint))]}return l?w.filter(m=>m.startsWith(l)&&!m.endsWith("$")):w.filter(m=>!m.endsWith("$"))},async clear(l,f={}){l=Qr(l),await Promise.all(i(l,!1).map(async y=>{if(y.driver.clear)return He(y.driver.clear,y.relativeBase,f);if(y.driver.removeItem){const g=await y.driver.getKeys(y.relativeBase||"",f);return Promise.all(g.map(w=>y.driver.removeItem(w,f)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>ss(l)))},async watch(l){return await s(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(f=>f!==l),e.watchListeners.length===0&&await a()}},async unwatch(){e.watchListeners=[],await a()},mount(l,f){if(l=Qr(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((y,g)=>g.length-y.length)),e.mounts[l]=f,e.watching&&Promise.resolve(ns(f,n,l)).then(y=>{e.unwatch[l]=y}).catch(console.error),h},async unmount(l,f=!0){l=Qr(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&(e.unwatch[l](),delete e.unwatch[l]),f&&await ss(e.mounts[l]),e.mountpoints=e.mountpoints.filter(y=>y!==l),delete e.mounts[l])},getMount(l=""){l=dt(l)+":";const f=r(l);return{driver:f.driver,base:f.base}},getMounts(l="",f={}){return l=dt(l),i(l,f.parents).map(g=>({driver:g.driver,base:g.mountpoint}))}};return h}function ns(t,e,r){return t.watch?t.watch((i,n)=>e(i,r+n)):()=>{}}async function ss(t){typeof t.dispose=="function"&&await He(t.dispose)}function kt(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function os(t,e){const r=indexedDB.open(t);r.onupgradeneeded=()=>r.result.createObjectStore(e);const i=kt(r);return(n,s)=>i.then(a=>s(a.transaction(e,n).objectStore(e)))}let Ai;function mr(){return Ai||(Ai=os("keyval-store","keyval")),Ai}function as(t,e=mr()){return e("readonly",r=>kt(r.get(t)))}function Pc(t,e,r=mr()){return r("readwrite",i=>(i.put(e,t),kt(i.transaction)))}function Rc(t,e=mr()){return e("readwrite",r=>(r.delete(t),kt(r.transaction)))}function Ac(t=mr()){return t("readwrite",e=>(e.clear(),kt(e.transaction)))}function Cc(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},kt(t.transaction)}function Lc(t=mr()){return t("readonly",e=>{if(e.getAllKeys)return kt(e.getAllKeys());const r=[];return Cc(e,i=>r.push(i.key)).then(()=>r)})}const Fc=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),Uc=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(i,n)=>typeof n=="string"&&n.match(/^\d+n$/)?BigInt(n.substring(0,n.length-1)):n)};function Zr(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return Uc(t)}catch{return t}}function vr(t){return typeof t=="string"?t:Fc(t)||""}const $c="idb-keyval";var Mc=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",r=n=>e+n;let i;return t.dbName&&t.storeName&&(i=os(t.dbName,t.storeName)),{name:$c,options:t,async hasItem(n){return!(typeof await as(r(n),i)>"u")},async getItem(n){return await as(r(n),i)??null},setItem(n,s){return Pc(r(n),s,i)},removeItem(n){return Rc(r(n),i)},getKeys(){return Lc(i)},clear(){return Ac(i)}}};const jc="WALLET_CONNECT_V2_INDEXED_DB",qc="keyvaluestorage";class Bc{constructor(){this.indexedDb=Nc({driver:Mc({dbName:jc,storeName:qc})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,vr(r))}async removeItem(e){await this.indexedDb.removeItem(e)}}var Ci=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ei={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ci<"u"&&Ci.localStorage?ei.exports=Ci.localStorage:typeof window<"u"&&window.localStorage?ei.exports=window.localStorage:ei.exports=new e})();function zc(t){var e;return[t[0],Zr((e=t[1])!=null?e:"")]}class Kc{constructor(){this.localStorage=ei.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(zc)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return Zr(r)}async setItem(e,r){this.localStorage.setItem(e,vr(r))}async removeItem(e){this.localStorage.removeItem(e)}}const Hc="wc_storage_version",cs=1,Vc=async(t,e,r)=>{const i=Hc,n=await e.getItem(i);if(n&&n>=cs){r(e);return}const s=await t.getKeys();if(!s.length){r(e);return}const a=[];for(;s.length;){const c=s.shift();if(!c)continue;const h=c.toLowerCase();if(h.includes("wc@")||h.includes("walletconnect")||h.includes("wc_")||h.includes("wallet_connect")){const l=await t.getItem(c);await e.setItem(c,l),a.push(c)}}await e.setItem(i,cs),r(e),Gc(t,a)},Gc=async(t,e)=>{e.length&&e.forEach(async r=>{await t.removeItem(r)})};class kc{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new Kc;this.storage=e;try{const r=new Bc;Vc(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}}var ar={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Li=function(t,e){return Li=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Li(t,e)};function Wc(t,e){Li(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Fi=function(){return Fi=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Fi.apply(this,arguments)};function Yc(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Xc(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Jc(t,e){return function(r,i){e(r,i,t)}}function Qc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Zc(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(f){try{l(i.next(f))}catch(y){a(y)}}function h(f){try{l(i.throw(f))}catch(y){a(y)}}function l(f){f.done?s(f.value):n(f.value).then(c,h)}l((i=i.apply(t,e||[])).next())})}function eu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(f){return h([l,f])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function tu(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function ru(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Ui(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function us(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function iu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(us(arguments[e]));return t}function nu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Er(t){return this instanceof Er?(this.v=t,this):new Er(t)}function su(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(g){i[g]&&(n[g]=function(w){return new Promise(function(m,P){s.push([g,w,m,P])>1||c(g,w)})})}function c(g,w){try{h(i[g](w))}catch(m){y(s[0][3],m)}}function h(g){g.value instanceof Er?Promise.resolve(g.value.v).then(l,f):y(s[0][2],g)}function l(g){c("next",g)}function f(g){c("throw",g)}function y(g,w){g(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function ou(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Er(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function au(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Ui=="function"?Ui(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),n(c,h,a.done,a.value)})}}function n(s,a,c,h){Promise.resolve(h).then(function(l){s({value:l,done:c})},a)}}function cu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function uu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function lu(t){return t&&t.__esModule?t:{default:t}}function hu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function fu(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var du=Object.freeze({__proto__:null,__extends:Wc,get __assign(){return Fi},__rest:Yc,__decorate:Xc,__param:Jc,__metadata:Qc,__awaiter:Zc,__generator:eu,__createBinding:tu,__exportStar:ru,__values:Ui,__read:us,__spread:iu,__spreadArrays:nu,__await:Er,__asyncGenerator:su,__asyncDelegator:ou,__asyncValues:au,__makeTemplateObject:cu,__importStar:uu,__importDefault:lu,__classPrivateFieldGet:hu,__classPrivateFieldSet:fu}),ti=Gt(du),Sr={},Q={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var $i=function(t,e){return $i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},$i(t,e)};function pu(t,e){$i(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Mi=function(){return Mi=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Mi.apply(this,arguments)};function gu(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function yu(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function _u(t,e){return function(r,i){e(r,i,t)}}function bu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function wu(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(f){try{l(i.next(f))}catch(y){a(y)}}function h(f){try{l(i.throw(f))}catch(y){a(y)}}function l(f){f.done?s(f.value):n(f.value).then(c,h)}l((i=i.apply(t,e||[])).next())})}function mu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(f){return h([l,f])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function vu(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Eu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function ji(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ls(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function Su(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ls(arguments[e]));return t}function Du(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Dr(t){return this instanceof Dr?(this.v=t,this):new Dr(t)}function Iu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(g){i[g]&&(n[g]=function(w){return new Promise(function(m,P){s.push([g,w,m,P])>1||c(g,w)})})}function c(g,w){try{h(i[g](w))}catch(m){y(s[0][3],m)}}function h(g){g.value instanceof Dr?Promise.resolve(g.value.v).then(l,f):y(s[0][2],g)}function l(g){c("next",g)}function f(g){c("throw",g)}function y(g,w){g(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Ou(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Dr(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function xu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof ji=="function"?ji(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),n(c,h,a.done,a.value)})}}function n(s,a,c,h){Promise.resolve(h).then(function(l){s({value:l,done:c})},a)}}function Tu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Nu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Pu(t){return t&&t.__esModule?t:{default:t}}function Ru(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Au(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Cu=Object.freeze({__proto__:null,__extends:pu,get __assign(){return Mi},__rest:gu,__decorate:yu,__param:_u,__metadata:bu,__awaiter:wu,__generator:mu,__createBinding:vu,__exportStar:Eu,__values:ji,__read:ls,__spread:Su,__spreadArrays:Du,__await:Dr,__asyncGenerator:Iu,__asyncDelegator:Ou,__asyncValues:xu,__makeTemplateObject:Tu,__importStar:Nu,__importDefault:Pu,__classPrivateFieldGet:Ru,__classPrivateFieldSet:Au}),ri=Gt(Cu),qi={},Ir={},hs;function Lu(){if(hs)return Ir;hs=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return Ir.delay=t,Ir}var Wt={},Bi={},Yt={},fs;function Fu(){return fs||(fs=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.ONE_THOUSAND=Yt.ONE_HUNDRED=void 0,Yt.ONE_HUNDRED=100,Yt.ONE_THOUSAND=1e3),Yt}var zi={},ds;function Uu(){return ds||(ds=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(zi)),zi}var ps;function gs(){return ps||(ps=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ri;e.__exportStar(Fu(),t),e.__exportStar(Uu(),t)}(Bi)),Bi}var ys;function $u(){if(ys)return Wt;ys=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.fromMiliseconds=Wt.toMiliseconds=void 0;const t=gs();function e(i){return i*t.ONE_THOUSAND}Wt.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return Wt.fromMiliseconds=r,Wt}var _s;function Mu(){return _s||(_s=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ri;e.__exportStar(Lu(),t),e.__exportStar($u(),t)}(qi)),qi}var cr={},bs;function ju(){if(bs)return cr;bs=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return cr.Watch=t,cr.default=t,cr}var Ki={},Or={},ws;function qu(){if(ws)return Or;ws=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.IWatch=void 0;class t{}return Or.IWatch=t,Or}var ms;function Bu(){return ms||(ms=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),ri.__exportStar(qu(),t)}(Ki)),Ki}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ri;e.__exportStar(Mu(),t),e.__exportStar(ju(),t),e.__exportStar(Bu(),t),e.__exportStar(gs(),t)})(Q);var Hi={},xr={};class Xt{}var zu=Object.freeze({__proto__:null,IEvents:Xt}),Ku=Gt(zu),vs;function Hu(){if(vs)return xr;vs=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.IHeartBeat=void 0;const t=Ku;class e extends t.IEvents{constructor(i){super()}}return xr.IHeartBeat=e,xr}var Es;function Ss(){return Es||(Es=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),ti.__exportStar(Hu(),t)}(Hi)),Hi}var Vi={},Jt={},Ds;function Vu(){if(Ds)return Jt;Ds=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.HEARTBEAT_EVENTS=Jt.HEARTBEAT_INTERVAL=void 0;const t=Q;return Jt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Jt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Jt}var Is;function Os(){return Is||(Is=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),ti.__exportStar(Vu(),t)}(Vi)),Vi}var xs;function Gu(){if(xs)return Sr;xs=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.HeartBeat=void 0;const t=ti,e=ft.exports,r=Q,i=Ss(),n=Os();class s extends i.IHeartBeat{constructor(c){super(c),this.events=new e.EventEmitter,this.interval=n.HEARTBEAT_INTERVAL,this.interval=c?.interval||n.HEARTBEAT_INTERVAL}static init(c){return t.__awaiter(this,void 0,void 0,function*(){const h=new s(c);return yield h.init(),h})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(c,h){this.events.on(c,h)}once(c,h){this.events.once(c,h)}off(c,h){this.events.off(c,h)}removeListener(c,h){this.events.removeListener(c,h)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(n.HEARTBEAT_EVENTS.pulse)}}return Sr.HeartBeat=s,Sr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ti;e.__exportStar(Gu(),t),e.__exportStar(Ss(),t),e.__exportStar(Os(),t)})(ar);var ye={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Gi=function(t,e){return Gi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Gi(t,e)};function ku(t,e){Gi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var ki=function(){return ki=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ki.apply(this,arguments)};function Wu(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Yu(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Xu(t,e){return function(r,i){e(r,i,t)}}function Ju(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Qu(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(f){try{l(i.next(f))}catch(y){a(y)}}function h(f){try{l(i.throw(f))}catch(y){a(y)}}function l(f){f.done?s(f.value):n(f.value).then(c,h)}l((i=i.apply(t,e||[])).next())})}function Zu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(f){return h([l,f])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function el(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function tl(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Wi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ts(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function rl(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ts(arguments[e]));return t}function il(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Tr(t){return this instanceof Tr?(this.v=t,this):new Tr(t)}function nl(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(g){i[g]&&(n[g]=function(w){return new Promise(function(m,P){s.push([g,w,m,P])>1||c(g,w)})})}function c(g,w){try{h(i[g](w))}catch(m){y(s[0][3],m)}}function h(g){g.value instanceof Tr?Promise.resolve(g.value.v).then(l,f):y(s[0][2],g)}function l(g){c("next",g)}function f(g){c("throw",g)}function y(g,w){g(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function sl(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Tr(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function ol(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Wi=="function"?Wi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),n(c,h,a.done,a.value)})}}function n(s,a,c,h){Promise.resolve(h).then(function(l){s({value:l,done:c})},a)}}function al(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function cl(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function ul(t){return t&&t.__esModule?t:{default:t}}function ll(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function hl(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var fl=Object.freeze({__proto__:null,__extends:ku,get __assign(){return ki},__rest:Wu,__decorate:Yu,__param:Xu,__metadata:Ju,__awaiter:Qu,__generator:Zu,__createBinding:el,__exportStar:tl,__values:Wi,__read:Ts,__spread:rl,__spreadArrays:il,__await:Tr,__asyncGenerator:nl,__asyncDelegator:sl,__asyncValues:ol,__makeTemplateObject:al,__importStar:cl,__importDefault:ul,__classPrivateFieldGet:ll,__classPrivateFieldSet:hl}),dl=Gt(fl),Yi,Ns;function pl(){if(Ns)return Yi;Ns=1;function t(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Yi=e;function e(r,i,n){var s=n&&n.stringify||t,a=1;if(typeof r=="object"&&r!==null){var c=i.length+a;if(c===1)return r;var h=new Array(c);h[0]=s(r);for(var l=1;l<c;l++)h[l]=s(i[l]);return h.join(" ")}if(typeof r!="string")return r;var f=i.length;if(f===0)return r;for(var y="",g=1-a,w=-1,m=r&&r.length||0,P=0;P<m;){if(r.charCodeAt(P)===37&&P+1<m){switch(w=w>-1?w:0,r.charCodeAt(P+1)){case 100:case 102:if(g>=f||i[g]==null)break;w<P&&(y+=r.slice(w,P)),y+=Number(i[g]),w=P+2,P++;break;case 105:if(g>=f||i[g]==null)break;w<P&&(y+=r.slice(w,P)),y+=Math.floor(Number(i[g])),w=P+2,P++;break;case 79:case 111:case 106:if(g>=f||i[g]===void 0)break;w<P&&(y+=r.slice(w,P));var A=typeof i[g];if(A==="string"){y+="'"+i[g]+"'",w=P+2,P++;break}if(A==="function"){y+=i[g].name||"<anonymous>",w=P+2,P++;break}y+=s(i[g]),w=P+2,P++;break;case 115:if(g>=f)break;w<P&&(y+=r.slice(w,P)),y+=String(i[g]),w=P+2,P++;break;case 37:w<P&&(y+=r.slice(w,P)),y+="%",w=P+2,P++,g--;break}++g}++P}return w===-1?r:(w<m&&(y+=r.slice(w)),y)}return Yi}var Xi,Ps;function gl(){if(Ps)return Xi;Ps=1;const t=pl();Xi=n;const e=E().console||{},r={mapHttpRequest:m,mapHttpResponse:m,wrapRequestSerializer:P,wrapResponseSerializer:P,wrapErrorSerializer:P,req:m,res:m,err:g};function i(p,o){return Array.isArray(p)?p.filter(function(C){return C!=="!stdSerializers.err"}):p===!0?Object.keys(o):!1}function n(p){p=p||{},p.browser=p.browser||{};const o=p.browser.transmit;if(o&&typeof o.send!="function")throw Error("pino: transmit option must have a send function");const d=p.browser.write||e;p.browser.write&&(p.browser.asObject=!0);const C=p.serializers||{},L=i(p.browser.serialize,C);let K=p.browser.serialize;Array.isArray(p.browser.serialize)&&p.browser.serialize.indexOf("!stdSerializers.err")>-1&&(K=!1);const G=["error","fatal","warn","info","debug","trace"];typeof d=="function"&&(d.error=d.fatal=d.warn=d.info=d.debug=d.trace=d),p.enabled===!1&&(p.level="silent");const J=p.level||"info",O=Object.create(d);O.log||(O.log=A),Object.defineProperty(O,"levelVal",{get:k}),Object.defineProperty(O,"level",{get:q,set:U});const R={transmit:o,serialize:L,asObject:p.browser.asObject,levels:G,timestamp:w(p)};O.levels=n.levels,O.level=J,O.setMaxListeners=O.getMaxListeners=O.emit=O.addListener=O.on=O.prependListener=O.once=O.prependOnceListener=O.removeListener=O.removeAllListeners=O.listeners=O.listenerCount=O.eventNames=O.write=O.flush=A,O.serializers=C,O._serialize=L,O._stdErrSerialize=K,O.child=M,o&&(O._logEvent=y());function k(){return this.level==="silent"?1/0:this.levels.values[this.level]}function q(){return this._level}function U(F){if(F!=="silent"&&!this.levels.values[F])throw Error("unknown level "+F);this._level=F,s(R,O,"error","log"),s(R,O,"fatal","error"),s(R,O,"warn","error"),s(R,O,"info","log"),s(R,O,"debug","log"),s(R,O,"trace","log")}function M(F,B){if(!F)throw new Error("missing bindings for child Pino");B=B||{},L&&F.serializers&&(B.serializers=F.serializers);const te=B.serializers;if(L&&te){var z=Object.assign({},C,te),Z=p.browser.serialize===!0?Object.keys(z):L;delete F.serializers,h([F],Z,z,this._stdErrSerialize)}function Y(ee){this._childLevel=(ee._childLevel|0)+1,this.error=l(ee,F,"error"),this.fatal=l(ee,F,"fatal"),this.warn=l(ee,F,"warn"),this.info=l(ee,F,"info"),this.debug=l(ee,F,"debug"),this.trace=l(ee,F,"trace"),z&&(this.serializers=z,this._serialize=Z),o&&(this._logEvent=y([].concat(ee._logEvent.bindings,F)))}return Y.prototype=this,new Y(this)}return O}n.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},n.stdSerializers=r,n.stdTimeFunctions=Object.assign({},{nullTime:j,epochTime:S,unixTime:x,isoTime:b});function s(p,o,d,C){const L=Object.getPrototypeOf(o);o[d]=o.levelVal>o.levels.values[d]?A:L[d]?L[d]:e[d]||e[C]||A,a(p,o,d)}function a(p,o,d){!p.transmit&&o[d]===A||(o[d]=function(C){return function(){const K=p.timestamp(),G=new Array(arguments.length),J=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var O=0;O<G.length;O++)G[O]=arguments[O];if(p.serialize&&!p.asObject&&h(G,this._serialize,this.serializers,this._stdErrSerialize),p.asObject?C.call(J,c(this,d,G,K)):C.apply(J,G),p.transmit){const R=p.transmit.level||o.level,k=n.levels.values[R],q=n.levels.values[d];if(q<k)return;f(this,{ts:K,methodLevel:d,methodValue:q,transmitLevel:R,transmitValue:n.levels.values[p.transmit.level||o.level],send:p.transmit.send,val:o.levelVal},G)}}}(o[d]))}function c(p,o,d,C){p._serialize&&h(d,p._serialize,p.serializers,p._stdErrSerialize);const L=d.slice();let K=L[0];const G={};C&&(G.time=C),G.level=n.levels.values[o];let J=(p._childLevel|0)+1;if(J<1&&(J=1),K!==null&&typeof K=="object"){for(;J--&&typeof L[0]=="object";)Object.assign(G,L.shift());K=L.length?t(L.shift(),L):void 0}else typeof K=="string"&&(K=t(L.shift(),L));return K!==void 0&&(G.msg=K),G}function h(p,o,d,C){for(const L in p)if(C&&p[L]instanceof Error)p[L]=n.stdSerializers.err(p[L]);else if(typeof p[L]=="object"&&!Array.isArray(p[L]))for(const K in p[L])o&&o.indexOf(K)>-1&&K in d&&(p[L][K]=d[K](p[L][K]))}function l(p,o,d){return function(){const C=new Array(1+arguments.length);C[0]=o;for(var L=1;L<C.length;L++)C[L]=arguments[L-1];return p[d].apply(this,C)}}function f(p,o,d){const C=o.send,L=o.ts,K=o.methodLevel,G=o.methodValue,J=o.val,O=p._logEvent.bindings;h(d,p._serialize||Object.keys(p.serializers),p.serializers,p._stdErrSerialize===void 0?!0:p._stdErrSerialize),p._logEvent.ts=L,p._logEvent.messages=d.filter(function(R){return O.indexOf(R)===-1}),p._logEvent.level.label=K,p._logEvent.level.value=G,C(K,p._logEvent,J),p._logEvent=y(O)}function y(p){return{ts:0,messages:[],bindings:p||[],level:{label:"",value:0}}}function g(p){const o={type:p.constructor.name,msg:p.message,stack:p.stack};for(const d in p)o[d]===void 0&&(o[d]=p[d]);return o}function w(p){return typeof p.timestamp=="function"?p.timestamp:p.timestamp===!1?j:S}function m(){return{}}function P(p){return p}function A(){}function j(){return!1}function S(){return Date.now()}function x(){return Math.round(Date.now()/1e3)}function b(){return new Date(Date.now()).toISOString()}function E(){function p(o){return typeof o<"u"&&o}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return p(self)||p(window)||p(this)||{}}}return Xi}var Qt={},Rs;function As(){return Rs||(Rs=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.PINO_CUSTOM_CONTEXT_KEY=Qt.PINO_LOGGER_DEFAULTS=void 0,Qt.PINO_LOGGER_DEFAULTS={level:"info"},Qt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Qt}var ot={},Cs;function yl(){if(Cs)return ot;Cs=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.generateChildLogger=ot.formatChildLoggerContext=ot.getLoggerContext=ot.setBrowserLoggerContext=ot.getBrowserLoggerContext=ot.getDefaultLoggerOptions=void 0;const t=As();function e(c){return Object.assign(Object.assign({},c),{level:c?.level||t.PINO_LOGGER_DEFAULTS.level})}ot.getDefaultLoggerOptions=e;function r(c,h=t.PINO_CUSTOM_CONTEXT_KEY){return c[h]||""}ot.getBrowserLoggerContext=r;function i(c,h,l=t.PINO_CUSTOM_CONTEXT_KEY){return c[l]=h,c}ot.setBrowserLoggerContext=i;function n(c,h=t.PINO_CUSTOM_CONTEXT_KEY){let l="";return typeof c.bindings>"u"?l=r(c,h):l=c.bindings().context||"",l}ot.getLoggerContext=n;function s(c,h,l=t.PINO_CUSTOM_CONTEXT_KEY){const f=n(c,l);return f.trim()?`${f}/${h}`:h}ot.formatChildLoggerContext=s;function a(c,h,l=t.PINO_CUSTOM_CONTEXT_KEY){const f=s(c,h,l),y=c.child({context:f});return i(y,f,l)}return ot.generateChildLogger=a,ot}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=dl,r=e.__importDefault(gl());Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(As(),t),e.__exportStar(yl(),t)})(ye);class _l extends Xt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class bl extends Xt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class wl{constructor(e,r){this.logger=e,this.core=r}}class ml extends Xt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class vl extends Xt{constructor(e){super()}}class El{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}}class Sl extends Xt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Dl extends Xt{constructor(e,r){super(),this.core=e,this.logger=r}}class Il{constructor(e,r){this.projectId=e,this.logger=r}}class Ol{constructor(e,r){this.projectId=e,this.logger=r}}class xl{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class Tl{constructor(e){this.client=e}}var Ji={},ur={},ii={},ni={};Object.defineProperty(ni,"__esModule",{value:!0}),ni.BrowserRandomSource=void 0;const Ls=65536;class Nl{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let i=0;i<r.length;i+=Ls)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,Ls)));return r}}ni.BrowserRandomSource=Nl;function Pl(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var si={},_t={};Object.defineProperty(_t,"__esModule",{value:!0});function Rl(t){for(var e=0;e<t.length;e++)t[e]=0;return t}_t.wipe=Rl;var Al={},Cl=Object.freeze({__proto__:null,default:Al}),Ll=Gt(Cl);Object.defineProperty(si,"__esModule",{value:!0}),si.NodeRandomSource=void 0;const Fl=_t;class Ul{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Pl<"u"){const e=Ll;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=r[n];return(0,Fl.wipe)(r),i}}si.NodeRandomSource=Ul,Object.defineProperty(ii,"__esModule",{value:!0}),ii.SystemRandomSource=void 0;const $l=ni,Ml=si;class jl{constructor(){if(this.isAvailable=!1,this.name="",this._source=new $l.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Ml.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}ii.SystemRandomSource=jl;var ie={},Fs={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(c,h){var l=c>>>16&65535,f=c&65535,y=h>>>16&65535,g=h&65535;return f*g+(l*g+f*y<<16>>>0)|0}t.mul=Math.imul||e;function r(c,h){return c+h|0}t.add=r;function i(c,h){return c-h|0}t.sub=i;function n(c,h){return c<<h|c>>>32-h}t.rotl=n;function s(c,h){return c<<32-h|c>>>h}t.rotr=s;function a(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c}t.isInteger=Number.isInteger||a,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(c){return t.isInteger(c)&&c>=-t.MAX_SAFE_INTEGER&&c<=t.MAX_SAFE_INTEGER}})(Fs),Object.defineProperty(ie,"__esModule",{value:!0});var Us=Fs;function ql(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}ie.readInt16BE=ql;function Bl(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}ie.readUint16BE=Bl;function zl(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}ie.readInt16LE=zl;function Kl(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}ie.readUint16LE=Kl;function $s(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}ie.writeUint16BE=$s,ie.writeInt16BE=$s;function Ms(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}ie.writeUint16LE=Ms,ie.writeInt16LE=Ms;function Qi(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}ie.readInt32BE=Qi;function Zi(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}ie.readUint32BE=Zi;function en(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}ie.readInt32LE=en;function tn(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}ie.readUint32LE=tn;function oi(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}ie.writeUint32BE=oi,ie.writeInt32BE=oi;function ai(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}ie.writeUint32LE=ai,ie.writeInt32LE=ai;function Hl(t,e){e===void 0&&(e=0);var r=Qi(t,e),i=Qi(t,e+4);return r*4294967296+i-(i>>31)*4294967296}ie.readInt64BE=Hl;function Vl(t,e){e===void 0&&(e=0);var r=Zi(t,e),i=Zi(t,e+4);return r*4294967296+i}ie.readUint64BE=Vl;function Gl(t,e){e===void 0&&(e=0);var r=en(t,e),i=en(t,e+4);return i*4294967296+r-(r>>31)*4294967296}ie.readInt64LE=Gl;function kl(t,e){e===void 0&&(e=0);var r=tn(t,e),i=tn(t,e+4);return i*4294967296+r}ie.readUint64LE=kl;function js(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),oi(t/4294967296>>>0,e,r),oi(t>>>0,e,r+4),e}ie.writeUint64BE=js,ie.writeInt64BE=js;function qs(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),ai(t>>>0,e,r),ai(t/4294967296>>>0,e,r+4),e}ie.writeUint64LE=qs,ie.writeInt64LE=qs;function Wl(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=t/8+r-1;s>=r;s--)i+=e[s]*n,n*=256;return i}ie.readUintBE=Wl;function Yl(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=r;s<r+t/8;s++)i+=e[s]*n,n*=256;return i}ie.readUintLE=Yl;function Xl(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Us.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=t/8+i-1;s>=i;s--)r[s]=e/n&255,n*=256;return r}ie.writeUintBE=Xl;function Jl(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Us.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+t/8;s++)r[s]=e/n&255,n*=256;return r}ie.writeUintLE=Jl;function Ql(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}ie.readFloat32BE=Ql;function Zl(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}ie.readFloat32LE=Zl;function eh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}ie.readFloat64BE=eh;function th(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}ie.readFloat64LE=th;function rh(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}ie.writeFloat32BE=rh;function ih(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}ie.writeFloat32LE=ih;function nh(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}ie.writeFloat64BE=nh;function sh(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}ie.writeFloat64LE=sh,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=ii,r=ie,i=_t;t.defaultRandomSource=new e.SystemRandomSource;function n(l,f=t.defaultRandomSource){return f.randomBytes(l)}t.randomBytes=n;function s(l=t.defaultRandomSource){const f=n(4,l),y=(0,r.readUint32LE)(f);return(0,i.wipe)(f),y}t.randomUint32=s;const a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(l,f=a,y=t.defaultRandomSource){if(f.length<2)throw new Error("randomString charset is too short");if(f.length>256)throw new Error("randomString charset is too long");let g="";const w=f.length,m=256-256%w;for(;l>0;){const P=n(Math.ceil(l*256/m),y);for(let A=0;A<P.length&&l>0;A++){const j=P[A];j<m&&(g+=f.charAt(j%w),l--)}(0,i.wipe)(P)}return g}t.randomString=c;function h(l,f=a,y=t.defaultRandomSource){const g=Math.ceil(l/(Math.log(f.length)/Math.LN2));return c(g,f,y)}t.randomStringForEntropy=h}(ur);var Bs={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ie,r=_t;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},c.prototype.update=function(h,l){if(l===void 0&&(l=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var f=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&l>0;)this._buffer[this._bufferLength++]=h[f++],l--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(f=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,f,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=h[f++],l--;return this},c.prototype.finish=function(h){if(!this._finished){var l=this._bytesHashed,f=this._bufferLength,y=l/536870912|0,g=l<<3,w=l%128<112?128:256;this._buffer[f]=128;for(var m=f+1;m<w-8;m++)this._buffer[m]=0;e.writeUint32BE(y,this._buffer,w-8),e.writeUint32BE(g,this._buffer,w-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,w),this._finished=!0}for(var m=0;m<this.digestLength/8;m++)e.writeUint32BE(this._stateHi[m],h,m*8),e.writeUint32BE(this._stateLo[m],h,m*8+4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();t.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(c,h,l,f,y,g,w){for(var m=l[0],P=l[1],A=l[2],j=l[3],S=l[4],x=l[5],b=l[6],E=l[7],p=f[0],o=f[1],d=f[2],C=f[3],L=f[4],K=f[5],G=f[6],J=f[7],O,R,k,q,U,M,F,B;w>=128;){for(var te=0;te<16;te++){var z=8*te+g;c[te]=e.readUint32BE(y,z),h[te]=e.readUint32BE(y,z+4)}for(var te=0;te<80;te++){var Z=m,Y=P,ee=A,N=j,T=S,D=x,u=b,v=E,H=p,W=o,he=d,be=C,de=L,ve=K,Fe=G,Re=J;if(O=E,R=J,U=R&65535,M=R>>>16,F=O&65535,B=O>>>16,O=(S>>>14|L<<32-14)^(S>>>18|L<<32-18)^(L>>>41-32|S<<32-(41-32)),R=(L>>>14|S<<32-14)^(L>>>18|S<<32-18)^(S>>>41-32|L<<32-(41-32)),U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,O=S&x^~S&b,R=L&K^~L&G,U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,O=n[te*2],R=n[te*2+1],U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,O=c[te%16],R=h[te%16],U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,M+=U>>>16,F+=M>>>16,B+=F>>>16,k=F&65535|B<<16,q=U&65535|M<<16,O=k,R=q,U=R&65535,M=R>>>16,F=O&65535,B=O>>>16,O=(m>>>28|p<<32-28)^(p>>>34-32|m<<32-(34-32))^(p>>>39-32|m<<32-(39-32)),R=(p>>>28|m<<32-28)^(m>>>34-32|p<<32-(34-32))^(m>>>39-32|p<<32-(39-32)),U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,O=m&P^m&A^P&A,R=p&o^p&d^o&d,U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,M+=U>>>16,F+=M>>>16,B+=F>>>16,v=F&65535|B<<16,Re=U&65535|M<<16,O=N,R=be,U=R&65535,M=R>>>16,F=O&65535,B=O>>>16,O=k,R=q,U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,M+=U>>>16,F+=M>>>16,B+=F>>>16,N=F&65535|B<<16,be=U&65535|M<<16,P=Z,A=Y,j=ee,S=N,x=T,b=D,E=u,m=v,o=H,d=W,C=he,L=be,K=de,G=ve,J=Fe,p=Re,te%16===15)for(var z=0;z<16;z++)O=c[z],R=h[z],U=R&65535,M=R>>>16,F=O&65535,B=O>>>16,O=c[(z+9)%16],R=h[(z+9)%16],U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,k=c[(z+1)%16],q=h[(z+1)%16],O=(k>>>1|q<<32-1)^(k>>>8|q<<32-8)^k>>>7,R=(q>>>1|k<<32-1)^(q>>>8|k<<32-8)^(q>>>7|k<<32-7),U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,k=c[(z+14)%16],q=h[(z+14)%16],O=(k>>>19|q<<32-19)^(q>>>61-32|k<<32-(61-32))^k>>>6,R=(q>>>19|k<<32-19)^(k>>>61-32|q<<32-(61-32))^(q>>>6|k<<32-6),U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,M+=U>>>16,F+=M>>>16,B+=F>>>16,c[z]=F&65535|B<<16,h[z]=U&65535|M<<16}O=m,R=p,U=R&65535,M=R>>>16,F=O&65535,B=O>>>16,O=l[0],R=f[0],U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,M+=U>>>16,F+=M>>>16,B+=F>>>16,l[0]=m=F&65535|B<<16,f[0]=p=U&65535|M<<16,O=P,R=o,U=R&65535,M=R>>>16,F=O&65535,B=O>>>16,O=l[1],R=f[1],U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,M+=U>>>16,F+=M>>>16,B+=F>>>16,l[1]=P=F&65535|B<<16,f[1]=o=U&65535|M<<16,O=A,R=d,U=R&65535,M=R>>>16,F=O&65535,B=O>>>16,O=l[2],R=f[2],U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,M+=U>>>16,F+=M>>>16,B+=F>>>16,l[2]=A=F&65535|B<<16,f[2]=d=U&65535|M<<16,O=j,R=C,U=R&65535,M=R>>>16,F=O&65535,B=O>>>16,O=l[3],R=f[3],U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,M+=U>>>16,F+=M>>>16,B+=F>>>16,l[3]=j=F&65535|B<<16,f[3]=C=U&65535|M<<16,O=S,R=L,U=R&65535,M=R>>>16,F=O&65535,B=O>>>16,O=l[4],R=f[4],U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,M+=U>>>16,F+=M>>>16,B+=F>>>16,l[4]=S=F&65535|B<<16,f[4]=L=U&65535|M<<16,O=x,R=K,U=R&65535,M=R>>>16,F=O&65535,B=O>>>16,O=l[5],R=f[5],U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,M+=U>>>16,F+=M>>>16,B+=F>>>16,l[5]=x=F&65535|B<<16,f[5]=K=U&65535|M<<16,O=b,R=G,U=R&65535,M=R>>>16,F=O&65535,B=O>>>16,O=l[6],R=f[6],U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,M+=U>>>16,F+=M>>>16,B+=F>>>16,l[6]=b=F&65535|B<<16,f[6]=G=U&65535|M<<16,O=E,R=J,U=R&65535,M=R>>>16,F=O&65535,B=O>>>16,O=l[7],R=f[7],U+=R&65535,M+=R>>>16,F+=O&65535,B+=O>>>16,M+=U>>>16,F+=M>>>16,B+=F>>>16,l[7]=E=F&65535|B<<16,f[7]=J=U&65535|M<<16,g+=128,w-=128}return g}function a(c){var h=new i;h.update(c);var l=h.digest();return h.clean(),l}t.hash=a})(Bs),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=ur,r=Bs,i=_t;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function n(N){const T=new Float64Array(16);if(N)for(let D=0;D<N.length;D++)T[D]=N[D];return T}const s=new Uint8Array(32);s[0]=9;const a=n(),c=n([1]),h=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),f=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),y=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),g=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function w(N,T){for(let D=0;D<16;D++)N[D]=T[D]|0}function m(N){let T=1;for(let D=0;D<16;D++){let u=N[D]+T+65535;T=Math.floor(u/65536),N[D]=u-T*65536}N[0]+=T-1+37*(T-1)}function P(N,T,D){const u=~(D-1);for(let v=0;v<16;v++){const H=u&(N[v]^T[v]);N[v]^=H,T[v]^=H}}function A(N,T){const D=n(),u=n();for(let v=0;v<16;v++)u[v]=T[v];m(u),m(u),m(u);for(let v=0;v<2;v++){D[0]=u[0]-65517;for(let W=1;W<15;W++)D[W]=u[W]-65535-(D[W-1]>>16&1),D[W-1]&=65535;D[15]=u[15]-32767-(D[14]>>16&1);const H=D[15]>>16&1;D[14]&=65535,P(u,D,1-H)}for(let v=0;v<16;v++)N[2*v]=u[v]&255,N[2*v+1]=u[v]>>8}function j(N,T){let D=0;for(let u=0;u<32;u++)D|=N[u]^T[u];return(1&D-1>>>8)-1}function S(N,T){const D=new Uint8Array(32),u=new Uint8Array(32);return A(D,N),A(u,T),j(D,u)}function x(N){const T=new Uint8Array(32);return A(T,N),T[0]&1}function b(N,T){for(let D=0;D<16;D++)N[D]=T[2*D]+(T[2*D+1]<<8);N[15]&=32767}function E(N,T,D){for(let u=0;u<16;u++)N[u]=T[u]+D[u]}function p(N,T,D){for(let u=0;u<16;u++)N[u]=T[u]-D[u]}function o(N,T,D){let u,v,H=0,W=0,he=0,be=0,de=0,ve=0,Fe=0,Re=0,_e=0,pe=0,fe=0,ue=0,ce=0,ae=0,oe=0,re=0,le=0,ge=0,ne=0,we=0,me=0,De=0,Ie=0,Ee=0,xt=0,At=0,zt=0,wt=0,rr=0,Vr=0,Di=0,$e=D[0],Ae=D[1],Me=D[2],je=D[3],qe=D[4],Ce=D[5],Ge=D[6],ke=D[7],We=D[8],Ye=D[9],Xe=D[10],Ke=D[11],Be=D[12],Ne=D[13],Je=D[14],Qe=D[15];u=T[0],H+=u*$e,W+=u*Ae,he+=u*Me,be+=u*je,de+=u*qe,ve+=u*Ce,Fe+=u*Ge,Re+=u*ke,_e+=u*We,pe+=u*Ye,fe+=u*Xe,ue+=u*Ke,ce+=u*Be,ae+=u*Ne,oe+=u*Je,re+=u*Qe,u=T[1],W+=u*$e,he+=u*Ae,be+=u*Me,de+=u*je,ve+=u*qe,Fe+=u*Ce,Re+=u*Ge,_e+=u*ke,pe+=u*We,fe+=u*Ye,ue+=u*Xe,ce+=u*Ke,ae+=u*Be,oe+=u*Ne,re+=u*Je,le+=u*Qe,u=T[2],he+=u*$e,be+=u*Ae,de+=u*Me,ve+=u*je,Fe+=u*qe,Re+=u*Ce,_e+=u*Ge,pe+=u*ke,fe+=u*We,ue+=u*Ye,ce+=u*Xe,ae+=u*Ke,oe+=u*Be,re+=u*Ne,le+=u*Je,ge+=u*Qe,u=T[3],be+=u*$e,de+=u*Ae,ve+=u*Me,Fe+=u*je,Re+=u*qe,_e+=u*Ce,pe+=u*Ge,fe+=u*ke,ue+=u*We,ce+=u*Ye,ae+=u*Xe,oe+=u*Ke,re+=u*Be,le+=u*Ne,ge+=u*Je,ne+=u*Qe,u=T[4],de+=u*$e,ve+=u*Ae,Fe+=u*Me,Re+=u*je,_e+=u*qe,pe+=u*Ce,fe+=u*Ge,ue+=u*ke,ce+=u*We,ae+=u*Ye,oe+=u*Xe,re+=u*Ke,le+=u*Be,ge+=u*Ne,ne+=u*Je,we+=u*Qe,u=T[5],ve+=u*$e,Fe+=u*Ae,Re+=u*Me,_e+=u*je,pe+=u*qe,fe+=u*Ce,ue+=u*Ge,ce+=u*ke,ae+=u*We,oe+=u*Ye,re+=u*Xe,le+=u*Ke,ge+=u*Be,ne+=u*Ne,we+=u*Je,me+=u*Qe,u=T[6],Fe+=u*$e,Re+=u*Ae,_e+=u*Me,pe+=u*je,fe+=u*qe,ue+=u*Ce,ce+=u*Ge,ae+=u*ke,oe+=u*We,re+=u*Ye,le+=u*Xe,ge+=u*Ke,ne+=u*Be,we+=u*Ne,me+=u*Je,De+=u*Qe,u=T[7],Re+=u*$e,_e+=u*Ae,pe+=u*Me,fe+=u*je,ue+=u*qe,ce+=u*Ce,ae+=u*Ge,oe+=u*ke,re+=u*We,le+=u*Ye,ge+=u*Xe,ne+=u*Ke,we+=u*Be,me+=u*Ne,De+=u*Je,Ie+=u*Qe,u=T[8],_e+=u*$e,pe+=u*Ae,fe+=u*Me,ue+=u*je,ce+=u*qe,ae+=u*Ce,oe+=u*Ge,re+=u*ke,le+=u*We,ge+=u*Ye,ne+=u*Xe,we+=u*Ke,me+=u*Be,De+=u*Ne,Ie+=u*Je,Ee+=u*Qe,u=T[9],pe+=u*$e,fe+=u*Ae,ue+=u*Me,ce+=u*je,ae+=u*qe,oe+=u*Ce,re+=u*Ge,le+=u*ke,ge+=u*We,ne+=u*Ye,we+=u*Xe,me+=u*Ke,De+=u*Be,Ie+=u*Ne,Ee+=u*Je,xt+=u*Qe,u=T[10],fe+=u*$e,ue+=u*Ae,ce+=u*Me,ae+=u*je,oe+=u*qe,re+=u*Ce,le+=u*Ge,ge+=u*ke,ne+=u*We,we+=u*Ye,me+=u*Xe,De+=u*Ke,Ie+=u*Be,Ee+=u*Ne,xt+=u*Je,At+=u*Qe,u=T[11],ue+=u*$e,ce+=u*Ae,ae+=u*Me,oe+=u*je,re+=u*qe,le+=u*Ce,ge+=u*Ge,ne+=u*ke,we+=u*We,me+=u*Ye,De+=u*Xe,Ie+=u*Ke,Ee+=u*Be,xt+=u*Ne,At+=u*Je,zt+=u*Qe,u=T[12],ce+=u*$e,ae+=u*Ae,oe+=u*Me,re+=u*je,le+=u*qe,ge+=u*Ce,ne+=u*Ge,we+=u*ke,me+=u*We,De+=u*Ye,Ie+=u*Xe,Ee+=u*Ke,xt+=u*Be,At+=u*Ne,zt+=u*Je,wt+=u*Qe,u=T[13],ae+=u*$e,oe+=u*Ae,re+=u*Me,le+=u*je,ge+=u*qe,ne+=u*Ce,we+=u*Ge,me+=u*ke,De+=u*We,Ie+=u*Ye,Ee+=u*Xe,xt+=u*Ke,At+=u*Be,zt+=u*Ne,wt+=u*Je,rr+=u*Qe,u=T[14],oe+=u*$e,re+=u*Ae,le+=u*Me,ge+=u*je,ne+=u*qe,we+=u*Ce,me+=u*Ge,De+=u*ke,Ie+=u*We,Ee+=u*Ye,xt+=u*Xe,At+=u*Ke,zt+=u*Be,wt+=u*Ne,rr+=u*Je,Vr+=u*Qe,u=T[15],re+=u*$e,le+=u*Ae,ge+=u*Me,ne+=u*je,we+=u*qe,me+=u*Ce,De+=u*Ge,Ie+=u*ke,Ee+=u*We,xt+=u*Ye,At+=u*Xe,zt+=u*Ke,wt+=u*Be,rr+=u*Ne,Vr+=u*Je,Di+=u*Qe,H+=38*le,W+=38*ge,he+=38*ne,be+=38*we,de+=38*me,ve+=38*De,Fe+=38*Ie,Re+=38*Ee,_e+=38*xt,pe+=38*At,fe+=38*zt,ue+=38*wt,ce+=38*rr,ae+=38*Vr,oe+=38*Di,v=1,u=H+v+65535,v=Math.floor(u/65536),H=u-v*65536,u=W+v+65535,v=Math.floor(u/65536),W=u-v*65536,u=he+v+65535,v=Math.floor(u/65536),he=u-v*65536,u=be+v+65535,v=Math.floor(u/65536),be=u-v*65536,u=de+v+65535,v=Math.floor(u/65536),de=u-v*65536,u=ve+v+65535,v=Math.floor(u/65536),ve=u-v*65536,u=Fe+v+65535,v=Math.floor(u/65536),Fe=u-v*65536,u=Re+v+65535,v=Math.floor(u/65536),Re=u-v*65536,u=_e+v+65535,v=Math.floor(u/65536),_e=u-v*65536,u=pe+v+65535,v=Math.floor(u/65536),pe=u-v*65536,u=fe+v+65535,v=Math.floor(u/65536),fe=u-v*65536,u=ue+v+65535,v=Math.floor(u/65536),ue=u-v*65536,u=ce+v+65535,v=Math.floor(u/65536),ce=u-v*65536,u=ae+v+65535,v=Math.floor(u/65536),ae=u-v*65536,u=oe+v+65535,v=Math.floor(u/65536),oe=u-v*65536,u=re+v+65535,v=Math.floor(u/65536),re=u-v*65536,H+=v-1+37*(v-1),v=1,u=H+v+65535,v=Math.floor(u/65536),H=u-v*65536,u=W+v+65535,v=Math.floor(u/65536),W=u-v*65536,u=he+v+65535,v=Math.floor(u/65536),he=u-v*65536,u=be+v+65535,v=Math.floor(u/65536),be=u-v*65536,u=de+v+65535,v=Math.floor(u/65536),de=u-v*65536,u=ve+v+65535,v=Math.floor(u/65536),ve=u-v*65536,u=Fe+v+65535,v=Math.floor(u/65536),Fe=u-v*65536,u=Re+v+65535,v=Math.floor(u/65536),Re=u-v*65536,u=_e+v+65535,v=Math.floor(u/65536),_e=u-v*65536,u=pe+v+65535,v=Math.floor(u/65536),pe=u-v*65536,u=fe+v+65535,v=Math.floor(u/65536),fe=u-v*65536,u=ue+v+65535,v=Math.floor(u/65536),ue=u-v*65536,u=ce+v+65535,v=Math.floor(u/65536),ce=u-v*65536,u=ae+v+65535,v=Math.floor(u/65536),ae=u-v*65536,u=oe+v+65535,v=Math.floor(u/65536),oe=u-v*65536,u=re+v+65535,v=Math.floor(u/65536),re=u-v*65536,H+=v-1+37*(v-1),N[0]=H,N[1]=W,N[2]=he,N[3]=be,N[4]=de,N[5]=ve,N[6]=Fe,N[7]=Re,N[8]=_e,N[9]=pe,N[10]=fe,N[11]=ue,N[12]=ce,N[13]=ae,N[14]=oe,N[15]=re}function d(N,T){o(N,T,T)}function C(N,T){const D=n();let u;for(u=0;u<16;u++)D[u]=T[u];for(u=253;u>=0;u--)d(D,D),u!==2&&u!==4&&o(D,D,T);for(u=0;u<16;u++)N[u]=D[u]}function L(N,T){const D=n();let u;for(u=0;u<16;u++)D[u]=T[u];for(u=250;u>=0;u--)d(D,D),u!==1&&o(D,D,T);for(u=0;u<16;u++)N[u]=D[u]}function K(N,T){const D=n(),u=n(),v=n(),H=n(),W=n(),he=n(),be=n(),de=n(),ve=n();p(D,N[1],N[0]),p(ve,T[1],T[0]),o(D,D,ve),E(u,N[0],N[1]),E(ve,T[0],T[1]),o(u,u,ve),o(v,N[3],T[3]),o(v,v,l),o(H,N[2],T[2]),E(H,H,H),p(W,u,D),p(he,H,v),E(be,H,v),E(de,u,D),o(N[0],W,he),o(N[1],de,be),o(N[2],be,he),o(N[3],W,de)}function G(N,T,D){for(let u=0;u<4;u++)P(N[u],T[u],D)}function J(N,T){const D=n(),u=n(),v=n();C(v,T[2]),o(D,T[0],v),o(u,T[1],v),A(N,u),N[31]^=x(D)<<7}function O(N,T,D){w(N[0],a),w(N[1],c),w(N[2],c),w(N[3],a);for(let u=255;u>=0;--u){const v=D[u/8|0]>>(u&7)&1;G(N,T,v),K(T,N),K(N,N),G(N,T,v)}}function R(N,T){const D=[n(),n(),n(),n()];w(D[0],f),w(D[1],y),w(D[2],c),o(D[3],f,y),O(N,D,T)}function k(N){if(N.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const T=(0,r.hash)(N);T[0]&=248,T[31]&=127,T[31]|=64;const D=new Uint8Array(32),u=[n(),n(),n(),n()];R(u,T),J(D,u);const v=new Uint8Array(64);return v.set(N),v.set(D,32),{publicKey:D,secretKey:v}}t.generateKeyPairFromSeed=k;function q(N){const T=(0,e.randomBytes)(32,N),D=k(T);return(0,i.wipe)(T),D}t.generateKeyPair=q;function U(N){if(N.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(N.subarray(32))}t.extractPublicKeyFromSecretKey=U;const M=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function F(N,T){let D,u,v,H;for(u=63;u>=32;--u){for(D=0,v=u-32,H=u-12;v<H;++v)T[v]+=D-16*T[u]*M[v-(u-32)],D=Math.floor((T[v]+128)/256),T[v]-=D*256;T[v]+=D,T[u]=0}for(D=0,v=0;v<32;v++)T[v]+=D-(T[31]>>4)*M[v],D=T[v]>>8,T[v]&=255;for(v=0;v<32;v++)T[v]-=D*M[v];for(u=0;u<32;u++)T[u+1]+=T[u]>>8,N[u]=T[u]&255}function B(N){const T=new Float64Array(64);for(let D=0;D<64;D++)T[D]=N[D];for(let D=0;D<64;D++)N[D]=0;F(N,T)}function te(N,T){const D=new Float64Array(64),u=[n(),n(),n(),n()],v=(0,r.hash)(N.subarray(0,32));v[0]&=248,v[31]&=127,v[31]|=64;const H=new Uint8Array(64);H.set(v.subarray(32),32);const W=new r.SHA512;W.update(H.subarray(32)),W.update(T);const he=W.digest();W.clean(),B(he),R(u,he),J(H,u),W.reset(),W.update(H.subarray(0,32)),W.update(N.subarray(32)),W.update(T);const be=W.digest();B(be);for(let de=0;de<32;de++)D[de]=he[de];for(let de=0;de<32;de++)for(let ve=0;ve<32;ve++)D[de+ve]+=be[de]*v[ve];return F(H.subarray(32),D),H}t.sign=te;function z(N,T){const D=n(),u=n(),v=n(),H=n(),W=n(),he=n(),be=n();return w(N[2],c),b(N[1],T),d(v,N[1]),o(H,v,h),p(v,v,N[2]),E(H,N[2],H),d(W,H),d(he,W),o(be,he,W),o(D,be,v),o(D,D,H),L(D,D),o(D,D,v),o(D,D,H),o(D,D,H),o(N[0],D,H),d(u,N[0]),o(u,u,H),S(u,v)&&o(N[0],N[0],g),d(u,N[0]),o(u,u,H),S(u,v)?-1:(x(N[0])===T[31]>>7&&p(N[0],a,N[0]),o(N[3],N[0],N[1]),0)}function Z(N,T,D){const u=new Uint8Array(32),v=[n(),n(),n(),n()],H=[n(),n(),n(),n()];if(D.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(z(H,N))return!1;const W=new r.SHA512;W.update(D.subarray(0,32)),W.update(N),W.update(T);const he=W.digest();return B(he),O(v,H,he),R(H,D.subarray(32)),K(v,H),J(u,v),!j(D,u)}t.verify=Z;function Y(N){let T=[n(),n(),n(),n()];if(z(T,N))throw new Error("Ed25519: invalid public key");let D=n(),u=n(),v=T[1];E(D,c,v),p(u,c,v),C(u,u),o(D,D,u);let H=new Uint8Array(32);return A(H,D),H}t.convertPublicKeyToX25519=Y;function ee(N){const T=(0,r.hash)(N.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const D=new Uint8Array(T.subarray(0,32));return(0,i.wipe)(T),D}t.convertSecretKeyToX25519=ee}(Ji);const oh="EdDSA",ah="JWT",zs=".",Ks="base64url",ch="utf8",uh="utf8",lh=":",hh="did",fh="key",Hs="base58btc",dh="z",ph="K36",gh=32;function rn(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Vs(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?rn(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function nn(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=Vs(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return rn(r)}function yh(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=n}var c=t.length,h=t.charAt(0),l=Math.log(c)/Math.log(256),f=Math.log(256)/Math.log(c);function y(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var P=0,A=0,j=0,S=m.length;j!==S&&m[j]===0;)j++,P++;for(var x=(S-j)*f+1>>>0,b=new Uint8Array(x);j!==S;){for(var E=m[j],p=0,o=x-1;(E!==0||p<A)&&o!==-1;o--,p++)E+=256*b[o]>>>0,b[o]=E%c>>>0,E=E/c>>>0;if(E!==0)throw new Error("Non-zero carry");A=p,j++}for(var d=x-A;d!==x&&b[d]===0;)d++;for(var C=h.repeat(P);d<x;++d)C+=t.charAt(b[d]);return C}function g(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var P=0;if(m[P]!==" "){for(var A=0,j=0;m[P]===h;)A++,P++;for(var S=(m.length-P)*l+1>>>0,x=new Uint8Array(S);m[P];){var b=r[m.charCodeAt(P)];if(b===255)return;for(var E=0,p=S-1;(b!==0||E<j)&&p!==-1;p--,E++)b+=c*x[p]>>>0,x[p]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");j=E,P++}if(m[P]!==" "){for(var o=S-j;o!==S&&x[o]===0;)o++;for(var d=new Uint8Array(A+(S-o)),C=A;o!==S;)d[C++]=x[o++];return d}}}function w(m){var P=g(m);if(P)return P;throw new Error(`Non-${e} character`)}return{encode:y,decodeUnsafe:g,decode:w}}var _h=yh,bh=_h;const Gs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},wh=t=>new TextEncoder().encode(t),mh=t=>new TextDecoder().decode(t);class vh{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Eh{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ks(this,e)}}class Sh{constructor(e){this.decoders=e}or(e){return ks(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ks=(t,e)=>new Sh({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Dh{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new vh(e,r,i),this.decoder=new Eh(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ci=({name:t,prefix:e,encode:r,decode:i})=>new Dh(t,e,r,i),Nr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=bh(r,e);return ci({prefix:t,name:e,encode:i,decode:s=>Gs(n(s))})},Ih=(t,e,r,i)=>{const n={};for(let f=0;f<e.length;++f)n[e[f]]=f;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let c=0,h=0,l=0;for(let f=0;f<s;++f){const y=n[t[f]];if(y===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|y,c+=r,c>=8&&(c-=8,a[l++]=255&h>>c)}if(c>=r||255&h<<8-c)throw new SyntaxError("Unexpected end of data");return a},Oh=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",a=0,c=0;for(let h=0;h<t.length;++h)for(c=c<<8|t[h],a+=8;a>r;)a-=r,s+=e[n&c>>a];if(a&&(s+=e[n&c<<r-a]),i)for(;s.length*r&7;)s+="=";return s},et=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>ci({prefix:e,name:t,encode(n){return Oh(n,i,r)},decode(n){return Ih(n,i,r,t)}}),xh=ci({prefix:"\0",name:"identity",encode:t=>mh(t),decode:t=>wh(t)});var Th=Object.freeze({__proto__:null,identity:xh});const Nh=et({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ph=Object.freeze({__proto__:null,base2:Nh});const Rh=et({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ah=Object.freeze({__proto__:null,base8:Rh});const Ch=Nr({prefix:"9",name:"base10",alphabet:"0123456789"});var Lh=Object.freeze({__proto__:null,base10:Ch});const Fh=et({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Uh=et({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var $h=Object.freeze({__proto__:null,base16:Fh,base16upper:Uh});const Mh=et({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),jh=et({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),qh=et({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Bh=et({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),zh=et({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Kh=et({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Hh=et({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Vh=et({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Gh=et({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var kh=Object.freeze({__proto__:null,base32:Mh,base32upper:jh,base32pad:qh,base32padupper:Bh,base32hex:zh,base32hexupper:Kh,base32hexpad:Hh,base32hexpadupper:Vh,base32z:Gh});const Wh=Nr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Yh=Nr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Xh=Object.freeze({__proto__:null,base36:Wh,base36upper:Yh});const Jh=Nr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Qh=Nr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Zh=Object.freeze({__proto__:null,base58btc:Jh,base58flickr:Qh});const ef=et({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),tf=et({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),rf=et({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),nf=et({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var sf=Object.freeze({__proto__:null,base64:ef,base64pad:tf,base64url:rf,base64urlpad:nf});const Ws=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),of=Ws.reduce((t,e,r)=>(t[r]=e,t),[]),af=Ws.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function cf(t){return t.reduce((e,r)=>(e+=of[r],e),"")}function uf(t){const e=[];for(const r of t){const i=af[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const lf=ci({prefix:"\u{1F680}",name:"base256emoji",encode:cf,decode:uf});var hf=Object.freeze({__proto__:null,base256emoji:lf}),ff=Xs,Ys=128,df=127,pf=~df,gf=Math.pow(2,31);function Xs(t,e,r){e=e||[],r=r||0;for(var i=r;t>=gf;)e[r++]=t&255|Ys,t/=128;for(;t&pf;)e[r++]=t&255|Ys,t>>>=7;return e[r]=t|0,Xs.bytes=r-i+1,e}var yf=sn,_f=128,Js=127;function sn(t,i){var r=0,i=i||0,n=0,s=i,a,c=t.length;do{if(s>=c)throw sn.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=n<28?(a&Js)<<n:(a&Js)*Math.pow(2,n),n+=7}while(a>=_f);return sn.bytes=s-i,r}var bf=Math.pow(2,7),wf=Math.pow(2,14),mf=Math.pow(2,21),vf=Math.pow(2,28),Ef=Math.pow(2,35),Sf=Math.pow(2,42),Df=Math.pow(2,49),If=Math.pow(2,56),Of=Math.pow(2,63),xf=function(t){return t<bf?1:t<wf?2:t<mf?3:t<vf?4:t<Ef?5:t<Sf?6:t<Df?7:t<If?8:t<Of?9:10},Tf={encode:ff,decode:yf,encodingLength:xf},Qs=Tf;const Zs=(t,e,r=0)=>(Qs.encode(t,e,r),e),eo=t=>Qs.encodingLength(t),on=(t,e)=>{const r=e.byteLength,i=eo(t),n=i+eo(r),s=new Uint8Array(n+r);return Zs(t,s,0),Zs(r,s,i),s.set(e,n),new Nf(t,r,e,s)};class Nf{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const to=({name:t,code:e,encode:r})=>new Pf(t,e,r);class Pf{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?on(this.code,r):r.then(i=>on(this.code,i))}else throw Error("Unknown type, must be binary type")}}const ro=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Rf=to({name:"sha2-256",code:18,encode:ro("SHA-256")}),Af=to({name:"sha2-512",code:19,encode:ro("SHA-512")});var Cf=Object.freeze({__proto__:null,sha256:Rf,sha512:Af});const io=0,Lf="identity",no=Gs;var Ff=Object.freeze({__proto__:null,identity:{code:io,name:Lf,encode:no,digest:t=>on(io,no(t))}});new TextEncoder,new TextDecoder;const so={...Th,...Ph,...Ah,...Lh,...$h,...kh,...Xh,...Zh,...sf,...hf};({...Cf,...Ff});function oo(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const ao=oo("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),an=oo("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Vs(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),co={utf8:ao,"utf-8":ao,hex:so.base16,latin1:an,ascii:an,binary:an,...so};function at(t,e="utf8"){const r=co[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function pt(t,e="utf8"){const r=co[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?rn(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function ui(t){return at(pt(vr(t),ch),Ks)}function uo(t){const e=pt(ph,Hs),r=dh+at(nn([e,t]),Hs);return[hh,fh,r].join(lh)}function Uf(t){return at(t,Ks)}function $f(t){return pt([ui(t.header),ui(t.payload)].join(zs),uh)}function Mf(t){return[ui(t.header),ui(t.payload),Uf(t.signature)].join(zs)}function lo(t=ur.randomBytes(gh)){return Ji.generateKeyPairFromSeed(t)}async function jf(t,e,r,i,n=Q.fromMiliseconds(Date.now())){const s={alg:oh,typ:ah},a=uo(i.publicKey),c=n+r,h={iss:a,sub:t,aud:e,iat:n,exp:c},l=$f({header:s,payload:h}),f=Ji.sign(i.secretKey,l);return Mf({header:s,payload:h,signature:f})}var cn={},li={};Object.defineProperty(li,"__esModule",{value:!0});var it=ie,un=_t,qf=20;function Bf(t,e,r){for(var i=1634760805,n=857760878,s=2036477234,a=1797285236,c=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],l=r[11]<<24|r[10]<<16|r[9]<<8|r[8],f=r[15]<<24|r[14]<<16|r[13]<<8|r[12],y=r[19]<<24|r[18]<<16|r[17]<<8|r[16],g=r[23]<<24|r[22]<<16|r[21]<<8|r[20],w=r[27]<<24|r[26]<<16|r[25]<<8|r[24],m=r[31]<<24|r[30]<<16|r[29]<<8|r[28],P=e[3]<<24|e[2]<<16|e[1]<<8|e[0],A=e[7]<<24|e[6]<<16|e[5]<<8|e[4],j=e[11]<<24|e[10]<<16|e[9]<<8|e[8],S=e[15]<<24|e[14]<<16|e[13]<<8|e[12],x=i,b=n,E=s,p=a,o=c,d=h,C=l,L=f,K=y,G=g,J=w,O=m,R=P,k=A,q=j,U=S,M=0;M<qf;M+=2)x=x+o|0,R^=x,R=R>>>32-16|R<<16,K=K+R|0,o^=K,o=o>>>32-12|o<<12,b=b+d|0,k^=b,k=k>>>32-16|k<<16,G=G+k|0,d^=G,d=d>>>32-12|d<<12,E=E+C|0,q^=E,q=q>>>32-16|q<<16,J=J+q|0,C^=J,C=C>>>32-12|C<<12,p=p+L|0,U^=p,U=U>>>32-16|U<<16,O=O+U|0,L^=O,L=L>>>32-12|L<<12,E=E+C|0,q^=E,q=q>>>32-8|q<<8,J=J+q|0,C^=J,C=C>>>32-7|C<<7,p=p+L|0,U^=p,U=U>>>32-8|U<<8,O=O+U|0,L^=O,L=L>>>32-7|L<<7,b=b+d|0,k^=b,k=k>>>32-8|k<<8,G=G+k|0,d^=G,d=d>>>32-7|d<<7,x=x+o|0,R^=x,R=R>>>32-8|R<<8,K=K+R|0,o^=K,o=o>>>32-7|o<<7,x=x+d|0,U^=x,U=U>>>32-16|U<<16,J=J+U|0,d^=J,d=d>>>32-12|d<<12,b=b+C|0,R^=b,R=R>>>32-16|R<<16,O=O+R|0,C^=O,C=C>>>32-12|C<<12,E=E+L|0,k^=E,k=k>>>32-16|k<<16,K=K+k|0,L^=K,L=L>>>32-12|L<<12,p=p+o|0,q^=p,q=q>>>32-16|q<<16,G=G+q|0,o^=G,o=o>>>32-12|o<<12,E=E+L|0,k^=E,k=k>>>32-8|k<<8,K=K+k|0,L^=K,L=L>>>32-7|L<<7,p=p+o|0,q^=p,q=q>>>32-8|q<<8,G=G+q|0,o^=G,o=o>>>32-7|o<<7,b=b+C|0,R^=b,R=R>>>32-8|R<<8,O=O+R|0,C^=O,C=C>>>32-7|C<<7,x=x+d|0,U^=x,U=U>>>32-8|U<<8,J=J+U|0,d^=J,d=d>>>32-7|d<<7;it.writeUint32LE(x+i|0,t,0),it.writeUint32LE(b+n|0,t,4),it.writeUint32LE(E+s|0,t,8),it.writeUint32LE(p+a|0,t,12),it.writeUint32LE(o+c|0,t,16),it.writeUint32LE(d+h|0,t,20),it.writeUint32LE(C+l|0,t,24),it.writeUint32LE(L+f|0,t,28),it.writeUint32LE(K+y|0,t,32),it.writeUint32LE(G+g|0,t,36),it.writeUint32LE(J+w|0,t,40),it.writeUint32LE(O+m|0,t,44),it.writeUint32LE(R+P|0,t,48),it.writeUint32LE(k+A|0,t,52),it.writeUint32LE(q+j|0,t,56),it.writeUint32LE(U+S|0,t,60)}function ho(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,a;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),a=s.length-e.length,s.set(e,a)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,a=n}for(var c=new Uint8Array(64),h=0;h<r.length;h+=64){Bf(c,s,t);for(var l=h;l<h+64&&l<r.length;l++)i[l]=r[l]^c[l-h];Kf(s,0,a)}return un.wipe(c),n===0&&un.wipe(s),i}li.streamXOR=ho;function zf(t,e,r,i){return i===void 0&&(i=0),un.wipe(r),ho(t,e,r,r,i)}li.stream=zf;function Kf(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var fo={},jt={};Object.defineProperty(jt,"__esModule",{value:!0});function Hf(t,e,r){return~(t-1)&e|t-1&r}jt.select=Hf;function Vf(t,e){return(t|0)-(e|0)-1>>>31&1}jt.lessOrEqual=Vf;function po(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}jt.compare=po;function Gf(t,e){return t.length===0||e.length===0?!1:po(t,e)!==0}jt.equal=Gf,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=jt,r=_t;t.DIGEST_LENGTH=16;var i=function(){function a(c){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=c[0]|c[1]<<8;this._r[0]=h&8191;var l=c[2]|c[3]<<8;this._r[1]=(h>>>13|l<<3)&8191;var f=c[4]|c[5]<<8;this._r[2]=(l>>>10|f<<6)&7939;var y=c[6]|c[7]<<8;this._r[3]=(f>>>7|y<<9)&8191;var g=c[8]|c[9]<<8;this._r[4]=(y>>>4|g<<12)&255,this._r[5]=g>>>1&8190;var w=c[10]|c[11]<<8;this._r[6]=(g>>>14|w<<2)&8191;var m=c[12]|c[13]<<8;this._r[7]=(w>>>11|m<<5)&8065;var P=c[14]|c[15]<<8;this._r[8]=(m>>>8|P<<8)&8191,this._r[9]=P>>>5&127,this._pad[0]=c[16]|c[17]<<8,this._pad[1]=c[18]|c[19]<<8,this._pad[2]=c[20]|c[21]<<8,this._pad[3]=c[22]|c[23]<<8,this._pad[4]=c[24]|c[25]<<8,this._pad[5]=c[26]|c[27]<<8,this._pad[6]=c[28]|c[29]<<8,this._pad[7]=c[30]|c[31]<<8}return a.prototype._blocks=function(c,h,l){for(var f=this._fin?0:2048,y=this._h[0],g=this._h[1],w=this._h[2],m=this._h[3],P=this._h[4],A=this._h[5],j=this._h[6],S=this._h[7],x=this._h[8],b=this._h[9],E=this._r[0],p=this._r[1],o=this._r[2],d=this._r[3],C=this._r[4],L=this._r[5],K=this._r[6],G=this._r[7],J=this._r[8],O=this._r[9];l>=16;){var R=c[h+0]|c[h+1]<<8;y+=R&8191;var k=c[h+2]|c[h+3]<<8;g+=(R>>>13|k<<3)&8191;var q=c[h+4]|c[h+5]<<8;w+=(k>>>10|q<<6)&8191;var U=c[h+6]|c[h+7]<<8;m+=(q>>>7|U<<9)&8191;var M=c[h+8]|c[h+9]<<8;P+=(U>>>4|M<<12)&8191,A+=M>>>1&8191;var F=c[h+10]|c[h+11]<<8;j+=(M>>>14|F<<2)&8191;var B=c[h+12]|c[h+13]<<8;S+=(F>>>11|B<<5)&8191;var te=c[h+14]|c[h+15]<<8;x+=(B>>>8|te<<8)&8191,b+=te>>>5|f;var z=0,Z=z;Z+=y*E,Z+=g*(5*O),Z+=w*(5*J),Z+=m*(5*G),Z+=P*(5*K),z=Z>>>13,Z&=8191,Z+=A*(5*L),Z+=j*(5*C),Z+=S*(5*d),Z+=x*(5*o),Z+=b*(5*p),z+=Z>>>13,Z&=8191;var Y=z;Y+=y*p,Y+=g*E,Y+=w*(5*O),Y+=m*(5*J),Y+=P*(5*G),z=Y>>>13,Y&=8191,Y+=A*(5*K),Y+=j*(5*L),Y+=S*(5*C),Y+=x*(5*d),Y+=b*(5*o),z+=Y>>>13,Y&=8191;var ee=z;ee+=y*o,ee+=g*p,ee+=w*E,ee+=m*(5*O),ee+=P*(5*J),z=ee>>>13,ee&=8191,ee+=A*(5*G),ee+=j*(5*K),ee+=S*(5*L),ee+=x*(5*C),ee+=b*(5*d),z+=ee>>>13,ee&=8191;var N=z;N+=y*d,N+=g*o,N+=w*p,N+=m*E,N+=P*(5*O),z=N>>>13,N&=8191,N+=A*(5*J),N+=j*(5*G),N+=S*(5*K),N+=x*(5*L),N+=b*(5*C),z+=N>>>13,N&=8191;var T=z;T+=y*C,T+=g*d,T+=w*o,T+=m*p,T+=P*E,z=T>>>13,T&=8191,T+=A*(5*O),T+=j*(5*J),T+=S*(5*G),T+=x*(5*K),T+=b*(5*L),z+=T>>>13,T&=8191;var D=z;D+=y*L,D+=g*C,D+=w*d,D+=m*o,D+=P*p,z=D>>>13,D&=8191,D+=A*E,D+=j*(5*O),D+=S*(5*J),D+=x*(5*G),D+=b*(5*K),z+=D>>>13,D&=8191;var u=z;u+=y*K,u+=g*L,u+=w*C,u+=m*d,u+=P*o,z=u>>>13,u&=8191,u+=A*p,u+=j*E,u+=S*(5*O),u+=x*(5*J),u+=b*(5*G),z+=u>>>13,u&=8191;var v=z;v+=y*G,v+=g*K,v+=w*L,v+=m*C,v+=P*d,z=v>>>13,v&=8191,v+=A*o,v+=j*p,v+=S*E,v+=x*(5*O),v+=b*(5*J),z+=v>>>13,v&=8191;var H=z;H+=y*J,H+=g*G,H+=w*K,H+=m*L,H+=P*C,z=H>>>13,H&=8191,H+=A*d,H+=j*o,H+=S*p,H+=x*E,H+=b*(5*O),z+=H>>>13,H&=8191;var W=z;W+=y*O,W+=g*J,W+=w*G,W+=m*K,W+=P*L,z=W>>>13,W&=8191,W+=A*C,W+=j*d,W+=S*o,W+=x*p,W+=b*E,z+=W>>>13,W&=8191,z=(z<<2)+z|0,z=z+Z|0,Z=z&8191,z=z>>>13,Y+=z,y=Z,g=Y,w=ee,m=N,P=T,A=D,j=u,S=v,x=H,b=W,h+=16,l-=16}this._h[0]=y,this._h[1]=g,this._h[2]=w,this._h[3]=m,this._h[4]=P,this._h[5]=A,this._h[6]=j,this._h[7]=S,this._h[8]=x,this._h[9]=b},a.prototype.finish=function(c,h){h===void 0&&(h=0);var l=new Uint16Array(10),f,y,g,w;if(this._leftover){for(w=this._leftover,this._buffer[w++]=1;w<16;w++)this._buffer[w]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(f=this._h[1]>>>13,this._h[1]&=8191,w=2;w<10;w++)this._h[w]+=f,f=this._h[w]>>>13,this._h[w]&=8191;for(this._h[0]+=f*5,f=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=f,f=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=f,l[0]=this._h[0]+5,f=l[0]>>>13,l[0]&=8191,w=1;w<10;w++)l[w]=this._h[w]+f,f=l[w]>>>13,l[w]&=8191;for(l[9]-=8192,y=(f^1)-1,w=0;w<10;w++)l[w]&=y;for(y=~y,w=0;w<10;w++)this._h[w]=this._h[w]&y|l[w];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,g=this._h[0]+this._pad[0],this._h[0]=g&65535,w=1;w<8;w++)g=(this._h[w]+this._pad[w]|0)+(g>>>16)|0,this._h[w]=g&65535;return c[h+0]=this._h[0]>>>0,c[h+1]=this._h[0]>>>8,c[h+2]=this._h[1]>>>0,c[h+3]=this._h[1]>>>8,c[h+4]=this._h[2]>>>0,c[h+5]=this._h[2]>>>8,c[h+6]=this._h[3]>>>0,c[h+7]=this._h[3]>>>8,c[h+8]=this._h[4]>>>0,c[h+9]=this._h[4]>>>8,c[h+10]=this._h[5]>>>0,c[h+11]=this._h[5]>>>8,c[h+12]=this._h[6]>>>0,c[h+13]=this._h[6]>>>8,c[h+14]=this._h[7]>>>0,c[h+15]=this._h[7]>>>8,this._finished=!0,this},a.prototype.update=function(c){var h=0,l=c.length,f;if(this._leftover){f=16-this._leftover,f>l&&(f=l);for(var y=0;y<f;y++)this._buffer[this._leftover+y]=c[h+y];if(l-=f,h+=f,this._leftover+=f,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(l>=16&&(f=l-l%16,this._blocks(c,h,f),h+=f,l-=f),l){for(var y=0;y<l;y++)this._buffer[this._leftover+y]=c[h+y];this._leftover+=l}return this},a.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var c=new Uint8Array(16);return this.finish(c),c},a.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},a}();t.Poly1305=i;function n(a,c){var h=new i(a);h.update(c);var l=h.digest();return h.clean(),l}t.oneTimeAuth=n;function s(a,c){return a.length!==t.DIGEST_LENGTH||c.length!==t.DIGEST_LENGTH?!1:e.equal(a,c)}t.equal=s}(fo),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=li,r=fo,i=_t,n=ie,s=jt;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var a=new Uint8Array(16),c=function(){function h(l){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,l.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(l)}return h.prototype.seal=function(l,f,y,g){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var w=new Uint8Array(16);w.set(l,w.length-l.length);var m=new Uint8Array(32);e.stream(this._key,w,m,4);var P=f.length+this.tagLength,A;if(g){if(g.length!==P)throw new Error("ChaCha20Poly1305: incorrect destination length");A=g}else A=new Uint8Array(P);return e.streamXOR(this._key,w,f,A,4),this._authenticate(A.subarray(A.length-this.tagLength,A.length),m,A.subarray(0,A.length-this.tagLength),y),i.wipe(w),A},h.prototype.open=function(l,f,y,g){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(f.length<this.tagLength)return null;var w=new Uint8Array(16);w.set(l,w.length-l.length);var m=new Uint8Array(32);e.stream(this._key,w,m,4);var P=new Uint8Array(this.tagLength);if(this._authenticate(P,m,f.subarray(0,f.length-this.tagLength),y),!s.equal(P,f.subarray(f.length-this.tagLength,f.length)))return null;var A=f.length-this.tagLength,j;if(g){if(g.length!==A)throw new Error("ChaCha20Poly1305: incorrect destination length");j=g}else j=new Uint8Array(A);return e.streamXOR(this._key,w,f.subarray(0,f.length-this.tagLength),j,4),i.wipe(w),j},h.prototype.clean=function(){return i.wipe(this._key),this},h.prototype._authenticate=function(l,f,y,g){var w=new r.Poly1305(f);g&&(w.update(g),g.length%16>0&&w.update(a.subarray(g.length%16))),w.update(y),y.length%16>0&&w.update(a.subarray(y.length%16));var m=new Uint8Array(8);g&&n.writeUint64LE(g.length,m),w.update(m),n.writeUint64LE(y.length,m),w.update(m);for(var P=w.digest(),A=0;A<P.length;A++)l[A]=P[A];w.clean(),i.wipe(P),i.wipe(m)},h}();t.ChaCha20Poly1305=c}(cn);var go={},Pr={},ln={};Object.defineProperty(ln,"__esModule",{value:!0});function kf(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}ln.isSerializableHash=kf,Object.defineProperty(Pr,"__esModule",{value:!0});var Nt=ln,Wf=jt,Yf=_t,yo=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),Nt.isSerializableHash(this._inner)&&Nt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Yf.wipe(i)}return t.prototype.reset=function(){if(!Nt.isSerializableHash(this._inner)||!Nt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Nt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Nt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!Nt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!Nt.isSerializableHash(this._inner)||!Nt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!Nt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Pr.HMAC=yo;function Xf(t,e,r){var i=new yo(t,e);i.update(r);var n=i.digest();return i.clean(),n}Pr.hmac=Xf,Pr.equal=Wf.equal,Object.defineProperty(go,"__esModule",{value:!0});var _o=Pr,bo=_t,Jf=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=_o.hmac(this._hash,i,r);this._hmac=new _o.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),bo.wipe(this._buffer),bo.wipe(this._counter),this._bufpos=0},t}(),Qf=go.HKDF=Jf,hi={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ie,r=_t;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},c.prototype.update=function(h,l){if(l===void 0&&(l=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var f=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&l>0;)this._buffer[this._bufferLength++]=h[f++],l--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(f=s(this._temp,this._state,h,f,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=h[f++],l--;return this},c.prototype.finish=function(h){if(!this._finished){var l=this._bytesHashed,f=this._bufferLength,y=l/536870912|0,g=l<<3,w=l%64<56?64:128;this._buffer[f]=128;for(var m=f+1;m<w-8;m++)this._buffer[m]=0;e.writeUint32BE(y,this._buffer,w-8),e.writeUint32BE(g,this._buffer,w-4),s(this._temp,this._state,this._buffer,0,w),this._finished=!0}for(var m=0;m<this.digestLength/4;m++)e.writeUint32BE(this._state[m],h,m*4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();t.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(c,h,l,f,y){for(;y>=64;){for(var g=h[0],w=h[1],m=h[2],P=h[3],A=h[4],j=h[5],S=h[6],x=h[7],b=0;b<16;b++){var E=f+b*4;c[b]=e.readUint32BE(l,E)}for(var b=16;b<64;b++){var p=c[b-2],o=(p>>>17|p<<32-17)^(p>>>19|p<<32-19)^p>>>10;p=c[b-15];var d=(p>>>7|p<<32-7)^(p>>>18|p<<32-18)^p>>>3;c[b]=(o+c[b-7]|0)+(d+c[b-16]|0)}for(var b=0;b<64;b++){var o=(((A>>>6|A<<26)^(A>>>11|A<<21)^(A>>>25|A<<7))+(A&j^~A&S)|0)+(x+(n[b]+c[b]|0)|0)|0,d=((g>>>2|g<<32-2)^(g>>>13|g<<32-13)^(g>>>22|g<<32-22))+(g&w^g&m^w&m)|0;x=S,S=j,j=A,A=P+o|0,P=m,m=w,w=g,g=o+d|0}h[0]+=g,h[1]+=w,h[2]+=m,h[3]+=P,h[4]+=A,h[5]+=j,h[6]+=S,h[7]+=x,f+=64,y-=64}return f}function a(c){var h=new i;h.update(c);var l=h.digest();return h.clean(),l}t.hash=a})(hi);var hn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=ur,r=_t;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(b){const E=new Float64Array(16);if(b)for(let p=0;p<b.length;p++)E[p]=b[p];return E}const n=new Uint8Array(32);n[0]=9;const s=i([56129,1]);function a(b){let E=1;for(let p=0;p<16;p++){let o=b[p]+E+65535;E=Math.floor(o/65536),b[p]=o-E*65536}b[0]+=E-1+37*(E-1)}function c(b,E,p){const o=~(p-1);for(let d=0;d<16;d++){const C=o&(b[d]^E[d]);b[d]^=C,E[d]^=C}}function h(b,E){const p=i(),o=i();for(let d=0;d<16;d++)o[d]=E[d];a(o),a(o),a(o);for(let d=0;d<2;d++){p[0]=o[0]-65517;for(let L=1;L<15;L++)p[L]=o[L]-65535-(p[L-1]>>16&1),p[L-1]&=65535;p[15]=o[15]-32767-(p[14]>>16&1);const C=p[15]>>16&1;p[14]&=65535,c(o,p,1-C)}for(let d=0;d<16;d++)b[2*d]=o[d]&255,b[2*d+1]=o[d]>>8}function l(b,E){for(let p=0;p<16;p++)b[p]=E[2*p]+(E[2*p+1]<<8);b[15]&=32767}function f(b,E,p){for(let o=0;o<16;o++)b[o]=E[o]+p[o]}function y(b,E,p){for(let o=0;o<16;o++)b[o]=E[o]-p[o]}function g(b,E,p){let o,d,C=0,L=0,K=0,G=0,J=0,O=0,R=0,k=0,q=0,U=0,M=0,F=0,B=0,te=0,z=0,Z=0,Y=0,ee=0,N=0,T=0,D=0,u=0,v=0,H=0,W=0,he=0,be=0,de=0,ve=0,Fe=0,Re=0,_e=p[0],pe=p[1],fe=p[2],ue=p[3],ce=p[4],ae=p[5],oe=p[6],re=p[7],le=p[8],ge=p[9],ne=p[10],we=p[11],me=p[12],De=p[13],Ie=p[14],Ee=p[15];o=E[0],C+=o*_e,L+=o*pe,K+=o*fe,G+=o*ue,J+=o*ce,O+=o*ae,R+=o*oe,k+=o*re,q+=o*le,U+=o*ge,M+=o*ne,F+=o*we,B+=o*me,te+=o*De,z+=o*Ie,Z+=o*Ee,o=E[1],L+=o*_e,K+=o*pe,G+=o*fe,J+=o*ue,O+=o*ce,R+=o*ae,k+=o*oe,q+=o*re,U+=o*le,M+=o*ge,F+=o*ne,B+=o*we,te+=o*me,z+=o*De,Z+=o*Ie,Y+=o*Ee,o=E[2],K+=o*_e,G+=o*pe,J+=o*fe,O+=o*ue,R+=o*ce,k+=o*ae,q+=o*oe,U+=o*re,M+=o*le,F+=o*ge,B+=o*ne,te+=o*we,z+=o*me,Z+=o*De,Y+=o*Ie,ee+=o*Ee,o=E[3],G+=o*_e,J+=o*pe,O+=o*fe,R+=o*ue,k+=o*ce,q+=o*ae,U+=o*oe,M+=o*re,F+=o*le,B+=o*ge,te+=o*ne,z+=o*we,Z+=o*me,Y+=o*De,ee+=o*Ie,N+=o*Ee,o=E[4],J+=o*_e,O+=o*pe,R+=o*fe,k+=o*ue,q+=o*ce,U+=o*ae,M+=o*oe,F+=o*re,B+=o*le,te+=o*ge,z+=o*ne,Z+=o*we,Y+=o*me,ee+=o*De,N+=o*Ie,T+=o*Ee,o=E[5],O+=o*_e,R+=o*pe,k+=o*fe,q+=o*ue,U+=o*ce,M+=o*ae,F+=o*oe,B+=o*re,te+=o*le,z+=o*ge,Z+=o*ne,Y+=o*we,ee+=o*me,N+=o*De,T+=o*Ie,D+=o*Ee,o=E[6],R+=o*_e,k+=o*pe,q+=o*fe,U+=o*ue,M+=o*ce,F+=o*ae,B+=o*oe,te+=o*re,z+=o*le,Z+=o*ge,Y+=o*ne,ee+=o*we,N+=o*me,T+=o*De,D+=o*Ie,u+=o*Ee,o=E[7],k+=o*_e,q+=o*pe,U+=o*fe,M+=o*ue,F+=o*ce,B+=o*ae,te+=o*oe,z+=o*re,Z+=o*le,Y+=o*ge,ee+=o*ne,N+=o*we,T+=o*me,D+=o*De,u+=o*Ie,v+=o*Ee,o=E[8],q+=o*_e,U+=o*pe,M+=o*fe,F+=o*ue,B+=o*ce,te+=o*ae,z+=o*oe,Z+=o*re,Y+=o*le,ee+=o*ge,N+=o*ne,T+=o*we,D+=o*me,u+=o*De,v+=o*Ie,H+=o*Ee,o=E[9],U+=o*_e,M+=o*pe,F+=o*fe,B+=o*ue,te+=o*ce,z+=o*ae,Z+=o*oe,Y+=o*re,ee+=o*le,N+=o*ge,T+=o*ne,D+=o*we,u+=o*me,v+=o*De,H+=o*Ie,W+=o*Ee,o=E[10],M+=o*_e,F+=o*pe,B+=o*fe,te+=o*ue,z+=o*ce,Z+=o*ae,Y+=o*oe,ee+=o*re,N+=o*le,T+=o*ge,D+=o*ne,u+=o*we,v+=o*me,H+=o*De,W+=o*Ie,he+=o*Ee,o=E[11],F+=o*_e,B+=o*pe,te+=o*fe,z+=o*ue,Z+=o*ce,Y+=o*ae,ee+=o*oe,N+=o*re,T+=o*le,D+=o*ge,u+=o*ne,v+=o*we,H+=o*me,W+=o*De,he+=o*Ie,be+=o*Ee,o=E[12],B+=o*_e,te+=o*pe,z+=o*fe,Z+=o*ue,Y+=o*ce,ee+=o*ae,N+=o*oe,T+=o*re,D+=o*le,u+=o*ge,v+=o*ne,H+=o*we,W+=o*me,he+=o*De,be+=o*Ie,de+=o*Ee,o=E[13],te+=o*_e,z+=o*pe,Z+=o*fe,Y+=o*ue,ee+=o*ce,N+=o*ae,T+=o*oe,D+=o*re,u+=o*le,v+=o*ge,H+=o*ne,W+=o*we,he+=o*me,be+=o*De,de+=o*Ie,ve+=o*Ee,o=E[14],z+=o*_e,Z+=o*pe,Y+=o*fe,ee+=o*ue,N+=o*ce,T+=o*ae,D+=o*oe,u+=o*re,v+=o*le,H+=o*ge,W+=o*ne,he+=o*we,be+=o*me,de+=o*De,ve+=o*Ie,Fe+=o*Ee,o=E[15],Z+=o*_e,Y+=o*pe,ee+=o*fe,N+=o*ue,T+=o*ce,D+=o*ae,u+=o*oe,v+=o*re,H+=o*le,W+=o*ge,he+=o*ne,be+=o*we,de+=o*me,ve+=o*De,Fe+=o*Ie,Re+=o*Ee,C+=38*Y,L+=38*ee,K+=38*N,G+=38*T,J+=38*D,O+=38*u,R+=38*v,k+=38*H,q+=38*W,U+=38*he,M+=38*be,F+=38*de,B+=38*ve,te+=38*Fe,z+=38*Re,d=1,o=C+d+65535,d=Math.floor(o/65536),C=o-d*65536,o=L+d+65535,d=Math.floor(o/65536),L=o-d*65536,o=K+d+65535,d=Math.floor(o/65536),K=o-d*65536,o=G+d+65535,d=Math.floor(o/65536),G=o-d*65536,o=J+d+65535,d=Math.floor(o/65536),J=o-d*65536,o=O+d+65535,d=Math.floor(o/65536),O=o-d*65536,o=R+d+65535,d=Math.floor(o/65536),R=o-d*65536,o=k+d+65535,d=Math.floor(o/65536),k=o-d*65536,o=q+d+65535,d=Math.floor(o/65536),q=o-d*65536,o=U+d+65535,d=Math.floor(o/65536),U=o-d*65536,o=M+d+65535,d=Math.floor(o/65536),M=o-d*65536,o=F+d+65535,d=Math.floor(o/65536),F=o-d*65536,o=B+d+65535,d=Math.floor(o/65536),B=o-d*65536,o=te+d+65535,d=Math.floor(o/65536),te=o-d*65536,o=z+d+65535,d=Math.floor(o/65536),z=o-d*65536,o=Z+d+65535,d=Math.floor(o/65536),Z=o-d*65536,C+=d-1+37*(d-1),d=1,o=C+d+65535,d=Math.floor(o/65536),C=o-d*65536,o=L+d+65535,d=Math.floor(o/65536),L=o-d*65536,o=K+d+65535,d=Math.floor(o/65536),K=o-d*65536,o=G+d+65535,d=Math.floor(o/65536),G=o-d*65536,o=J+d+65535,d=Math.floor(o/65536),J=o-d*65536,o=O+d+65535,d=Math.floor(o/65536),O=o-d*65536,o=R+d+65535,d=Math.floor(o/65536),R=o-d*65536,o=k+d+65535,d=Math.floor(o/65536),k=o-d*65536,o=q+d+65535,d=Math.floor(o/65536),q=o-d*65536,o=U+d+65535,d=Math.floor(o/65536),U=o-d*65536,o=M+d+65535,d=Math.floor(o/65536),M=o-d*65536,o=F+d+65535,d=Math.floor(o/65536),F=o-d*65536,o=B+d+65535,d=Math.floor(o/65536),B=o-d*65536,o=te+d+65535,d=Math.floor(o/65536),te=o-d*65536,o=z+d+65535,d=Math.floor(o/65536),z=o-d*65536,o=Z+d+65535,d=Math.floor(o/65536),Z=o-d*65536,C+=d-1+37*(d-1),b[0]=C,b[1]=L,b[2]=K,b[3]=G,b[4]=J,b[5]=O,b[6]=R,b[7]=k,b[8]=q,b[9]=U,b[10]=M,b[11]=F,b[12]=B,b[13]=te,b[14]=z,b[15]=Z}function w(b,E){g(b,E,E)}function m(b,E){const p=i();for(let o=0;o<16;o++)p[o]=E[o];for(let o=253;o>=0;o--)w(p,p),o!==2&&o!==4&&g(p,p,E);for(let o=0;o<16;o++)b[o]=p[o]}function P(b,E){const p=new Uint8Array(32),o=new Float64Array(80),d=i(),C=i(),L=i(),K=i(),G=i(),J=i();for(let q=0;q<31;q++)p[q]=b[q];p[31]=b[31]&127|64,p[0]&=248,l(o,E);for(let q=0;q<16;q++)C[q]=o[q];d[0]=K[0]=1;for(let q=254;q>=0;--q){const U=p[q>>>3]>>>(q&7)&1;c(d,C,U),c(L,K,U),f(G,d,L),y(d,d,L),f(L,C,K),y(C,C,K),w(K,G),w(J,d),g(d,L,d),g(L,C,G),f(G,d,L),y(d,d,L),w(C,d),y(L,K,J),g(d,L,s),f(d,d,K),g(L,L,d),g(d,K,J),g(K,C,o),w(C,G),c(d,C,U),c(L,K,U)}for(let q=0;q<16;q++)o[q+16]=d[q],o[q+32]=L[q],o[q+48]=C[q],o[q+64]=K[q];const O=o.subarray(32),R=o.subarray(16);m(O,O),g(R,R,O);const k=new Uint8Array(32);return h(k,R),k}t.scalarMult=P;function A(b){return P(b,n)}t.scalarMultBase=A;function j(b){if(b.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const E=new Uint8Array(b);return{publicKey:A(E),secretKey:E}}t.generateKeyPairFromSeed=j;function S(b){const E=(0,e.randomBytes)(32,b),p=j(E);return(0,r.wipe)(E),p}t.generateKeyPair=S;function x(b,E,p=!1){if(b.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(E.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=P(b,E);if(p){let d=0;for(let C=0;C<o.length;C++)d|=o[C];if(d===0)throw new Error("X25519: invalid shared key")}return o}t.sharedKey=x})(hn);var wo=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},Zf=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),ed=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),td=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),rd=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),id=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),nd=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,sd=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,mo=3,od=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",nd]],vo=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function ad(t){return t?Eo(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new id:typeof navigator<"u"?Eo(navigator.userAgent):ld()}function cd(t){return t!==""&&od.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]},!1)}function Eo(t){var e=cd(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new rd;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<mo&&(n=wo(wo([],n,!0),hd(mo-n.length),!0)):n=[];var s=n.join("."),a=ud(t),c=sd.exec(t);return c&&c[1]?new td(r,s,a,c[1]):new Zf(r,s,a)}function ud(t){for(var e=0,r=vo.length;e<r;e++){var i=vo[e],n=i[0],s=i[1],a=s.exec(t);if(a)return n}return null}function ld(){var t=typeof process<"u"&&process.version;return t?new ed(process.version.slice(1)):null}function hd(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var xe={};Object.defineProperty(xe,"__esModule",{value:!0}),xe.getLocalStorage=xe.getLocalStorageOrThrow=xe.getCrypto=xe.getCryptoOrThrow=So=xe.getLocation=xe.getLocationOrThrow=dn=xe.getNavigator=xe.getNavigatorOrThrow=fn=xe.getDocument=xe.getDocumentOrThrow=xe.getFromWindowOrThrow=xe.getFromWindow=void 0;function Zt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}xe.getFromWindow=Zt;function lr(t){const e=Zt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}xe.getFromWindowOrThrow=lr;function fd(){return lr("document")}xe.getDocumentOrThrow=fd;function dd(){return Zt("document")}var fn=xe.getDocument=dd;function pd(){return lr("navigator")}xe.getNavigatorOrThrow=pd;function gd(){return Zt("navigator")}var dn=xe.getNavigator=gd;function yd(){return lr("location")}xe.getLocationOrThrow=yd;function _d(){return Zt("location")}var So=xe.getLocation=_d;function bd(){return lr("crypto")}xe.getCryptoOrThrow=bd;function wd(){return Zt("crypto")}xe.getCrypto=wd;function md(){return lr("localStorage")}xe.getLocalStorageOrThrow=md;function vd(){return Zt("localStorage")}xe.getLocalStorage=vd;var pn={};Object.defineProperty(pn,"__esModule",{value:!0});var Do=pn.getWindowMetadata=void 0;const Io=xe;function Ed(){let t,e;try{t=Io.getDocumentOrThrow(),e=Io.getLocationOrThrow()}catch{return null}function r(){const y=t.getElementsByTagName("link"),g=[];for(let w=0;w<y.length;w++){const m=y[w],P=m.getAttribute("rel");if(P&&P.toLowerCase().indexOf("icon")>-1){const A=m.getAttribute("href");if(A)if(A.toLowerCase().indexOf("https:")===-1&&A.toLowerCase().indexOf("http:")===-1&&A.indexOf("//")!==0){let j=e.protocol+"//"+e.host;if(A.indexOf("/")===0)j+=A;else{const S=e.pathname.split("/");S.pop();const x=S.join("/");j+=x+"/"+A}g.push(j)}else if(A.indexOf("//")===0){const j=e.protocol+A;g.push(j)}else g.push(A)}}return g}function i(...y){const g=t.getElementsByTagName("meta");for(let w=0;w<g.length;w++){const m=g[w],P=["itemprop","property","name"].map(A=>m.getAttribute(A)).filter(A=>A?y.includes(A):!1);if(P.length&&P){const A=m.getAttribute("content");if(A)return A}}return""}function n(){let y=i("name","og:site_name","og:title","twitter:title");return y||(y=t.title),y}function s(){return i("description","og:description","twitter:description","keywords")}const a=n(),c=s(),h=e.origin,l=r();return{description:c,url:h,icons:l,name:a}}Do=pn.getWindowMetadata=Ed;var Rr={},Sd=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Oo="%[a-f0-9]{2}",xo=new RegExp("("+Oo+")|([^%]+?)","gi"),To=new RegExp("("+Oo+")+","gi");function gn(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],gn(r),gn(i))}function Dd(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(xo)||[],r=1;r<e.length;r++)t=gn(e,r).join(""),e=t.match(xo)||[];return t}}function Id(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=To.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var i=Dd(r[0]);i!==r[0]&&(e[r[0]]=i)}r=To.exec(t)}e["%C2"]="\uFFFD";for(var n=Object.keys(e),s=0;s<n.length;s++){var a=n[s];t=t.replace(new RegExp(a,"g"),e[a])}return t}var Od=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return Id(t)}},xd=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},Td=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),s=0;s<i.length;s++){var a=i[s],c=t[a];(n?e.indexOf(a)!==-1:e(a,c,t))&&(r[a]=c)}return r};(function(t){const e=Sd,r=Od,i=xd,n=Td,s=S=>S==null,a=Symbol("encodeFragmentIdentifier");function c(S){switch(S.arrayFormat){case"index":return x=>(b,E)=>{const p=b.length;return E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?b:E===null?[...b,[f(x,S),"[",p,"]"].join("")]:[...b,[f(x,S),"[",f(p,S),"]=",f(E,S)].join("")]};case"bracket":return x=>(b,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?b:E===null?[...b,[f(x,S),"[]"].join("")]:[...b,[f(x,S),"[]=",f(E,S)].join("")];case"colon-list-separator":return x=>(b,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?b:E===null?[...b,[f(x,S),":list="].join("")]:[...b,[f(x,S),":list=",f(E,S)].join("")];case"comma":case"separator":case"bracket-separator":{const x=S.arrayFormat==="bracket-separator"?"[]=":"=";return b=>(E,p)=>p===void 0||S.skipNull&&p===null||S.skipEmptyString&&p===""?E:(p=p===null?"":p,E.length===0?[[f(b,S),x,f(p,S)].join("")]:[[E,f(p,S)].join(S.arrayFormatSeparator)])}default:return x=>(b,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?b:E===null?[...b,f(x,S)]:[...b,[f(x,S),"=",f(E,S)].join("")]}}function h(S){let x;switch(S.arrayFormat){case"index":return(b,E,p)=>{if(x=/\[(\d*)\]$/.exec(b),b=b.replace(/\[\d*\]$/,""),!x){p[b]=E;return}p[b]===void 0&&(p[b]={}),p[b][x[1]]=E};case"bracket":return(b,E,p)=>{if(x=/(\[\])$/.exec(b),b=b.replace(/\[\]$/,""),!x){p[b]=E;return}if(p[b]===void 0){p[b]=[E];return}p[b]=[].concat(p[b],E)};case"colon-list-separator":return(b,E,p)=>{if(x=/(:list)$/.exec(b),b=b.replace(/:list$/,""),!x){p[b]=E;return}if(p[b]===void 0){p[b]=[E];return}p[b]=[].concat(p[b],E)};case"comma":case"separator":return(b,E,p)=>{const o=typeof E=="string"&&E.includes(S.arrayFormatSeparator),d=typeof E=="string"&&!o&&y(E,S).includes(S.arrayFormatSeparator);E=d?y(E,S):E;const C=o||d?E.split(S.arrayFormatSeparator).map(L=>y(L,S)):E===null?E:y(E,S);p[b]=C};case"bracket-separator":return(b,E,p)=>{const o=/(\[\])$/.test(b);if(b=b.replace(/\[\]$/,""),!o){p[b]=E&&y(E,S);return}const d=E===null?[]:E.split(S.arrayFormatSeparator).map(C=>y(C,S));if(p[b]===void 0){p[b]=d;return}p[b]=[].concat(p[b],d)};default:return(b,E,p)=>{if(p[b]===void 0){p[b]=E;return}p[b]=[].concat(p[b],E)}}}function l(S){if(typeof S!="string"||S.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function f(S,x){return x.encode?x.strict?e(S):encodeURIComponent(S):S}function y(S,x){return x.decode?r(S):S}function g(S){return Array.isArray(S)?S.sort():typeof S=="object"?g(Object.keys(S)).sort((x,b)=>Number(x)-Number(b)).map(x=>S[x]):S}function w(S){const x=S.indexOf("#");return x!==-1&&(S=S.slice(0,x)),S}function m(S){let x="";const b=S.indexOf("#");return b!==-1&&(x=S.slice(b)),x}function P(S){S=w(S);const x=S.indexOf("?");return x===-1?"":S.slice(x+1)}function A(S,x){return x.parseNumbers&&!Number.isNaN(Number(S))&&typeof S=="string"&&S.trim()!==""?S=Number(S):x.parseBooleans&&S!==null&&(S.toLowerCase()==="true"||S.toLowerCase()==="false")&&(S=S.toLowerCase()==="true"),S}function j(S,x){x=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},x),l(x.arrayFormatSeparator);const b=h(x),E=Object.create(null);if(typeof S!="string"||(S=S.trim().replace(/^[?#&]/,""),!S))return E;for(const p of S.split("&")){if(p==="")continue;let[o,d]=i(x.decode?p.replace(/\+/g," "):p,"=");d=d===void 0?null:["comma","separator","bracket-separator"].includes(x.arrayFormat)?d:y(d,x),b(y(o,x),d,E)}for(const p of Object.keys(E)){const o=E[p];if(typeof o=="object"&&o!==null)for(const d of Object.keys(o))o[d]=A(o[d],x);else E[p]=A(o,x)}return x.sort===!1?E:(x.sort===!0?Object.keys(E).sort():Object.keys(E).sort(x.sort)).reduce((p,o)=>{const d=E[o];return d&&typeof d=="object"&&!Array.isArray(d)?p[o]=g(d):p[o]=d,p},Object.create(null))}t.extract=P,t.parse=j,t.stringify=(S,x)=>{if(!S)return"";x=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},x),l(x.arrayFormatSeparator);const b=d=>x.skipNull&&s(S[d])||x.skipEmptyString&&S[d]==="",E=c(x),p={};for(const d of Object.keys(S))b(d)||(p[d]=S[d]);const o=Object.keys(p);return x.sort!==!1&&o.sort(x.sort),o.map(d=>{const C=S[d];return C===void 0?"":C===null?f(d,x):Array.isArray(C)?C.length===0&&x.arrayFormat==="bracket-separator"?f(d,x)+"[]":C.reduce(E(d),[]).join("&"):f(d,x)+"="+f(C,x)}).filter(d=>d.length>0).join("&")},t.parseUrl=(S,x)=>{x=Object.assign({decode:!0},x);const[b,E]=i(S,"#");return Object.assign({url:b.split("?")[0]||"",query:j(P(S),x)},x&&x.parseFragmentIdentifier&&E?{fragmentIdentifier:y(E,x)}:{})},t.stringifyUrl=(S,x)=>{x=Object.assign({encode:!0,strict:!0,[a]:!0},x);const b=w(S.url).split("?")[0]||"",E=t.extract(S.url),p=t.parse(E,{sort:!1}),o=Object.assign(p,S.query);let d=t.stringify(o,x);d&&(d=`?${d}`);let C=m(S.url);return S.fragmentIdentifier&&(C=`#${x[a]?f(S.fragmentIdentifier,x):S.fragmentIdentifier}`),`${b}${d}${C}`},t.pick=(S,x,b)=>{b=Object.assign({parseFragmentIdentifier:!0,[a]:!1},b);const{url:E,query:p,fragmentIdentifier:o}=t.parseUrl(S,b);return t.stringifyUrl({url:E,query:n(p,x),fragmentIdentifier:o},b)},t.exclude=(S,x,b)=>{const E=Array.isArray(x)?p=>!x.includes(p):(p,o)=>!x(p,o);return t.pick(S,E,b)}})(Rr);const Nd={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function No(t,e){return t.includes(":")?[t]:e.chains||[]}const Po="base10",ct="base16",yn="base64pad",_n="utf8",Ro=0,er=1,Pd=0,Ao=1,bn=12,wn=32;function Rd(){const t=hn.generateKeyPair();return{privateKey:at(t.secretKey,ct),publicKey:at(t.publicKey,ct)}}function mn(){const t=ur.randomBytes(wn);return at(t,ct)}function Ad(t,e){const r=hn.sharedKey(pt(t,ct),pt(e,ct),!0),i=new Qf(hi.SHA256,r).expand(wn);return at(i,ct)}function Cd(t){const e=hi.hash(pt(t,ct));return at(e,ct)}function hr(t){const e=hi.hash(pt(t,_n));return at(e,ct)}function Ld(t){return pt(`${t}`,Po)}function Ar(t){return Number(at(t,Po))}function Fd(t){const e=Ld(typeof t.type<"u"?t.type:Ro);if(Ar(e)===er&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?pt(t.senderPublicKey,ct):void 0,i=typeof t.iv<"u"?pt(t.iv,ct):ur.randomBytes(bn),n=new cn.ChaCha20Poly1305(pt(t.symKey,ct)).seal(i,pt(t.message,_n));return $d({type:e,sealed:n,iv:i,senderPublicKey:r})}function Ud(t){const e=new cn.ChaCha20Poly1305(pt(t.symKey,ct)),{sealed:r,iv:i}=fi(t.encoded),n=e.open(i,r);if(n===null)throw new Error("Failed to decrypt");return at(n,_n)}function $d(t){if(Ar(t.type)===er){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return at(nn([t.type,t.senderPublicKey,t.iv,t.sealed]),yn)}return at(nn([t.type,t.iv,t.sealed]),yn)}function fi(t){const e=pt(t,yn),r=e.slice(Pd,Ao),i=Ao;if(Ar(r)===er){const c=i+wn,h=c+bn,l=e.slice(i,c),f=e.slice(c,h),y=e.slice(h);return{type:r,sealed:y,iv:f,senderPublicKey:l}}const n=i+bn,s=e.slice(i,n),a=e.slice(n);return{type:r,sealed:a,iv:s}}function Md(t,e){const r=fi(t);return Co({type:Ar(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?at(r.senderPublicKey,ct):void 0,receiverPublicKey:e?.receiverPublicKey})}function Co(t){const e=t?.type||Ro;if(e===er){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Lo(t){return t.type===er&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var jd=Object.defineProperty,Fo=Object.getOwnPropertySymbols,qd=Object.prototype.hasOwnProperty,Bd=Object.prototype.propertyIsEnumerable,Uo=(t,e,r)=>e in t?jd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$o=(t,e)=>{for(var r in e||(e={}))qd.call(e,r)&&Uo(t,r,e[r]);if(Fo)for(var r of Fo(e))Bd.call(e,r)&&Uo(t,r,e[r]);return t};const zd="ReactNative",bt={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Kd="js";function vn(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function fr(){return!fn()&&!!dn()&&navigator.product===zd}function dr(){return!vn()&&!!dn()&&!!fn()}function Cr(){return fr()?bt.reactNative:vn()?bt.node:dr()?bt.browser:bt.unknown}function Hd(){var t;try{return fr()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function Vd(t,e){let r=Rr.parse(t);return r=$o($o({},r),e),t=Rr.stringify(r),t}function Gd(){return Do()||{name:"",description:"",url:"",icons:[""]}}function kd(){if(Cr()===bt.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:i}=global.Platform;return[r,i].join("-")}const t=ad();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function Wd(){var t;const e=Cr();return e===bt.browser?[e,((t=So())==null?void 0:t.host)||"unknown"].join(":"):e}function Yd(t,e,r){const i=kd(),n=Wd();return[[t,e].join("-"),[Kd,r].join("-"),i,n].join("/")}function Xd({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s,useOnCloseEvent:a,bundleId:c}){const h=r.split("?"),l=Yd(t,e,i),f={auth:n,ua:l,projectId:s,useOnCloseEvent:a||void 0,origin:c||void 0},y=Vd(h[1]||"",f);return h[0]+"?"+y}function tr(t,e){return t.filter(r=>e.includes(r)).length===t.length}function Mo(t){return Object.fromEntries(t.entries())}function jo(t){return new Map(Object.entries(t))}function pr(t=Q.FIVE_MINUTES,e){const r=Q.toMiliseconds(t||Q.FIVE_MINUTES);let i,n,s;return{resolve:a=>{s&&i&&(clearTimeout(s),i(a))},reject:a=>{s&&n&&(clearTimeout(s),n(a))},done:()=>new Promise((a,c)=>{s=setTimeout(()=>{c(new Error(e))},r),i=a,n=c})}}function Lr(t,e,r){return new Promise(async(i,n)=>{const s=setTimeout(()=>n(new Error(r)),e);try{const a=await t;i(a)}catch(a){n(a)}clearTimeout(s)})}function qo(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function Jd(t){return qo("topic",t)}function Qd(t){return qo("id",t)}function Bo(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function Dt(t,e){return Q.fromMiliseconds((e||Date.now())+Q.toMiliseconds(t))}function qt(t){return Date.now()>=Q.toMiliseconds(t)}function Ue(t,e){return`${t}${e?`:${e}`:""}`}async function Zd({id:t,topic:e,wcDeepLink:r}){try{if(!r)return;const i=typeof r=="string"?JSON.parse(r):r;let n=i?.href;if(typeof n!="string")return;n.endsWith("/")&&(n=n.slice(0,-1));const s=`${n}/wc?requestId=${t}&sessionTopic=${e}`,a=Cr();a===bt.browser?s.startsWith("https://")?window.open(s,"_blank","noreferrer noopener"):window.open(s,"_self","noreferrer noopener"):a===bt.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(s)}catch(i){console.error(i)}}async function ep(t,e){try{return await t.getItem(e)||(dr()?localStorage.getItem(e):void 0)}catch(r){console.error(r)}}const tp="irn";function En(t){return t?.relay||{protocol:tp}}function di(t){const e=Nd[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var rp=Object.defineProperty,zo=Object.getOwnPropertySymbols,ip=Object.prototype.hasOwnProperty,np=Object.prototype.propertyIsEnumerable,Ko=(t,e,r)=>e in t?rp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,sp=(t,e)=>{for(var r in e||(e={}))ip.call(e,r)&&Ko(t,r,e[r]);if(zo)for(var r of zo(e))np.call(e,r)&&Ko(t,r,e[r]);return t};function op(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),a=t[n];r[s]=a}}),r}function Ho(t){t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",a=Rr.parse(s);return{protocol:i,topic:ap(n[0]),version:parseInt(n[1],10),symKey:a.symKey,relay:op(a)}}function ap(t){return t.startsWith("//")?t.substring(2):t}function cp(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const s=r+e+n;t[n]&&(i[s]=t[n])}),i}function up(t){return`${t.protocol}:${t.topic}@${t.version}?`+Rr.stringify(sp({symKey:t.symKey},cp(t.relay)))}function gr(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function lp(t){const e=[];return Object.values(t).forEach(r=>{e.push(...gr(r.accounts))}),e}function hp(t,e){const r=[];return Object.values(t).forEach(i=>{gr(i.accounts).includes(e)&&r.push(...i.methods)}),r}function fp(t,e){const r=[];return Object.values(t).forEach(i=>{gr(i.accounts).includes(e)&&r.push(...i.events)}),r}function dp(t,e){const r=gi(t,e);if(r)throw new Error(r.message);const i={};for(const[n,s]of Object.entries(t))i[n]={methods:s.methods,events:s.events,chains:s.accounts.map(a=>`${a.split(":")[0]}:${a.split(":")[1]}`)};return i}const pp={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},gp={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function V(t,e){const{message:r,code:i}=gp[t];return{message:e?`${r} ${e}`:r,code:i}}function ze(t,e){const{message:r,code:i}=pp[t];return{message:e?`${r} ${e}`:r,code:i}}function Fr(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Ur(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function ut(t){return typeof t>"u"}function Ve(t,e){return e&&ut(t)?!0:typeof t=="string"&&!!t.trim().length}function Sn(t,e){return e&&ut(t)?!0:typeof t=="number"&&!isNaN(t)}function yp(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return tr(n,i)?(i.forEach(a=>{const{accounts:c,methods:h,events:l}=t.namespaces[a],f=gr(c),y=r[a];(!tr(No(a,y),f)||!tr(y.methods,h)||!tr(y.events,l))&&(s=!1)}),s):!1}function pi(t){return Ve(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function _p(t){if(Ve(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&pi(r)}}return!1}function bp(t){if(Ve(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function wp(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function mp(t){return t?.topic}function vp(t,e){let r=null;return Ve(t?.publicKey,!1)||(r=V("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Vo(t){let e=!0;return Fr(t)?t.length&&(e=t.every(r=>Ve(r,!1))):e=!1,e}function Ep(t,e,r){let i=null;return Fr(e)&&e.length?e.forEach(n=>{i||pi(n)||(i=ze("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):pi(t)||(i=ze("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}function Sp(t,e,r){let i=null;return Object.entries(t).forEach(([n,s])=>{if(i)return;const a=Ep(n,No(n,s),`${e} ${r}`);a&&(i=a)}),i}function Dp(t,e){let r=null;return Fr(t)?t.forEach(i=>{r||_p(i)||(r=ze("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=ze("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Ip(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=Dp(i?.accounts,`${e} namespace`);n&&(r=n)}),r}function Op(t,e){let r=null;return Vo(t?.methods)?Vo(t?.events)||(r=ze("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=ze("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Go(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=Op(i,`${e}, namespace`);n&&(r=n)}),r}function xp(t,e,r){let i=null;if(t&&Ur(t)){const n=Go(t,e);n&&(i=n);const s=Sp(t,e,r);s&&(i=s)}else i=V("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return i}function gi(t,e){let r=null;if(t&&Ur(t)){const i=Go(t,e);i&&(r=i);const n=Ip(t,e);n&&(r=n)}else r=V("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function ko(t){return Ve(t.protocol,!0)}function Tp(t,e){let r=!1;return e&&!t?r=!0:t&&Fr(t)&&t.length&&t.forEach(i=>{r=ko(i)}),r}function Np(t){return typeof t=="number"}function gt(t){return typeof t<"u"&&typeof t!==null}function Pp(t){return!(!t||typeof t!="object"||!t.code||!Sn(t.code,!1)||!t.message||!Ve(t.message,!1))}function Rp(t){return!(ut(t)||!Ve(t.method,!1))}function Ap(t){return!(ut(t)||ut(t.result)&&ut(t.error)||!Sn(t.id,!1)||!Ve(t.jsonrpc,!1))}function Cp(t){return!(ut(t)||!Ve(t.name,!1))}function Wo(t,e){return!(!pi(e)||!lp(t).includes(e))}function Lp(t,e,r){return Ve(r,!1)?hp(t,e).includes(r):!1}function Fp(t,e,r){return Ve(r,!1)?fp(t,e).includes(r):!1}function Yo(t,e,r){let i=null;const n=Up(t),s=$p(e),a=Object.keys(n),c=Object.keys(s),h=Xo(Object.keys(t)),l=Xo(Object.keys(e)),f=h.filter(y=>!l.includes(y));return f.length&&(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${f.toString()}
      Received: ${Object.keys(e).toString()}`)),tr(a,c)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${a.toString()}
      Approved: ${c.toString()}`)),Object.keys(e).forEach(y=>{if(!y.includes(":")||i)return;const g=gr(e[y].accounts);g.includes(y)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${y}
        Required: ${y}
        Approved: ${g.toString()}`))}),a.forEach(y=>{i||(tr(n[y].methods,s[y].methods)?tr(n[y].events,s[y].events)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${y}`)):i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${y}`))}),i}function Up(t){const e={};return Object.keys(t).forEach(r=>{var i;r.includes(":")?e[r]=t[r]:(i=t[r].chains)==null||i.forEach(n=>{e[n]={methods:t[r].methods,events:t[r].events}})}),e}function Xo(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function $p(t){const e={};return Object.keys(t).forEach(r=>{if(r.includes(":"))e[r]=t[r];else{const i=gr(t[r].accounts);i?.forEach(n=>{e[n]={accounts:t[r].accounts.filter(s=>s.includes(`${n}:`)),methods:t[r].methods,events:t[r].events}})}}),e}function Mp(t,e){return Sn(t,!1)&&t<=e.max&&t>=e.min}function Jo(){const t=Cr();return new Promise(e=>{switch(t){case bt.browser:e(jp());break;case bt.reactNative:e(qp());break;case bt.node:e(Bp());break;default:e(!0)}})}function jp(){return dr()&&navigator?.onLine}async function qp(){if(fr()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t?.isConnected}return!0}function Bp(){return!0}function zp(t){switch(Cr()){case bt.browser:Kp(t);break;case bt.reactNative:Hp(t);break}}function Kp(t){!fr()&&dr()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function Hp(t){fr()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>t(e?.isConnected))}const Dn={};class yi{static get(e){return Dn[e]}static set(e,r){Dn[e]=r}static delete(e){delete Dn[e]}}const Vp="PARSE_ERROR",Gp="INVALID_REQUEST",kp="METHOD_NOT_FOUND",Wp="INVALID_PARAMS",Qo="INTERNAL_ERROR",In="SERVER_ERROR",Yp=[-32700,-32600,-32601,-32602,-32603],$r={[Vp]:{code:-32700,message:"Parse error"},[Gp]:{code:-32600,message:"Invalid Request"},[kp]:{code:-32601,message:"Method not found"},[Wp]:{code:-32602,message:"Invalid params"},[Qo]:{code:-32603,message:"Internal error"},[In]:{code:-32e3,message:"Server error"}},Zo=In;function Xp(t){return Yp.includes(t)}function ea(t){return Object.keys($r).includes(t)?$r[t]:$r[Zo]}function Jp(t){const e=Object.values($r).find(r=>r.code===t);return e||$r[Zo]}function Qp(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var ta={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var On=function(t,e){return On=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},On(t,e)};function Zp(t,e){On(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var xn=function(){return xn=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},xn.apply(this,arguments)};function eg(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function tg(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function rg(t,e){return function(r,i){e(r,i,t)}}function ig(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function ng(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(f){try{l(i.next(f))}catch(y){a(y)}}function h(f){try{l(i.throw(f))}catch(y){a(y)}}function l(f){f.done?s(f.value):n(f.value).then(c,h)}l((i=i.apply(t,e||[])).next())})}function sg(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(f){return h([l,f])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function og(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function ag(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Tn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ra(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function cg(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ra(arguments[e]));return t}function ug(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Mr(t){return this instanceof Mr?(this.v=t,this):new Mr(t)}function lg(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(g){i[g]&&(n[g]=function(w){return new Promise(function(m,P){s.push([g,w,m,P])>1||c(g,w)})})}function c(g,w){try{h(i[g](w))}catch(m){y(s[0][3],m)}}function h(g){g.value instanceof Mr?Promise.resolve(g.value.v).then(l,f):y(s[0][2],g)}function l(g){c("next",g)}function f(g){c("throw",g)}function y(g,w){g(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function hg(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Mr(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function fg(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Tn=="function"?Tn(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),n(c,h,a.done,a.value)})}}function n(s,a,c,h){Promise.resolve(h).then(function(l){s({value:l,done:c})},a)}}function dg(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function pg(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function gg(t){return t&&t.__esModule?t:{default:t}}function yg(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function _g(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var bg=Object.freeze({__proto__:null,__extends:Zp,get __assign(){return xn},__rest:eg,__decorate:tg,__param:rg,__metadata:ig,__awaiter:ng,__generator:sg,__createBinding:og,__exportStar:ag,__values:Tn,__read:ra,__spread:cg,__spreadArrays:ug,__await:Mr,__asyncGenerator:lg,__asyncDelegator:hg,__asyncValues:fg,__makeTemplateObject:dg,__importStar:pg,__importDefault:gg,__classPrivateFieldGet:yg,__classPrivateFieldSet:_g}),wg=Gt(bg),Ct={},ia;function mg(){if(ia)return Ct;ia=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.isBrowserCryptoAvailable=Ct.getSubtleCrypto=Ct.getBrowerCrypto=void 0;function t(){return ht?.crypto||ht?.msCrypto||{}}Ct.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}Ct.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Ct.isBrowserCryptoAvailable=r,Ct}var Lt={},na;function vg(){if(na)return Lt;na=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.isBrowser=Lt.isNode=Lt.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Lt.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Lt.isNode=e;function r(){return!t()&&!e()}return Lt.isBrowser=r,Lt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=wg;e.__exportStar(mg(),t),e.__exportStar(vg(),t)})(ta);function Nn(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function sa(t=6){return BigInt(Nn(t))}function yr(t,e,r){return{id:r||Nn(),jsonrpc:"2.0",method:t,params:e}}function Pn(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Rn(t,e,r){return{id:t,jsonrpc:"2.0",error:Eg(e,r)}}function Eg(t,e){return typeof t>"u"?ea(Qo):(typeof t=="string"&&(t=Object.assign(Object.assign({},ea(In)),{message:t})),typeof e<"u"&&(t.data=e),Xp(t.code)&&(t=Jp(t.code)),t)}class Sg{}class Dg extends Sg{constructor(){super()}}class Ig extends Dg{constructor(e){super()}}const Og="^wss?:";function xg(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Tg(t,e){const r=xg(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function oa(t){return Tg(t,Og)}function Ng(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function aa(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function An(t){return aa(t)&&"method"in t}function _i(t){return aa(t)&&(Ft(t)||It(t))}function Ft(t){return"result"in t}function It(t){return"error"in t}class Pg extends Ig{constructor(e){super(e),this.events=new ft.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(yr(e.method,e.params||[],e.id||sa().toString()),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{It(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),_i(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Rg=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Ag=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",ca=t=>t.split("?")[0],ua=10,Cg=Rg();class Lg{constructor(e){if(this.url=e,this.events=new ft.exports.EventEmitter,this.registering=!1,!oa(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(vr(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!oa(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=new URLSearchParams(e).get("origin"),s=ta.isReactNative()?{headers:{origin:n}}:{rejectUnauthorized:!Ng(e)},a=new Cg(e,[],s);Ag()?a.onerror=c=>{const h=c;i(this.emitError(h.error))}:a.on("error",c=>{i(this.emitError(c))}),a.onopen=()=>{this.onOpen(a),r(a)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Zr(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=Rn(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return Qp(e,ca(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>ua&&this.events.setMaxListeners(ua)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${ca(this.url)}`));return this.events.emit("register_error",r),r}}var Cn={exports:{}};(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,s=2,a=9007199254740991,c="[object Arguments]",h="[object Array]",l="[object AsyncFunction]",f="[object Boolean]",y="[object Date]",g="[object Error]",w="[object Function]",m="[object GeneratorFunction]",P="[object Map]",A="[object Number]",j="[object Null]",S="[object Object]",x="[object Promise]",b="[object Proxy]",E="[object RegExp]",p="[object Set]",o="[object String]",d="[object Symbol]",C="[object Undefined]",L="[object WeakMap]",K="[object ArrayBuffer]",G="[object DataView]",J="[object Float32Array]",O="[object Float64Array]",R="[object Int8Array]",k="[object Int16Array]",q="[object Int32Array]",U="[object Uint8Array]",M="[object Uint8ClampedArray]",F="[object Uint16Array]",B="[object Uint32Array]",te=/[\\^$.*+?()[\]{}|]/g,z=/^\[object .+?Constructor\]$/,Z=/^(?:0|[1-9]\d*)$/,Y={};Y[J]=Y[O]=Y[R]=Y[k]=Y[q]=Y[U]=Y[M]=Y[F]=Y[B]=!0,Y[c]=Y[h]=Y[K]=Y[f]=Y[G]=Y[y]=Y[g]=Y[w]=Y[P]=Y[A]=Y[S]=Y[E]=Y[p]=Y[o]=Y[L]=!1;var ee=typeof ht=="object"&&ht&&ht.Object===Object&&ht,N=typeof self=="object"&&self&&self.Object===Object&&self,T=ee||N||Function("return this")(),D=e&&!e.nodeType&&e,u=D&&!0&&t&&!t.nodeType&&t,v=u&&u.exports===D,H=v&&ee.process,W=function(){try{return H&&H.binding&&H.binding("util")}catch{}}(),he=W&&W.isTypedArray;function be(_,I){for(var $=-1,X=_==null?0:_.length,Te=0,se=[];++$<X;){var Le=_[$];I(Le,$,_)&&(se[Te++]=Le)}return se}function de(_,I){for(var $=-1,X=I.length,Te=_.length;++$<X;)_[Te+$]=I[$];return _}function ve(_,I){for(var $=-1,X=_==null?0:_.length;++$<X;)if(I(_[$],$,_))return!0;return!1}function Fe(_,I){for(var $=-1,X=Array(_);++$<_;)X[$]=I($);return X}function Re(_){return function(I){return _(I)}}function _e(_,I){return _.has(I)}function pe(_,I){return _?.[I]}function fe(_){var I=-1,$=Array(_.size);return _.forEach(function(X,Te){$[++I]=[Te,X]}),$}function ue(_,I){return function($){return _(I($))}}function ce(_){var I=-1,$=Array(_.size);return _.forEach(function(X){$[++I]=X}),$}var ae=Array.prototype,oe=Function.prototype,re=Object.prototype,le=T["__core-js_shared__"],ge=oe.toString,ne=re.hasOwnProperty,we=function(){var _=/[^.]+$/.exec(le&&le.keys&&le.keys.IE_PROTO||"");return _?"Symbol(src)_1."+_:""}(),me=re.toString,De=RegExp("^"+ge.call(ne).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ie=v?T.Buffer:void 0,Ee=T.Symbol,xt=T.Uint8Array,At=re.propertyIsEnumerable,zt=ae.splice,wt=Ee?Ee.toStringTag:void 0,rr=Object.getOwnPropertySymbols,Vr=Ie?Ie.isBuffer:void 0,Di=ue(Object.keys,Object),$e=wr(T,"DataView"),Ae=wr(T,"Map"),Me=wr(T,"Promise"),je=wr(T,"Set"),qe=wr(T,"WeakMap"),Ce=wr(Object,"create"),Ge=nr($e),ke=nr(Ae),We=nr(Me),Ye=nr(je),Xe=nr(qe),Ke=Ee?Ee.prototype:void 0,Be=Ke?Ke.valueOf:void 0;function Ne(_){var I=-1,$=_==null?0:_.length;for(this.clear();++I<$;){var X=_[I];this.set(X[0],X[1])}}function Je(){this.__data__=Ce?Ce(null):{},this.size=0}function Qe(_){var I=this.has(_)&&delete this.__data__[_];return this.size-=I?1:0,I}function R_(_){var I=this.__data__;if(Ce){var $=I[_];return $===i?void 0:$}return ne.call(I,_)?I[_]:void 0}function A_(_){var I=this.__data__;return Ce?I[_]!==void 0:ne.call(I,_)}function C_(_,I){var $=this.__data__;return this.size+=this.has(_)?0:1,$[_]=Ce&&I===void 0?i:I,this}Ne.prototype.clear=Je,Ne.prototype.delete=Qe,Ne.prototype.get=R_,Ne.prototype.has=A_,Ne.prototype.set=C_;function $t(_){var I=-1,$=_==null?0:_.length;for(this.clear();++I<$;){var X=_[I];this.set(X[0],X[1])}}function L_(){this.__data__=[],this.size=0}function F_(_){var I=this.__data__,$=Oi(I,_);if($<0)return!1;var X=I.length-1;return $==X?I.pop():zt.call(I,$,1),--this.size,!0}function U_(_){var I=this.__data__,$=Oi(I,_);return $<0?void 0:I[$][1]}function $_(_){return Oi(this.__data__,_)>-1}function M_(_,I){var $=this.__data__,X=Oi($,_);return X<0?(++this.size,$.push([_,I])):$[X][1]=I,this}$t.prototype.clear=L_,$t.prototype.delete=F_,$t.prototype.get=U_,$t.prototype.has=$_,$t.prototype.set=M_;function ir(_){var I=-1,$=_==null?0:_.length;for(this.clear();++I<$;){var X=_[I];this.set(X[0],X[1])}}function j_(){this.size=0,this.__data__={hash:new Ne,map:new(Ae||$t),string:new Ne}}function q_(_){var I=xi(this,_).delete(_);return this.size-=I?1:0,I}function B_(_){return xi(this,_).get(_)}function z_(_){return xi(this,_).has(_)}function K_(_,I){var $=xi(this,_),X=$.size;return $.set(_,I),this.size+=$.size==X?0:1,this}ir.prototype.clear=j_,ir.prototype.delete=q_,ir.prototype.get=B_,ir.prototype.has=z_,ir.prototype.set=K_;function Ii(_){var I=-1,$=_==null?0:_.length;for(this.__data__=new ir;++I<$;)this.add(_[I])}function H_(_){return this.__data__.set(_,i),this}function V_(_){return this.__data__.has(_)}Ii.prototype.add=Ii.prototype.push=H_,Ii.prototype.has=V_;function Kt(_){var I=this.__data__=new $t(_);this.size=I.size}function G_(){this.__data__=new $t,this.size=0}function k_(_){var I=this.__data__,$=I.delete(_);return this.size=I.size,$}function W_(_){return this.__data__.get(_)}function Y_(_){return this.__data__.has(_)}function X_(_,I){var $=this.__data__;if($ instanceof $t){var X=$.__data__;if(!Ae||X.length<r-1)return X.push([_,I]),this.size=++$.size,this;$=this.__data__=new ir(X)}return $.set(_,I),this.size=$.size,this}Kt.prototype.clear=G_,Kt.prototype.delete=k_,Kt.prototype.get=W_,Kt.prototype.has=Y_,Kt.prototype.set=X_;function J_(_,I){var $=Ti(_),X=!$&&f1(_),Te=!$&&!X&&Gn(_),se=!$&&!X&&!Te&&cc(_),Le=$||X||Te||se,Ze=Le?Fe(_.length,String):[],rt=Ze.length;for(var Pe in _)(I||ne.call(_,Pe))&&!(Le&&(Pe=="length"||Te&&(Pe=="offset"||Pe=="parent")||se&&(Pe=="buffer"||Pe=="byteLength"||Pe=="byteOffset")||a1(Pe,rt)))&&Ze.push(Pe);return Ze}function Oi(_,I){for(var $=_.length;$--;)if(nc(_[$][0],I))return $;return-1}function Q_(_,I,$){var X=I(_);return Ti(_)?X:de(X,$(_))}function Gr(_){return _==null?_===void 0?C:j:wt&&wt in Object(_)?s1(_):h1(_)}function ec(_){return kr(_)&&Gr(_)==c}function tc(_,I,$,X,Te){return _===I?!0:_==null||I==null||!kr(_)&&!kr(I)?_!==_&&I!==I:Z_(_,I,$,X,tc,Te)}function Z_(_,I,$,X,Te,se){var Le=Ti(_),Ze=Ti(I),rt=Le?h:Ht(_),Pe=Ze?h:Ht(I);rt=rt==c?S:rt,Pe=Pe==c?S:Pe;var mt=rt==S,Tt=Pe==S,st=rt==Pe;if(st&&Gn(_)){if(!Gn(I))return!1;Le=!0,mt=!1}if(st&&!mt)return se||(se=new Kt),Le||cc(_)?rc(_,I,$,X,Te,se):i1(_,I,rt,$,X,Te,se);if(!($&n)){var Et=mt&&ne.call(_,"__wrapped__"),St=Tt&&ne.call(I,"__wrapped__");if(Et||St){var Vt=Et?_.value():_,Mt=St?I.value():I;return se||(se=new Kt),Te(Vt,Mt,$,X,se)}}return st?(se||(se=new Kt),n1(_,I,$,X,Te,se)):!1}function e1(_){if(!ac(_)||u1(_))return!1;var I=sc(_)?De:z;return I.test(nr(_))}function t1(_){return kr(_)&&oc(_.length)&&!!Y[Gr(_)]}function r1(_){if(!l1(_))return Di(_);var I=[];for(var $ in Object(_))ne.call(_,$)&&$!="constructor"&&I.push($);return I}function rc(_,I,$,X,Te,se){var Le=$&n,Ze=_.length,rt=I.length;if(Ze!=rt&&!(Le&&rt>Ze))return!1;var Pe=se.get(_);if(Pe&&se.get(I))return Pe==I;var mt=-1,Tt=!0,st=$&s?new Ii:void 0;for(se.set(_,I),se.set(I,_);++mt<Ze;){var Et=_[mt],St=I[mt];if(X)var Vt=Le?X(St,Et,mt,I,_,se):X(Et,St,mt,_,I,se);if(Vt!==void 0){if(Vt)continue;Tt=!1;break}if(st){if(!ve(I,function(Mt,sr){if(!_e(st,sr)&&(Et===Mt||Te(Et,Mt,$,X,se)))return st.push(sr)})){Tt=!1;break}}else if(!(Et===St||Te(Et,St,$,X,se))){Tt=!1;break}}return se.delete(_),se.delete(I),Tt}function i1(_,I,$,X,Te,se,Le){switch($){case G:if(_.byteLength!=I.byteLength||_.byteOffset!=I.byteOffset)return!1;_=_.buffer,I=I.buffer;case K:return!(_.byteLength!=I.byteLength||!se(new xt(_),new xt(I)));case f:case y:case A:return nc(+_,+I);case g:return _.name==I.name&&_.message==I.message;case E:case o:return _==I+"";case P:var Ze=fe;case p:var rt=X&n;if(Ze||(Ze=ce),_.size!=I.size&&!rt)return!1;var Pe=Le.get(_);if(Pe)return Pe==I;X|=s,Le.set(_,I);var mt=rc(Ze(_),Ze(I),X,Te,se,Le);return Le.delete(_),mt;case d:if(Be)return Be.call(_)==Be.call(I)}return!1}function n1(_,I,$,X,Te,se){var Le=$&n,Ze=ic(_),rt=Ze.length,Pe=ic(I),mt=Pe.length;if(rt!=mt&&!Le)return!1;for(var Tt=rt;Tt--;){var st=Ze[Tt];if(!(Le?st in I:ne.call(I,st)))return!1}var Et=se.get(_);if(Et&&se.get(I))return Et==I;var St=!0;se.set(_,I),se.set(I,_);for(var Vt=Le;++Tt<rt;){st=Ze[Tt];var Mt=_[st],sr=I[st];if(X)var uc=Le?X(sr,Mt,st,I,_,se):X(Mt,sr,st,_,I,se);if(!(uc===void 0?Mt===sr||Te(Mt,sr,$,X,se):uc)){St=!1;break}Vt||(Vt=st=="constructor")}if(St&&!Vt){var Ni=_.constructor,Pi=I.constructor;Ni!=Pi&&"constructor"in _&&"constructor"in I&&!(typeof Ni=="function"&&Ni instanceof Ni&&typeof Pi=="function"&&Pi instanceof Pi)&&(St=!1)}return se.delete(_),se.delete(I),St}function ic(_){return Q_(_,g1,o1)}function xi(_,I){var $=_.__data__;return c1(I)?$[typeof I=="string"?"string":"hash"]:$.map}function wr(_,I){var $=pe(_,I);return e1($)?$:void 0}function s1(_){var I=ne.call(_,wt),$=_[wt];try{_[wt]=void 0;var X=!0}catch{}var Te=me.call(_);return X&&(I?_[wt]=$:delete _[wt]),Te}var o1=rr?function(_){return _==null?[]:(_=Object(_),be(rr(_),function(I){return At.call(_,I)}))}:y1,Ht=Gr;($e&&Ht(new $e(new ArrayBuffer(1)))!=G||Ae&&Ht(new Ae)!=P||Me&&Ht(Me.resolve())!=x||je&&Ht(new je)!=p||qe&&Ht(new qe)!=L)&&(Ht=function(_){var I=Gr(_),$=I==S?_.constructor:void 0,X=$?nr($):"";if(X)switch(X){case Ge:return G;case ke:return P;case We:return x;case Ye:return p;case Xe:return L}return I});function a1(_,I){return I=I??a,!!I&&(typeof _=="number"||Z.test(_))&&_>-1&&_%1==0&&_<I}function c1(_){var I=typeof _;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?_!=="__proto__":_===null}function u1(_){return!!we&&we in _}function l1(_){var I=_&&_.constructor,$=typeof I=="function"&&I.prototype||re;return _===$}function h1(_){return me.call(_)}function nr(_){if(_!=null){try{return ge.call(_)}catch{}try{return _+""}catch{}}return""}function nc(_,I){return _===I||_!==_&&I!==I}var f1=ec(function(){return arguments}())?ec:function(_){return kr(_)&&ne.call(_,"callee")&&!At.call(_,"callee")},Ti=Array.isArray;function d1(_){return _!=null&&oc(_.length)&&!sc(_)}var Gn=Vr||_1;function p1(_,I){return tc(_,I)}function sc(_){if(!ac(_))return!1;var I=Gr(_);return I==w||I==m||I==l||I==b}function oc(_){return typeof _=="number"&&_>-1&&_%1==0&&_<=a}function ac(_){var I=typeof _;return _!=null&&(I=="object"||I=="function")}function kr(_){return _!=null&&typeof _=="object"}var cc=he?Re(he):t1;function g1(_){return d1(_)?J_(_):r1(_)}function y1(){return[]}function _1(){return!1}t.exports=p1})(Cn,Cn.exports);var Fg=Cn.exports;function Ug(t,e){return e=e||{},new Promise(function(r,i){var n=new XMLHttpRequest,s=[],a=[],c={},h=function(){return{ok:(n.status/100|0)==2,statusText:n.statusText,status:n.status,url:n.responseURL,text:function(){return Promise.resolve(n.responseText)},json:function(){return Promise.resolve(n.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([n.response]))},clone:h,headers:{keys:function(){return s},entries:function(){return a},get:function(f){return c[f.toLowerCase()]},has:function(f){return f.toLowerCase()in c}}}};for(var l in n.open(e.method||"get",t,!0),n.onload=function(){n.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(f,y,g){s.push(y=y.toLowerCase()),a.push([y,g]),c[y]=c[y]?c[y]+","+g:g}),r(h())},n.onerror=i,n.withCredentials=e.credentials=="include",e.headers)n.setRequestHeader(l,e.headers[l]);n.send(e.body||null)})}var $g=Object.freeze({__proto__:null,default:Ug}),la=Gt($g),Mg=self.fetch||(self.fetch=la.default||la),jg=Object.defineProperty,ha=Object.getOwnPropertySymbols,qg=Object.prototype.hasOwnProperty,Bg=Object.prototype.propertyIsEnumerable,fa=(t,e,r)=>e in t?jg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,lt=(t,e)=>{for(var r in e||(e={}))qg.call(e,r)&&fa(t,r,e[r]);if(ha)for(var r of ha(e))Bg.call(e,r)&&fa(t,r,e[r]);return t};function zg(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=n}var c=t.length,h=t.charAt(0),l=Math.log(c)/Math.log(256),f=Math.log(256)/Math.log(c);function y(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var P=0,A=0,j=0,S=m.length;j!==S&&m[j]===0;)j++,P++;for(var x=(S-j)*f+1>>>0,b=new Uint8Array(x);j!==S;){for(var E=m[j],p=0,o=x-1;(E!==0||p<A)&&o!==-1;o--,p++)E+=256*b[o]>>>0,b[o]=E%c>>>0,E=E/c>>>0;if(E!==0)throw new Error("Non-zero carry");A=p,j++}for(var d=x-A;d!==x&&b[d]===0;)d++;for(var C=h.repeat(P);d<x;++d)C+=t.charAt(b[d]);return C}function g(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var P=0;if(m[P]!==" "){for(var A=0,j=0;m[P]===h;)A++,P++;for(var S=(m.length-P)*l+1>>>0,x=new Uint8Array(S);m[P];){var b=r[m.charCodeAt(P)];if(b===255)return;for(var E=0,p=S-1;(b!==0||E<j)&&p!==-1;p--,E++)b+=c*x[p]>>>0,x[p]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");j=E,P++}if(m[P]!==" "){for(var o=S-j;o!==S&&x[o]===0;)o++;for(var d=new Uint8Array(A+(S-o)),C=A;o!==S;)d[C++]=x[o++];return d}}}function w(m){var P=g(m);if(P)return P;throw new Error(`Non-${e} character`)}return{encode:y,decodeUnsafe:g,decode:w}}var Kg=zg,Hg=Kg;const da=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Vg=t=>new TextEncoder().encode(t),Gg=t=>new TextDecoder().decode(t);class kg{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Wg{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return pa(this,e)}}class Yg{constructor(e){this.decoders=e}or(e){return pa(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const pa=(t,e)=>new Yg(lt(lt({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class Xg{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new kg(e,r,i),this.decoder=new Wg(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const bi=({name:t,prefix:e,encode:r,decode:i})=>new Xg(t,e,r,i),jr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=Hg(r,e);return bi({prefix:t,name:e,encode:i,decode:s=>da(n(s))})},Jg=(t,e,r,i)=>{const n={};for(let f=0;f<e.length;++f)n[e[f]]=f;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let c=0,h=0,l=0;for(let f=0;f<s;++f){const y=n[t[f]];if(y===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|y,c+=r,c>=8&&(c-=8,a[l++]=255&h>>c)}if(c>=r||255&h<<8-c)throw new SyntaxError("Unexpected end of data");return a},Qg=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",a=0,c=0;for(let h=0;h<t.length;++h)for(c=c<<8|t[h],a+=8;a>r;)a-=r,s+=e[n&c>>a];if(a&&(s+=e[n&c<<r-a]),i)for(;s.length*r&7;)s+="=";return s},tt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>bi({prefix:e,name:t,encode(n){return Qg(n,i,r)},decode(n){return Jg(n,i,r,t)}}),Zg=bi({prefix:"\0",name:"identity",encode:t=>Gg(t),decode:t=>Vg(t)});var ey=Object.freeze({__proto__:null,identity:Zg});const ty=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ry=Object.freeze({__proto__:null,base2:ty});const iy=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ny=Object.freeze({__proto__:null,base8:iy});const sy=jr({prefix:"9",name:"base10",alphabet:"0123456789"});var oy=Object.freeze({__proto__:null,base10:sy});const ay=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),cy=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var uy=Object.freeze({__proto__:null,base16:ay,base16upper:cy});const ly=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),hy=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),fy=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),dy=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),py=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),gy=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),yy=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),_y=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),by=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var wy=Object.freeze({__proto__:null,base32:ly,base32upper:hy,base32pad:fy,base32padupper:dy,base32hex:py,base32hexupper:gy,base32hexpad:yy,base32hexpadupper:_y,base32z:by});const my=jr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),vy=jr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ey=Object.freeze({__proto__:null,base36:my,base36upper:vy});const Sy=jr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Dy=jr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Iy=Object.freeze({__proto__:null,base58btc:Sy,base58flickr:Dy});const Oy=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),xy=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ty=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ny=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Py=Object.freeze({__proto__:null,base64:Oy,base64pad:xy,base64url:Ty,base64urlpad:Ny});const ga=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Ry=ga.reduce((t,e,r)=>(t[r]=e,t),[]),Ay=ga.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Cy(t){return t.reduce((e,r)=>(e+=Ry[r],e),"")}function Ly(t){const e=[];for(const r of t){const i=Ay[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const Fy=bi({prefix:"\u{1F680}",name:"base256emoji",encode:Cy,decode:Ly});var Uy=Object.freeze({__proto__:null,base256emoji:Fy}),$y=_a,ya=128,My=127,jy=~My,qy=Math.pow(2,31);function _a(t,e,r){e=e||[],r=r||0;for(var i=r;t>=qy;)e[r++]=t&255|ya,t/=128;for(;t&jy;)e[r++]=t&255|ya,t>>>=7;return e[r]=t|0,_a.bytes=r-i+1,e}var By=Ln,zy=128,ba=127;function Ln(t,i){var r=0,i=i||0,n=0,s=i,a,c=t.length;do{if(s>=c)throw Ln.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=n<28?(a&ba)<<n:(a&ba)*Math.pow(2,n),n+=7}while(a>=zy);return Ln.bytes=s-i,r}var Ky=Math.pow(2,7),Hy=Math.pow(2,14),Vy=Math.pow(2,21),Gy=Math.pow(2,28),ky=Math.pow(2,35),Wy=Math.pow(2,42),Yy=Math.pow(2,49),Xy=Math.pow(2,56),Jy=Math.pow(2,63),Qy=function(t){return t<Ky?1:t<Hy?2:t<Vy?3:t<Gy?4:t<ky?5:t<Wy?6:t<Yy?7:t<Xy?8:t<Jy?9:10},Zy={encode:$y,decode:By,encodingLength:Qy},wa=Zy;const ma=(t,e,r=0)=>(wa.encode(t,e,r),e),va=t=>wa.encodingLength(t),Fn=(t,e)=>{const r=e.byteLength,i=va(t),n=i+va(r),s=new Uint8Array(n+r);return ma(t,s,0),ma(r,s,i),s.set(e,n),new e0(t,r,e,s)};class e0{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const Ea=({name:t,code:e,encode:r})=>new t0(t,e,r);class t0{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Fn(this.code,r):r.then(i=>Fn(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Sa=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),r0=Ea({name:"sha2-256",code:18,encode:Sa("SHA-256")}),i0=Ea({name:"sha2-512",code:19,encode:Sa("SHA-512")});var n0=Object.freeze({__proto__:null,sha256:r0,sha512:i0});const Da=0,s0="identity",Ia=da;var o0=Object.freeze({__proto__:null,identity:{code:Da,name:s0,encode:Ia,digest:t=>Fn(Da,Ia(t))}});new TextEncoder,new TextDecoder;const Oa=lt(lt(lt(lt(lt(lt(lt(lt(lt(lt({},ey),ry),ny),oy),uy),wy),Ey),Iy),Py),Uy);lt(lt({},n0),o0);function xa(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function a0(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?xa(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Ta(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Na=Ta("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Un=Ta("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=a0(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),c0=lt({utf8:Na,"utf-8":Na,hex:Oa.base16,latin1:Un,ascii:Un,binary:Un},Oa);function u0(t,e="utf8"){const r=c0[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?xa(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}const Pa="wc",l0=2,$n="core",Bt=`${Pa}@2:${$n}:`,h0={name:$n,logger:"error"},f0={database:":memory:"},d0="crypto",Ra="client_ed25519_seed",p0=Q.ONE_DAY,g0="keychain",y0="0.3",_0="messages",b0="0.3",w0=Q.SIX_HOURS,m0="publisher",Aa="irn",v0="error",Ca="wss://relay.walletconnect.com",La="wss://relay.walletconnect.org",E0="relayer",nt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},S0="_subscription",Ut={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},D0=Q.ONE_SECOND,I0="2.11.0",O0=1e4,x0="0.3",T0="WALLETCONNECT_CLIENT_ID",Ot={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},N0="subscription",P0="0.3",R0=Q.FIVE_SECONDS*1e3,A0="pairing",C0="0.3",qr={wc_pairingDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:0},res:{ttl:Q.ONE_DAY,prompt:!1,tag:0}}},Br={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Pt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},L0="history",F0="0.3",U0="expirer",vt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},$0="0.3",Mn="verify-api",_r="https://verify.walletconnect.com",jn="https://verify.walletconnect.org",M0=[_r,jn],j0="echo",q0="https://echo.walletconnect.com";class B0{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=g0,this.version=y0,this.initialized=!1,this.storagePrefix=Bt,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=ye.generateChildLogger(r,this.name)}get context(){return ye.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Mo(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?jo(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class z0{constructor(e,r,i){this.core=e,this.logger=r,this.name=d0,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),s=lo(n);return uo(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=Rd();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const s=await this.getClientSeed(),a=lo(s),c=mn();return await jf(c,n,p0,a)},this.generateSharedKey=(n,s,a)=>{this.isInitialized();const c=this.getPrivateKey(n),h=Ad(c,s);return this.setSymKey(h,a)},this.setSymKey=async(n,s)=>{this.isInitialized();const a=s||Cd(n);return await this.keychain.set(a,n),a},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,s,a)=>{this.isInitialized();const c=Co(a),h=vr(s);if(Lo(c)){const g=c.senderPublicKey,w=c.receiverPublicKey;n=await this.generateSharedKey(g,w)}const l=this.getSymKey(n),{type:f,senderPublicKey:y}=c;return Fd({type:f,symKey:l,message:h,senderPublicKey:y})},this.decode=async(n,s,a)=>{this.isInitialized();const c=Md(s,a);if(Lo(c)){const h=c.receiverPublicKey,l=c.senderPublicKey;n=await this.generateSharedKey(h,l)}try{const h=this.getSymKey(n),l=Ud({symKey:h,encoded:s});return Zr(l)}catch(h){this.logger.error(`Failed to decode message from topic: '${n}', clientId: '${await this.getClientId()}'`),this.logger.error(h)}},this.getPayloadType=n=>{const s=fi(n);return Ar(s.type)},this.getPayloadSenderPublicKey=n=>{const s=fi(n);return s.senderPublicKey?at(s.senderPublicKey,ct):void 0},this.core=e,this.logger=ye.generateChildLogger(r,this.name),this.keychain=i||new B0(this.core,this.logger)}get context(){return ye.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Ra)}catch{e=mn(),await this.keychain.set(Ra,e)}return u0(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class K0 extends wl{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=_0,this.version=b0,this.initialized=!1,this.storagePrefix=Bt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const s=hr(n);let a=this.messages.get(i);return typeof a>"u"&&(a={}),typeof a[s]<"u"||(a[s]=n,this.messages.set(i,a),await this.persist()),s},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const s=this.get(i),a=hr(n);return typeof s[a]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=ye.generateChildLogger(e,this.name),this.core=r}get context(){return ye.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Mo(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?jo(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class H0 extends ml{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new ft.exports.EventEmitter,this.name=m0,this.queue=new Map,this.publishTimeout=Q.toMiliseconds(Q.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(i,n,s)=>{var a;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});try{const c=s?.ttl||w0,h=En(s),l=s?.prompt||!1,f=s?.tag||0,y=s?.id||sa().toString(),g={topic:i,message:n,opts:{ttl:c,relay:h,prompt:l,tag:f,id:y}},w=setTimeout(()=>this.queue.set(y,g),this.publishTimeout);try{await await Lr(this.rpcPublish(i,n,c,h,l,f,y),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(y),this.relayer.events.emit(nt.publish,g)}catch(m){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(a=s?.internal)!=null&&a.throwOnFailedPublish)throw this.removeRequestFromQueue(y),m;return}finally{clearTimeout(w)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}})}catch(c){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(c),c}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=ye.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return ye.getLoggerContext(this.logger)}rpcPublish(e,r,i,n,s,a,c){var h,l,f,y;const g={method:di(n.protocol).publish,params:{topic:e,message:r,ttl:i,prompt:s,tag:a},id:c};return ut((h=g.params)==null?void 0:h.prompt)&&((l=g.params)==null||delete l.prompt),ut((f=g.params)==null?void 0:f.tag)&&((y=g.params)==null||delete y.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:g}),this.relayer.request(g)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:i,opts:n}=e;await this.publish(r,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(ar.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(nt.connection_stalled);return}this.checkQueue()}),this.relayer.on(nt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class V0{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(s=>s!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var G0=Object.defineProperty,k0=Object.defineProperties,W0=Object.getOwnPropertyDescriptors,Fa=Object.getOwnPropertySymbols,Y0=Object.prototype.hasOwnProperty,X0=Object.prototype.propertyIsEnumerable,Ua=(t,e,r)=>e in t?G0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,zr=(t,e)=>{for(var r in e||(e={}))Y0.call(e,r)&&Ua(t,r,e[r]);if(Fa)for(var r of Fa(e))X0.call(e,r)&&Ua(t,r,e[r]);return t},qn=(t,e)=>k0(t,W0(e));class J0 extends Sl{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new V0,this.events=new ft.exports.EventEmitter,this.name=N0,this.version=P0,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Bt,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const s=En(n),a={topic:i,relay:s};this.pending.set(i,a);const c=await this.rpcSubscribe(i,s);return this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),c}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,s)=>{const a=new Q.Watch;a.start(this.pendingSubscriptionWatchLabel);const c=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(c),a.stop(this.pendingSubscriptionWatchLabel),n(!0)),a.elapsed(this.pendingSubscriptionWatchLabel)>=R0&&(clearInterval(c),a.stop(this.pendingSubscriptionWatchLabel),s(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=ye.generateChildLogger(r,this.name),this.clientId=""}get context(){return ye.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=En(i);await this.rpcUnsubscribe(e,r,n);const s=ze("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r){const i={method:di(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await Lr(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(nt.connection_stalled)}return hr(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,i={method:di(r.protocol).batchSubscribe,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await Lr(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(nt.connection_stalled)}}rpcUnsubscribe(e,r,i){const n={method:di(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,r){this.setSubscription(e,qn(zr({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,zr({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,zr({},r)),this.topicMap.set(r.topic,e),this.events.emit(Ot.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Ot.deleted,qn(zr({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Ot.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(Ot.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);Fr(r)&&this.onBatchSubscribe(r.map((i,n)=>qn(zr({},e[n]),{id:i})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(ar.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(nt.connect,async()=>{await this.onConnect()}),this.relayer.on(nt.disconnect,()=>{this.onDisconnect()}),this.events.on(Ot.created,async e=>{const r=Ot.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Ot.deleted,async e=>{const r=Ot.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var Q0=Object.defineProperty,$a=Object.getOwnPropertySymbols,Z0=Object.prototype.hasOwnProperty,e_=Object.prototype.propertyIsEnumerable,Ma=(t,e,r)=>e in t?Q0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,t_=(t,e)=>{for(var r in e||(e={}))Z0.call(e,r)&&Ma(t,r,e[r]);if($a)for(var r of $a(e))e_.call(e,r)&&Ma(t,r,e[r]);return t};class r_ extends vl{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ft.exports.EventEmitter,this.name=E0,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(i){throw this.logger.debug("Failed to Publish Request"),this.logger.error(i),i}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(nt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(nt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Ut.payload,this.onPayloadHandler),this.provider.on(Ut.connect,this.onConnectHandler),this.provider.on(Ut.disconnect,this.onDisconnectHandler),this.provider.on(Ut.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?ye.generateChildLogger(e.logger,this.name):ye.pino(ye.getDefaultLoggerOptions({level:e.logger||v0})),this.messages=new K0(this.logger,e.core),this.subscriber=new J0(this,this.logger),this.publisher=new H0(this,this.logger),this.relayUrl=e?.relayUrl||Ca,this.projectId=e.projectId,this.bundleId=Hd(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${La}...`),await this.restartTransport(La)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},O0)}get context(){return ye.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){var i;this.isInitialized();let n=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"";if(n)return n;let s;const a=c=>{c.topic===e&&(this.subscriber.off(Ot.created,a),s())};return await Promise.all([new Promise(c=>{s=c,this.subscriber.on(Ot.created,a)}),new Promise(async c=>{n=await this.subscriber.subscribe(e,r),c()})]),n}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Lr(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Ot.resubscribed,()=>{r()})}),new Promise(async(r,i)=>{try{await Lr(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(n){i(n);return}r()})])}catch(r){this.logger.error(r);const i=r;if(!this.isConnectionStalled(i.message))throw r;this.provider.events.emit(Ut.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Jo())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Pg(new Lg(Xd({sdkVersion:I0,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;if(!i||i.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const n=this.messages.has(r,i);return n&&this.logger.debug(`Ignoring duplicate message: ${i}`),n}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),An(e)){if(!e.method.endsWith(S0))return;const r=e.params,{topic:i,message:n,publishedAt:s}=r.data,a={topic:i,message:n,publishedAt:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(t_({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else _i(e)&&this.events.emit(nt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(nt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Pn(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(Ut.payload,this.onPayloadHandler),this.provider.off(Ut.connect,this.onConnectHandler),this.provider.off(Ut.disconnect,this.onDisconnectHandler),this.provider.off(Ut.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(nt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let e=await Jo();zp(async r=>{this.initialized&&e!==r&&(e=r,r?await this.restartTransport().catch(i=>this.logger.error(i)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(i=>this.logger.error(i))))})}onProviderDisconnect(){this.events.emit(nt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},Q.toMiliseconds(D0)))}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var i_=Object.defineProperty,ja=Object.getOwnPropertySymbols,n_=Object.prototype.hasOwnProperty,s_=Object.prototype.propertyIsEnumerable,qa=(t,e,r)=>e in t?i_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ba=(t,e)=>{for(var r in e||(e={}))n_.call(e,r)&&qa(t,r,e[r]);if(ja)for(var r of ja(e))s_.call(e,r)&&qa(t,r,e[r]);return t};class wi extends El{constructor(e,r,i,n=Bt,s=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=x0,this.cached=[],this.initialized=!1,this.storagePrefix=Bt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>{this.getKey&&a!==null&&!ut(a)?this.map.set(this.getKey(a),a):wp(a)?this.map.set(a.id,a):mp(a)&&this.map.set(a.topic,a)}),this.cached=[],this.initialized=!0)},this.set=async(a,c)=>{this.isInitialized(),this.map.has(a)?await this.update(a,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:a,value:c}),this.map.set(a,c),await this.persist())},this.get=a=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:a}),this.getData(a)),this.getAll=a=>(this.isInitialized(),a?this.values.filter(c=>Object.keys(a).every(h=>Fg(c[h],a[h]))):this.values),this.update=async(a,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:a,update:c});const h=Ba(Ba({},this.getData(a)),c);this.map.set(a,h),await this.persist()},this.delete=async(a,c)=>{this.isInitialized(),this.map.has(a)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:a,reason:c}),this.map.delete(a),await this.persist())},this.logger=ye.generateChildLogger(r,this.name),this.storagePrefix=n,this.getKey=s}get context(){return ye.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class o_{constructor(e,r){this.core=e,this.logger=r,this.name=A0,this.version=C0,this.events=new ft.exports,this.initialized=!1,this.storagePrefix=Bt,this.ignoredPayloadTypes=[er],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=mn(),n=await this.core.crypto.setSymKey(i),s=Dt(Q.FIVE_MINUTES),a={protocol:Aa},c={topic:n,expiry:s,relay:a,active:!1},h=up({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:a});return await this.pairings.set(n,c),await this.core.relayer.subscribe(n),this.core.expirer.set(n,s),{topic:n,uri:h}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:n,symKey:s,relay:a}=Ho(i.uri);let c;if(this.pairings.keys.includes(n)&&(c=this.pairings.get(n),c.active))throw new Error(`Pairing already exists: ${n}. Please try again with a new connection URI.`);const h=Dt(Q.FIVE_MINUTES),l={topic:n,relay:a,expiry:h,active:!1};return await this.pairings.set(n,l),this.core.expirer.set(n,h),i.activatePairing&&await this.activate({topic:n}),this.events.emit(Br.create,l),this.core.crypto.keychain.has(n)||(await this.core.crypto.setSymKey(s,n),await this.core.relayer.subscribe(n,{relay:a})),l},this.activate=async({topic:i})=>{this.isInitialized();const n=Dt(Q.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:n}),this.core.expirer.set(i,n)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const s=await this.sendRequest(n,"wc_pairingPing",{}),{done:a,resolve:c,reject:h}=pr();this.events.once(Ue("pairing_ping",s),({error:l})=>{l?h(l):c()}),await a()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",ze("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(i,n,s)=>{const a=yr(n,s),c=await this.core.crypto.encode(i,a),h=qr[n].req;return this.core.history.set(i,a),this.core.relayer.publish(i,c,h),a.id},this.sendResult=async(i,n,s)=>{const a=Pn(i,s),c=await this.core.crypto.encode(n,a),h=await this.core.history.get(n,i),l=qr[h.request.method].res;await this.core.relayer.publish(n,c,l),await this.core.history.resolve(a)},this.sendError=async(i,n,s)=>{const a=Rn(i,s),c=await this.core.crypto.encode(n,a),h=await this.core.history.get(n,i),l=qr[h.request.method]?qr[h.request.method].res:qr.unregistered_method.res;await this.core.relayer.publish(n,c,l),await this.core.history.resolve(a)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,ze("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>qt(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:s}=i;switch(s.method){case"wc_pairingPing":return this.onPairingPingRequest(n,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,s);default:return this.onUnknownRpcMethodRequest(n,s)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:s}=i,a=(await this.core.history.get(n,s.id)).request.method;switch(a){case"wc_pairingPing":return this.onPairingPingResponse(n,s);default:return this.onUnknownRpcMethodResponse(a)}},this.onPairingPingRequest=async(i,n)=>{const{id:s}=n;try{this.isValidPing({topic:i}),await this.sendResult(s,i,!0),this.events.emit(Br.ping,{id:s,topic:i})}catch(a){await this.sendError(s,i,a),this.logger.error(a)}},this.onPairingPingResponse=(i,n)=>{const{id:s}=n;setTimeout(()=>{Ft(n)?this.events.emit(Ue("pairing_ping",s),{}):It(n)&&this.events.emit(Ue("pairing_ping",s),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit(Br.delete,{id:s,topic:i})}catch(a){await this.sendError(s,i,a),this.logger.error(a)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:s,method:a}=n;try{if(this.registeredMethods.includes(a))return;const c=ze("WC_METHOD_UNSUPPORTED",a);await this.sendError(s,i,c),this.logger.error(c)}catch(c){await this.sendError(s,i,c),this.logger.error(c)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(ze("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{var n;if(!gt(i)){const{message:a}=V("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(a)}if(!bp(i.uri)){const{message:a}=V("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(a)}const s=Ho(i.uri);if(!((n=s?.relay)!=null&&n.protocol)){const{message:a}=V("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(a)}if(!(s!=null&&s.symKey)){const{message:a}=V("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(a)}},this.isValidPing=async i=>{if(!gt(i)){const{message:s}=V("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!gt(i)){const{message:s}=V("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!Ve(i,!1)){const{message:n}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(qt(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=V("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=ye.generateChildLogger(r,this.name),this.pairings=new wi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return ye.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(nt.message,async e=>{const{topic:r,message:i}=e;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(r,i);try{An(n)?(this.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):_i(n)&&(await this.core.history.resolve(n),await this.onRelayEventResponse({topic:r,payload:n}),this.core.history.delete(r,n.id))}catch(s){this.logger.error(s)}})}registerExpirerEvents(){this.core.expirer.on(vt.expired,async e=>{const{topic:r}=Bo(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Br.expire,{topic:r}))})}}class a_ extends bl{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new ft.exports.EventEmitter,this.name=L0,this.version=F0,this.cached=[],this.initialized=!1,this.storagePrefix=Bt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const a={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s,expiry:Dt(Q.THIRTY_DAYS)};this.records.set(a.id,a),this.events.emit(Pt.created,a)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=It(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(Pt.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(Pt.deleted,s)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=ye.generateChildLogger(r,this.name)}get context(){return ye.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:yr(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Pt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Pt.created,e=>{const r=Pt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Pt.updated,e=>{const r=Pt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Pt.deleted,e=>{const r=Pt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.core.heartbeat.on(ar.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{Q.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class c_ extends Dl{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new ft.exports.EventEmitter,this.name=U0,this.version=$0,this.cached=[],this.initialized=!1,this.storagePrefix=Bt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const s=this.formatTarget(i),a={target:s,expiry:n};this.expirations.set(s,a),this.checkExpiry(s,a),this.events.emit(vt.created,{target:s,expiration:a})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(vt.deleted,{target:n,expiration:s})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=ye.generateChildLogger(r,this.name)}get context(){return ye.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Jd(e);if(typeof e=="number")return Qd(e);const{message:r}=V("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(vt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;Q.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(vt.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(ar.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(vt.created,e=>{const r=vt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(vt.expired,e=>{const r=vt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(vt.deleted,e=>{const r=vt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class u_ extends Il{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.name=Mn,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async i=>{if(this.verifyDisabled||fr()||!dr())return;const n=this.getVerifyUrl(i?.verifyUrl);this.verifyUrl!==n&&this.removeIframe(),this.verifyUrl=n;try{await this.createIframe()}catch(s){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(s)}if(!this.initialized){this.removeIframe(),this.verifyUrl=jn;try{await this.createIframe()}catch(s){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(s),this.verifyDisabled=!0}}},this.register=async i=>{this.initialized?this.sendPost(i.attestationId):(this.addToQueue(i.attestationId),await this.init())},this.resolve=async i=>{if(this.isDevEnv)return"";const n=this.getVerifyUrl(i?.verifyUrl);let s;try{s=await this.fetchAttestation(i.attestationId,n)}catch(a){this.logger.info(`failed to resolve attestation: ${i.attestationId} from url: ${n}`),this.logger.info(a),s=await this.fetchAttestation(i.attestationId,jn)}return s},this.fetchAttestation=async(i,n)=>{this.logger.info(`resolving attestation: ${i} from url: ${n}`);const s=this.startAbortTimer(Q.ONE_SECOND*2),a=await fetch(`${n}/attestation/${i}`,{signal:this.abortController.signal});return clearTimeout(s),a.status===200?await a.json():void 0},this.addToQueue=i=>{this.queue.push(i)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(i=>this.sendPost(i)),this.queue=[])},this.sendPost=i=>{var n;try{if(!this.iframe)return;(n=this.iframe.contentWindow)==null||n.postMessage(i,"*"),this.logger.info(`postMessage sent: ${i} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let i;const n=s=>{s.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",n),i())};await Promise.race([new Promise(s=>{if(document.getElementById(Mn))return s();window.addEventListener("message",n);const a=document.createElement("iframe");a.id=Mn,a.src=`${this.verifyUrl}/${this.projectId}`,a.style.display="none",document.body.append(a),this.iframe=a,i=s}),new Promise((s,a)=>setTimeout(()=>{window.removeEventListener("message",n),a("verify iframe load timeout")},Q.toMiliseconds(Q.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=i=>{let n=i||_r;return M0.includes(n)||(this.logger.info(`verify url: ${n}, not included in trusted list, assigning default: ${_r}`),n=_r),n},this.logger=ye.generateChildLogger(r,this.name),this.verifyUrl=_r,this.abortController=new AbortController,this.isDevEnv=vn()&&process.env.IS_VITEST}get context(){return ye.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),Q.toMiliseconds(e))}}class l_ extends Ol{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.context=j0,this.registerDeviceToken=async i=>{const{clientId:n,token:s,notificationType:a,enableEncrypted:c=!1}=i,h=`${q0}/${this.projectId}/clients`;await Mg(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:n,type:a,token:s,always_raw:c})})},this.logger=ye.generateChildLogger(r,this.context)}}var h_=Object.defineProperty,za=Object.getOwnPropertySymbols,f_=Object.prototype.hasOwnProperty,d_=Object.prototype.propertyIsEnumerable,Ka=(t,e,r)=>e in t?h_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ha=(t,e)=>{for(var r in e||(e={}))f_.call(e,r)&&Ka(t,r,e[r]);if(za)for(var r of za(e))d_.call(e,r)&&Ka(t,r,e[r]);return t};class Bn extends _l{constructor(e){super(e),this.protocol=Pa,this.version=l0,this.name=$n,this.events=new ft.exports.EventEmitter,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Ca,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:ye.pino(ye.getDefaultLoggerOptions({level:e?.logger||h0.logger}));this.logger=ye.generateChildLogger(r,this.name),this.heartbeat=new ar.HeartBeat,this.crypto=new z0(this,this.logger,e?.keychain),this.history=new a_(this,this.logger),this.expirer=new c_(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new kc(Ha(Ha({},f0),e?.storageOptions)),this.relayer=new r_({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new o_(this,this.logger),this.verify=new u_(this.projectId||"",this.logger),this.echoClient=new l_(this.projectId||"",this.logger)}static async init(e){const r=new Bn(e);await r.initialize();const i=await r.crypto.getClientId();return await r.storage.setItem(T0,i),r}get context(){return ye.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const p_=Bn,zn="wc",Kn=2,Hn="client",mi=`${zn}@${Kn}:${Hn}:`,vi={name:Hn,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},g_={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_request_sent:"session_request_sent",session_event:"session_event",proposal_expire:"proposal_expire"},y_={database:":memory:"},Vn="WALLETCONNECT_DEEPLINK_CHOICE",__={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},b_="history",w_="0.3",Va="proposal",m_=Q.THIRTY_DAYS,Ga="Proposal expired",ka="session",Kr=Q.SEVEN_DAYS,Wa="engine",br={wc_sessionPropose:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1115}}},Ei={min:Q.FIVE_MINUTES,max:Q.SEVEN_DAYS},Rt={idle:"IDLE",active:"ACTIVE"},Ya="request",Xa=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var v_=Object.defineProperty,E_=Object.defineProperties,S_=Object.getOwnPropertyDescriptors,Ja=Object.getOwnPropertySymbols,D_=Object.prototype.hasOwnProperty,I_=Object.prototype.propertyIsEnumerable,Qa=(t,e,r)=>e in t?v_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,yt=(t,e)=>{for(var r in e||(e={}))D_.call(e,r)&&Qa(t,r,e[r]);if(Ja)for(var r of Ja(e))I_.call(e,r)&&Qa(t,r,e[r]);return t},Hr=(t,e)=>E_(t,S_(e));class O_ extends Tl{constructor(e){super(e),this.name=Wa,this.events=new ft.exports,this.initialized=!1,this.ignoredPayloadTypes=[er],this.requestQueue={state:Rt.idle,queue:[]},this.sessionRequestQueue={state:Rt.idle,queue:[]},this.requestQueueDelay=Q.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(br)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},Q.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const i=Hr(yt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:a,sessionProperties:c,relays:h}=i;let l=n,f,y=!1;if(l&&(y=this.client.core.pairing.pairings.get(l).active),!l||!y){const{topic:x,uri:b}=await this.client.core.pairing.create();l=x,f=b}const g=await this.client.core.crypto.generateKeyPair(),w=yt({requiredNamespaces:s,optionalNamespaces:a,relays:h??[{protocol:Aa}],proposer:{publicKey:g,metadata:this.client.metadata}},c&&{sessionProperties:c}),{reject:m,resolve:P,done:A}=pr(Q.FIVE_MINUTES,Ga);if(this.events.once(Ue("session_connect"),async({error:x,session:b})=>{if(x)m(x);else if(b){b.self.publicKey=g;const E=Hr(yt({},b),{requiredNamespaces:b.requiredNamespaces,optionalNamespaces:b.optionalNamespaces});await this.client.session.set(b.topic,E),await this.setExpiry(b.topic,b.expiry),l&&await this.client.core.pairing.updateMetadata({topic:l,metadata:b.peer.metadata}),P(E)}}),!l){const{message:x}=V("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(x)}const j=await this.sendRequest({topic:l,method:"wc_sessionPropose",params:w}),S=Dt(Q.FIVE_MINUTES);return await this.setProposal(j,yt({id:j,expiry:S},w)),{uri:f,approval:A}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:n,namespaces:s,sessionProperties:a}=r,c=this.client.proposal.get(i);let{pairingTopic:h,proposer:l,requiredNamespaces:f,optionalNamespaces:y}=c;h=h||"",Ur(f)||(f=dp(s,"approve()"));const g=await this.client.core.crypto.generateKeyPair(),w=l.publicKey,m=await this.client.core.crypto.generateSharedKey(g,w);h&&i&&(await this.client.core.pairing.updateMetadata({topic:h,metadata:l.metadata}),await this.sendResult({id:i,topic:h,result:{relay:{protocol:n??"irn"},responderPublicKey:g}}),await this.client.proposal.delete(i,ze("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:h}));const P=yt({relay:{protocol:n??"irn"},namespaces:s,requiredNamespaces:f,optionalNamespaces:y,pairingTopic:h,controller:{publicKey:g,metadata:this.client.metadata},expiry:Dt(Kr)},a&&{sessionProperties:a});await this.client.core.relayer.subscribe(m),await this.sendRequest({topic:m,method:"wc_sessionSettle",params:P,throwOnFailedPublish:!0});const A=Hr(yt({},P),{topic:m,pairingTopic:h,acknowledged:!1,self:P.controller,peer:{publicKey:l.publicKey,metadata:l.metadata},controller:g});return await this.client.session.set(m,A),await this.setExpiry(m,Dt(Kr)),{topic:m,acknowledged:()=>new Promise(j=>setTimeout(()=>j(this.client.session.get(m)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:i,reason:n}=r,{pairingTopic:s}=this.client.proposal.get(i);s&&(await this.sendError(i,s,n),await this.client.proposal.delete(i,ze("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:n}=r,s=await this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:n}}),{done:a,resolve:c,reject:h}=pr();return this.events.once(Ue("session_update",s),({error:l})=>{l?h(l):c()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:a}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,n=await this.sendRequest({topic:i,method:"wc_sessionExtend",params:{}}),{done:s,resolve:a,reject:c}=pr();return this.events.once(Ue("session_extend",n),({error:h})=>{h?c(h):a()}),await this.setExpiry(i,Dt(Kr)),{acknowledged:s}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:n,topic:s,expiry:a}=r,c=Nn(),{done:h,resolve:l,reject:f}=pr(a,"Request expired. Please try again.");return this.events.once(Ue("session_request",c),({error:y,result:g})=>{y?f(y):l(g)}),await Promise.all([new Promise(async y=>{await this.sendRequest({clientRpcId:c,topic:s,method:"wc_sessionRequest",params:{request:n,chainId:i},expiry:a,throwOnFailedPublish:!0}).catch(g=>f(g)),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:c}),y()}),new Promise(async y=>{const g=await ep(this.client.core.storage,Vn);Zd({id:c,topic:s,wcDeepLink:g}),y()}),h()]).then(y=>y[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:s}=n;Ft(n)?await this.sendResult({id:s,topic:i,result:n.result,throwOnFailedPublish:!0}):It(n)&&await this.sendError(s,i,n.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=await this.sendRequest({topic:i,method:"wc_sessionPing",params:{}}),{done:s,resolve:a,reject:c}=pr();this.events.once(Ue("session_ping",n),({error:h})=>{h?c(h):a()}),await s()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:n,chainId:s}=r;await this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:n,chainId:s}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.client.session.keys.includes(i)?(await this.sendRequest({topic:i,method:"wc_sessionDelete",params:ze("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>yp(i,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const i=this.client.core.pairing.pairings.get(r.pairingTopic),n=this.client.core.pairing.pairings.getAll().filter(s=>{var a,c;return((a=s.peerMetadata)==null?void 0:a.url)&&((c=s.peerMetadata)==null?void 0:c.url)===r.peer.metadata.url&&s.topic&&s.topic!==i.topic});if(n.length===0)return;this.client.logger.info(`Cleaning up ${n.length} duplicate pairing(s)`),await Promise.all(n.map(s=>this.client.core.pairing.disconnect({topic:s.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async(r,i)=>{const{self:n}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,ze("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(n.publicKey)&&await this.client.core.crypto.deleteKeyPair(n.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),i||this.client.core.expirer.del(r),this.client.core.storage.removeItem(Vn).catch(s=>this.client.logger.warn(s)),this.getPendingSessionRequests().forEach(s=>{s.topic===r&&this.deletePendingSessionRequest(s.id,ze("USER_DISCONNECTED"))})},this.deleteProposal=async(r,i)=>{await Promise.all([this.client.proposal.delete(r,ze("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(s=>s.id!==r),n&&(this.sessionRequestQueue.state=Rt.idle)},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.core.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.core.expirer.set(r,i.expiry)},this.setPendingSessionRequest=async r=>{const i=br.wc_sessionRequest.req.ttl,{id:n,topic:s,params:a,verifyContext:c}=r;await this.client.pendingRequest.set(n,{id:n,topic:s,params:a,verifyContext:c}),i&&this.client.core.expirer.set(n,Dt(i))},this.sendRequest=async r=>{const{topic:i,method:n,params:s,expiry:a,relayRpcId:c,clientRpcId:h,throwOnFailedPublish:l}=r,f=yr(n,s,h);if(dr()&&Xa.includes(n)){const w=hr(JSON.stringify(f));this.client.core.verify.register({attestationId:w})}const y=await this.client.core.crypto.encode(i,f),g=br[n].req;return a&&(g.ttl=a),c&&(g.id=c),this.client.core.history.set(i,f),l?(g.internal=Hr(yt({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,y,g)):this.client.core.relayer.publish(i,y,g).catch(w=>this.client.logger.error(w)),f.id},this.sendResult=async r=>{const{id:i,topic:n,result:s,throwOnFailedPublish:a}=r,c=Pn(i,s),h=await this.client.core.crypto.encode(n,c),l=await this.client.core.history.get(n,i),f=br[l.request.method].res;a?(f.internal=Hr(yt({},f.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,h,f)):this.client.core.relayer.publish(n,h,f).catch(y=>this.client.logger.error(y)),await this.client.core.history.resolve(c)},this.sendError=async(r,i,n)=>{const s=Rn(r,n),a=await this.client.core.crypto.encode(i,s),c=await this.client.core.history.get(i,r),h=br[c.request.method].res;this.client.core.relayer.publish(i,a,h),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{qt(n.expiry)&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{qt(n.expiry)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession(n)),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Rt.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Rt.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(i=>setTimeout(i,300))}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=Rt.idle},this.processRequest=r=>{const{topic:i,payload:n}=r,s=n.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:n}=r,s=(await this.client.core.history.get(i,n.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:i}=r,{message:n}=V("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(n)},this.onSessionProposeRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidConnect(yt({},i.params));const a=Dt(Q.FIVE_MINUTES),c=yt({id:s,pairingTopic:r,expiry:a},n);await this.setProposal(s,c);const h=hr(JSON.stringify(i)),l=await this.getVerifyContext(h,c.proposer.metadata);this.client.events.emit("session_proposal",{id:s,params:c,verifyContext:l})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionProposeResponse=async(r,i)=>{const{id:n}=i;if(Ft(i)){const{result:s}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const a=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const h=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:h});const l=await this.client.core.crypto.generateSharedKey(c,h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:l});const f=await this.client.core.relayer.subscribe(l);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:f}),await this.client.core.pairing.activate({topic:r})}else It(i)&&(await this.client.proposal.delete(n,ze("USER_DISCONNECTED")),this.events.emit(Ue("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:a,controller:c,expiry:h,namespaces:l,requiredNamespaces:f,optionalNamespaces:y,sessionProperties:g,pairingTopic:w}=i.params,m=yt({topic:r,relay:a,expiry:h,namespaces:l,acknowledged:!0,pairingTopic:w,requiredNamespaces:f,optionalNamespaces:y,controller:c.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:c.publicKey,metadata:c.metadata}},g&&{sessionProperties:g});await this.sendResult({id:i.id,topic:r,result:!0}),this.events.emit(Ue("session_connect"),{session:m}),this.cleanupDuplicatePairings(m)}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.onSessionSettleResponse=async(r,i)=>{const{id:n}=i;Ft(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ue("session_approve",n),{})):It(i)&&(await this.client.session.delete(r,ze("USER_DISCONNECTED")),this.events.emit(Ue("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:n,id:s}=i;try{const a=`${r}_session_update`,c=yi.get(a);if(c&&this.isRequestOutOfSync(c,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidUpdate(yt({topic:r},n)),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult({id:s,topic:r,result:!0}),this.client.events.emit("session_update",{id:s,topic:r,params:n}),yi.set(a,s)}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.isRequestOutOfSync=(r,i)=>parseInt(i.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,i)=>{const{id:n}=i;Ft(i)?this.events.emit(Ue("session_update",n),{}):It(i)&&this.events.emit(Ue("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Dt(Kr)),await this.sendResult({id:n,topic:r,result:!0}),this.client.events.emit("session_extend",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,i)=>{const{id:n}=i;Ft(i)?this.events.emit(Ue("session_extend",n),{}):It(i)&&this.events.emit(Ue("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult({id:n,topic:r,result:!0}),this.client.events.emit("session_ping",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,i)=>{const{id:n}=i;setTimeout(()=>{Ft(i)?this.events.emit(Ue("session_ping",n),{}):It(i)&&this.events.emit(Ue("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),await Promise.all([new Promise(s=>{this.client.core.relayer.once(nt.publish,async()=>{s(await this.deleteSession(r))})}),this.sendResult({id:n,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:n,topic:r})}catch(s){this.client.logger.error(s)}},this.onSessionRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidRequest(yt({topic:r},s));const a=hr(JSON.stringify(yr("wc_sessionRequest",s,n))),c=this.client.session.get(r),h=await this.getVerifyContext(a,c.peer.metadata),l={id:n,topic:r,params:s,verifyContext:h};await this.setPendingSessionRequest(l),this.addSessionRequestToSessionRequestQueue(l),this.processSessionRequestQueue()}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.onSessionRequestResponse=(r,i)=>{const{id:n}=i;Ft(i)?this.events.emit(Ue("session_request",n),{result:i.result}):It(i)&&this.events.emit(Ue("session_request",n),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:n,params:s}=i;try{const a=`${r}_session_event_${s.event.name}`,c=yi.get(a);if(c&&this.isRequestOutOfSync(c,n)){this.client.logger.info(`Discarding out of sync request - ${n}`);return}this.isValidEmit(yt({topic:r},s)),this.client.events.emit("session_event",{id:n,topic:r,params:s}),yi.set(a,n)}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Rt.idle,this.processSessionRequestQueue()},Q.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===Rt.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Rt.active,this.client.events.emit("session_request",r)}catch(i){this.client.logger.error(i)}},this.onPairingCreated=r=>{if(r.active)return;const i=this.client.proposal.getAll().find(n=>n.pairingTopic===r.topic);i&&this.onSessionProposeRequest(r.topic,yr("wc_sessionPropose",{requiredNamespaces:i.requiredNamespaces,optionalNamespaces:i.optionalNamespaces,relays:i.relays,proposer:i.proposer,sessionProperties:i.sessionProperties},i.id))},this.isValidConnect=async r=>{if(!gt(r)){const{message:h}=V("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(h)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:s,sessionProperties:a,relays:c}=r;if(ut(i)||await this.isValidPairingTopic(i),!Tp(c,!0)){const{message:h}=V("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(h)}!ut(n)&&Ur(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!ut(s)&&Ur(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),ut(a)||this.validateSessionProps(a,"sessionProperties")},this.validateNamespaces=(r,i)=>{const n=xp(r,"connect()",i);if(n)throw new Error(n.message)},this.isValidApprove=async r=>{if(!gt(r))throw new Error(V("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:s,sessionProperties:a}=r;await this.isValidProposalId(i);const c=this.client.proposal.get(i),h=gi(n,"approve()");if(h)throw new Error(h.message);const l=Yo(c.requiredNamespaces,n,"approve()");if(l)throw new Error(l.message);if(!Ve(s,!0)){const{message:f}=V("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(f)}ut(a)||this.validateSessionProps(a,"sessionProperties")},this.isValidReject=async r=>{if(!gt(r)){const{message:s}=V("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:i,reason:n}=r;if(await this.isValidProposalId(i),!Pp(n)){const{message:s}=V("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!gt(r)){const{message:l}=V("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(l)}const{relay:i,controller:n,namespaces:s,expiry:a}=r;if(!ko(i)){const{message:l}=V("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const c=vp(n,"onSessionSettleRequest()");if(c)throw new Error(c.message);const h=gi(s,"onSessionSettleRequest()");if(h)throw new Error(h.message);if(qt(a)){const{message:l}=V("EXPIRED","onSessionSettleRequest()");throw new Error(l)}},this.isValidUpdate=async r=>{if(!gt(r)){const{message:h}=V("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(h)}const{topic:i,namespaces:n}=r;await this.isValidSessionTopic(i);const s=this.client.session.get(i),a=gi(n,"update()");if(a)throw new Error(a.message);const c=Yo(s.requiredNamespaces,n,"update()");if(c)throw new Error(c.message)},this.isValidExtend=async r=>{if(!gt(r)){const{message:n}=V("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!gt(r)){const{message:h}=V("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(h)}const{topic:i,request:n,chainId:s,expiry:a}=r;await this.isValidSessionTopic(i);const{namespaces:c}=this.client.session.get(i);if(!Wo(c,s)){const{message:h}=V("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(h)}if(!Rp(n)){const{message:h}=V("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(h)}if(!Lp(c,s,n.method)){const{message:h}=V("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(h)}if(a&&!Mp(a,Ei)){const{message:h}=V("MISSING_OR_INVALID",`request() expiry: ${a}. Expiry must be a number (in seconds) between ${Ei.min} and ${Ei.max}`);throw new Error(h)}},this.isValidRespond=async r=>{var i;if(!gt(r)){const{message:a}=V("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(a)}const{topic:n,response:s}=r;try{await this.isValidSessionTopic(n)}catch(a){throw(i=r?.response)!=null&&i.id&&this.cleanupAfterResponse(r),a}if(!Ap(s)){const{message:a}=V("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(a)}},this.isValidPing=async r=>{if(!gt(r)){const{message:n}=V("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!gt(r)){const{message:c}=V("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(c)}const{topic:i,event:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:a}=this.client.session.get(i);if(!Wo(a,s)){const{message:c}=V("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(c)}if(!Cp(n)){const{message:c}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(c)}if(!Fp(a,s,n.name)){const{message:c}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(c)}},this.isValidDisconnect=async r=>{if(!gt(r)){const{message:n}=V("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.getVerifyContext=async(r,i)=>{const n={verified:{verifyUrl:i.verifyUrl||_r,validation:"UNKNOWN",origin:i.url||""}};try{const s=await this.client.core.verify.resolve({attestationId:r,verifyUrl:i.verifyUrl});s&&(n.verified.origin=s.origin,n.verified.isScam=s.isScam,n.verified.validation=s.origin===new URL(i.url).origin?"VALID":"INVALID")}catch(s){this.client.logger.info(s)}return this.client.logger.info(`Verify context: ${JSON.stringify(n)}`),n},this.validateSessionProps=(r,i)=>{Object.values(r).forEach(n=>{if(!Ve(n,!1)){const{message:s}=V("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(s)}})}}async isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(nt.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const n=await this.client.core.crypto.decode(r,i);try{An(n)?(this.client.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):_i(n)?(await this.client.core.history.resolve(n),await this.onRelayEventResponse({topic:r,payload:n}),this.client.core.history.delete(r,n.id)):this.onRelayEventUnknownPayload({topic:r,payload:n})}catch(s){this.client.logger.error(s)}})}registerExpirerEvents(){this.client.core.expirer.on(vt.expired,async e=>{const{topic:r,id:i}=Bo(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,V("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}registerPairingEvents(){this.client.core.pairing.events.on(Br.create,e=>this.onPairingCreated(e))}isValidPairingTopic(e){if(!Ve(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(qt(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=V("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!Ve(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(qt(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=V("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Ve(e,!1)){const{message:r}=V("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=V("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!Np(e)){const{message:r}=V("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(qt(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=V("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class x_ extends wi{constructor(e,r){super(e,r,Va,mi),this.core=e,this.logger=r}}class Za extends wi{constructor(e,r){super(e,r,ka,mi),this.core=e,this.logger=r}}class T_ extends wi{constructor(e,r){super(e,r,Ya,mi,i=>i.id),this.core=e,this.logger=r}}class Si extends xl{constructor(e){super(e),this.protocol=zn,this.version=Kn,this.name=vi.name,this.events=new ft.exports.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=e?.name||vi.name,this.metadata=e?.metadata||Gd();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:ye.pino(ye.getDefaultLoggerOptions({level:e?.logger||vi.logger}));this.core=e?.core||new p_(e),this.logger=ye.generateChildLogger(r,this.name),this.session=new Za(this.core,this.logger),this.proposal=new x_(this.core,this.logger),this.pendingRequest=new T_(this.core,this.logger),this.engine=new O_(this)}static async init(e){const r=new Si(e);return await r.initialize(),r}get context(){return ye.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const N_=Za,P_=Si;Se.ENGINE_CONTEXT=Wa,Se.ENGINE_QUEUE_STATES=Rt,Se.ENGINE_RPC_OPTS=br,Se.HISTORY_CONTEXT=b_,Se.HISTORY_EVENTS=__,Se.HISTORY_STORAGE_VERSION=w_,Se.METHODS_TO_VERIFY=Xa,Se.PROPOSAL_CONTEXT=Va,Se.PROPOSAL_EXPIRY=m_,Se.PROPOSAL_EXPIRY_MESSAGE=Ga,Se.REQUEST_CONTEXT=Ya,Se.SESSION_CONTEXT=ka,Se.SESSION_EXPIRY=Kr,Se.SESSION_REQUEST_EXPIRY_BOUNDARIES=Ei,Se.SIGN_CLIENT_CONTEXT=Hn,Se.SIGN_CLIENT_DEFAULT=vi,Se.SIGN_CLIENT_EVENTS=g_,Se.SIGN_CLIENT_PROTOCOL=zn,Se.SIGN_CLIENT_STORAGE_OPTIONS=y_,Se.SIGN_CLIENT_STORAGE_PREFIX=mi,Se.SIGN_CLIENT_VERSION=Kn,Se.SessionStore=N_,Se.SignClient=P_,Se.WALLETCONNECT_DEEPLINK_CHOICE=Vn,Se.default=Si,Object.defineProperty(Se,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
